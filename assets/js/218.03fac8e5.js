(window.webpackJsonp=window.webpackJsonp||[]).push([[218],{715:function(t,s,a){"use strict";a.r(s);var n=a(2),r=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("# 深入剖析 Spring WebFlux：响应式编程的利器 "),a("img",{attrs:{src:"https://miro.medium.com/v2/resize:fit:1228/format:webp/1*S_6ZOB75Uk-oLh8qVVuC8w.png",alt:""}}),t._v(" > WebFlux 是 Spring 生态中颠覆性的技术革新，它如何重新定义高并发场景下的服务端编程？   > 本文通过原理剖析+实战演示+性能对比，带你彻底掌握响应式编程范式 "),a("img",{attrs:{src:"https://img.starfish.ink/spring/springwebflux-banner.svg",alt:""}})]),t._v(" "),a("h2",{attrs:{id:"一、传统阻塞模型的困境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、传统阻塞模型的困境"}},[t._v("#")]),t._v(" 一、传统阻塞模型的困境")]),t._v(" "),a("p",[t._v("在典型的 Spring MVC 应用中，每个 HTTP 请求都会从 Tomcat 线程池中获取一个工作线程：")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 伪代码：")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BlockingController")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("    \n  "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@GetMapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/data"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("    \n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Data")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getData")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 占用线程直至方法返回        ")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("blockingIO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 同步阻塞调用    ")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("这种同步阻塞模型存在两大瓶颈：")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("线程资源耗尽")]),t._v("：当并发请求量超过线程池大小时，新请求必须等待")]),t._v(" "),a("li",[a("strong",[t._v("CPU闲置浪费")]),t._v("：线程在等待数据库响应时处于阻塞状态（通过 "),a("code",[t._v("jstack")]),t._v(" 可观察到大量 "),a("code",[t._v("WAITING")]),t._v(" 线程）")])]),t._v(" "),a("h2",{attrs:{id:"二、webflux-的响应式革命"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、webflux-的响应式革命"}},[t._v("#")]),t._v(" 二、WebFlux 的响应式革命")]),t._v(" "),a("h3",{attrs:{id:"_2-1-核心设计理念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-核心设计理念"}},[t._v("#")]),t._v(" 2.1 核心设计理念")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 伪代码：WebFlux响应式模型")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ReactiveController")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@GetMapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/flux"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Flux")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getStream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 立即返回流对象")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactiveIO")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 异步非阻塞调用")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("WebFlux 的核心创新体现在三个层面：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("维度")]),t._v(" "),a("th",[t._v("传统模型")]),t._v(" "),a("th",[t._v("WebFlux模型")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("线程模型")]),t._v(" "),a("td",[t._v("同步阻塞")]),t._v(" "),a("td",[t._v("异步非阻塞")])]),t._v(" "),a("tr",[a("td",[t._v("资源利用率")]),t._v(" "),a("td",[t._v("每个请求独占线程")]),t._v(" "),a("td",[t._v("少量线程处理海量请求")])]),t._v(" "),a("tr",[a("td",[t._v("背压支持")]),t._v(" "),a("td",[t._v("无")]),t._v(" "),a("td",[t._v("自动流量控制")])]),t._v(" "),a("tr",[a("td",[t._v("适用场景")]),t._v(" "),a("td",[t._v("CRUD密集型")]),t._v(" "),a("td",[t._v("高并发+流式处理")])])])]),t._v(" "),a("h3",{attrs:{id:"_2-2-架构演进"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-架构演进"}},[t._v("#")]),t._v(" 2.2 架构演进")]),t._v(" "),a("p",[t._v("Spring 5 的模块化设计：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://docs.spring.io/spring-framework/reference/images/spring-overview.png",alt:"Spring架构"}})]),t._v(" "),a("p",[t._v("关键组件解析：")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("Reactive Streams API")]),t._v("：标准化响应式编程接口（Publisher/Subscriber）")]),t._v(" "),a("li",[a("strong",[t._v("Reactor 库")]),t._v("：Spring 官方响应式库（Mono/Flux）")]),t._v(" "),a("li",[a("strong",[t._v("Netty/Undertow")]),t._v("：非阻塞式服务器支持")]),t._v(" "),a("li",[a("strong",[t._v("Router Functions")]),t._v("：函数式端点声明")])]),t._v(" "),a("h3",{attrs:{id:"_2-3-线程模型对比"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-线程模型对比"}},[t._v("#")]),t._v(" 2.3 线程模型对比")]),t._v(" "),a("p",[t._v("通过 VisualVM 监控线程状态：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/img_convert/0e3d1d17fccf3d1f7b4d1a8c4d4c4d5a.png",alt:"线程状态对比"}})]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Tomcat 线程池")]),t._v("：大量线程处于 "),a("code",[t._v("TIMED_WAITING")]),t._v(" 状态")]),t._v(" "),a("li",[a("strong",[t._v("Netty EventLoop")]),t._v("：少量固定线程处理所有请求")])]),t._v(" "),a("h2",{attrs:{id:"三、深度解析-reactor-编程模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、深度解析-reactor-编程模型"}},[t._v("#")]),t._v(" 三、深度解析 Reactor 编程模型")]),t._v(" "),a("h3",{attrs:{id:"_3-1-核心类型操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-核心类型操作"}},[t._v("#")]),t._v(" 3.1 核心类型操作")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Flux")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("just")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"A"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"B"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"C"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("delayElements")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Duration")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ofMillis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toLowerCase")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("flatMap")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("queryFromDB")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("subscribeOn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Schedulers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("boundedElastic")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("subscribe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Received: {}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        err "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Error: {}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("info")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Stream completed"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("常用操作符分类：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("类型")]),t._v(" "),a("th",[t._v("操作符")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("创建")]),t._v(" "),a("td",[t._v("just, create, generate")])]),t._v(" "),a("tr",[a("td",[t._v("转换")]),t._v(" "),a("td",[t._v("map, flatMap, filter")])]),t._v(" "),a("tr",[a("td",[t._v("组合")]),t._v(" "),a("td",[t._v("zip, merge, concat")])]),t._v(" "),a("tr",[a("td",[t._v("错误处理")]),t._v(" "),a("td",[t._v("onErrorReturn, retry")])]),t._v(" "),a("tr",[a("td",[t._v("调度控制")]),t._v(" "),a("td",[t._v("publishOn, subscribeOn")])])])]),t._v(" "),a("h3",{attrs:{id:"_3-2-背压机制实战"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-背压机制实战"}},[t._v("#")]),t._v(" 3.2 背压机制实战")]),t._v(" "),a("div",{staticClass:"language-Java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Flux")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("range")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onBackpressureBuffer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("50")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("doOnNext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("debug")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Emit: {}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("subscribe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BaseSubscriber")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hookOnSubscribe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Subscription")]),t._v(" s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hookOnNext")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Integer")]),t._v(" value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("process")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("背压策略对比：")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("策略")]),t._v(" "),a("th",[t._v("特点")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("BUFFER")]),t._v(" "),a("td",[t._v("缓冲未处理元素")])]),t._v(" "),a("tr",[a("td",[t._v("DROP")]),t._v(" "),a("td",[t._v("丢弃溢出元素")])]),t._v(" "),a("tr",[a("td",[t._v("LATEST")]),t._v(" "),a("td",[t._v("只保留最新元素")])]),t._v(" "),a("tr",[a("td",[t._v("ERROR")]),t._v(" "),a("td",[t._v("抛出异常")])])])]),t._v(" "),a("h2",{attrs:{id:"四、webflux-内部机制揭秘"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#四、webflux-内部机制揭秘"}},[t._v("#")]),t._v(" 四、WebFlux 内部机制揭秘")]),t._v(" "),a("h3",{attrs:{id:"_4-1-请求处理全流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-请求处理全流程"}},[t._v("#")]),t._v(" 4.1 请求处理全流程")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("Mermaid\n")])])]),a("h3",{attrs:{id:"_4-2-核心组件协作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-核心组件协作"}},[t._v("#")]),t._v(" 4.2 核心组件协作")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://docs.spring.io/spring-framework/reference/images/spring-webflux-handling.png",alt:"处理流程"}})]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("WebHandler API")]),t._v("：非阻塞式处理入口")]),t._v(" "),a("li",[a("strong",[t._v("ReactiveAdapterRegistry")]),t._v("：响应式类型转换")]),t._v(" "),a("li",[a("strong",[t._v("ResultHandler")]),t._v("：处理不同返回类型")])]),t._v(" "),a("h2",{attrs:{id:"六、最佳实践指南"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#六、最佳实践指南"}},[t._v("#")]),t._v(" 六、最佳实践指南")]),t._v(" "),a("h3",{attrs:{id:"_6-1-适用场景建议"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-适用场景建议"}},[t._v("#")]),t._v(" 6.1 适用场景建议")]),t._v(" "),a("ol",[a("li",[t._v("网关代理等高并发端点")]),t._v(" "),a("li",[t._v("实时日志推送等流式API")]),t._v(" "),a("li",[t._v("与Spring MVC 并存的混合架构")])]),t._v(" "),a("p",[t._v('"响应式不是银弹，而是工具箱中的新武器" —— Rossen Stoyanchev')]),t._v(" "),a("h2",{attrs:{id:"附录-扩展阅读"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#附录-扩展阅读"}},[t._v("#")]),t._v(" 附录：扩展阅读")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.wenxiaobai.com/chat/200006#",target:"_blank",rel:"noopener noreferrer"}},[t._v("Reactor 官方文档"),a("OutboundLink")],1)]),t._v(" "),a("li",[a("a",{attrs:{href:"https://www.wenxiaobai.com/chat/200006#",target:"_blank",rel:"noopener noreferrer"}},[t._v("WebFlux 性能调优指南"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=r.exports}}]);