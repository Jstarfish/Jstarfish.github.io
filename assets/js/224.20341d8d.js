(window.webpackJsonp=window.webpackJsonp||[]).push([[224],{717:function(_,v,t){"use strict";t.r(v);var s=t(2),r=Object(s.a)({},(function(){var _=this,v=_.$createElement,t=_._self._c||v;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("p",[t("img",{attrs:{src:"https://img.starfish.ink/common/faq-banner.png",alt:""}})]),_._v(" "),t("blockquote",[t("p",[_._v("Elasticsearchæ˜¯åŸºäºLuceneçš„"),t("strong",[_._v("åˆ†å¸ƒå¼æœç´¢ä¸åˆ†æå¼•æ“")]),_._v("ï¼Œä¹Ÿæ˜¯é¢è¯•å®˜è€ƒå¯Ÿ"),t("strong",[_._v("æœç´¢æŠ€æœ¯æ ˆ")]),_._v("çš„é‡ä¸­ä¹‹é‡ã€‚ä»åŸºç¡€æ¦‚å¿µåˆ°é›†ç¾¤æ¶æ„ï¼Œä»æŸ¥è¯¢ä¼˜åŒ–åˆ°æ€§èƒ½è°ƒä¼˜ï¼Œæ¯ä¸€ä¸ªçŸ¥è¯†ç‚¹éƒ½å¯èƒ½æˆä¸ºé¢è¯•çš„å…³é”®ã€‚æœ¬æ–‡æ¡£å°†"),t("strong",[_._v("æœ€å¸¸è€ƒçš„ESçŸ¥è¯†ç‚¹")]),_._v("æ•´ç†æˆ"),t("strong",[_._v("æ ‡å‡†è¯æœ¯")]),_._v("ï¼Œè®©ä½ åœ¨é¢è¯•ä¸­å¯¹ç­”å¦‚æµï¼")])]),_._v(" "),t("hr"),_._v(" "),t("h2",{attrs:{id:"ğŸ—ºï¸-çŸ¥è¯†å¯¼èˆª"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ—ºï¸-çŸ¥è¯†å¯¼èˆª"}},[_._v("#")]),_._v(" ğŸ—ºï¸ çŸ¥è¯†å¯¼èˆª")]),_._v(" "),t("h3",{attrs:{id:"ğŸ·ï¸-æ ¸å¿ƒçŸ¥è¯†åˆ†ç±»"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ·ï¸-æ ¸å¿ƒçŸ¥è¯†åˆ†ç±»"}},[_._v("#")]),_._v(" ğŸ·ï¸ æ ¸å¿ƒçŸ¥è¯†åˆ†ç±»")]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("ğŸ”¥ åŸºç¡€æ¦‚å¿µç±»")]),_._v("ï¼šç´¢å¼•ã€æ–‡æ¡£ã€åˆ†ç‰‡ã€å‰¯æœ¬ã€å€’æ’ç´¢å¼•")]),_._v(" "),t("li",[t("strong",[_._v("ğŸ“Š æŸ¥è¯¢ä¸ç´¢å¼•åŸç†")]),_._v("ï¼šæŸ¥è¯¢DSLã€åˆ†è¯å™¨ã€Mappingã€å­˜å‚¨æœºåˆ¶")]),_._v(" "),t("li",[t("strong",[_._v("ğŸŒ é›†ç¾¤ä¸æ¶æ„")]),_._v("ï¼šèŠ‚ç‚¹è§’è‰²ã€é€‰ä¸»æœºåˆ¶ã€åˆ†ç‰‡åˆ†é…ã€æ•…éšœè½¬ç§»")]),_._v(" "),t("li",[t("strong",[_._v("âš¡ æ€§èƒ½ä¼˜åŒ–ç±»")]),_._v("ï¼šå†™å…¥ä¼˜åŒ–ã€æŸ¥è¯¢ä¼˜åŒ–ã€æ·±åˆ†é¡µã€refreshæœºåˆ¶")]),_._v(" "),t("li",[t("strong",[_._v("ğŸ”§ é«˜çº§ç‰¹æ€§")]),_._v("ï¼šèšåˆåˆ†æã€è·¯ç”±æœºåˆ¶ã€æ‰¹é‡æ“ä½œã€è„šæœ¬æŸ¥è¯¢")]),_._v(" "),t("li",[t("strong",[_._v("ğŸš¨ å¼‚å¸¸ä¸æ•…éšœå¤„ç†")]),_._v("ï¼šè„‘è£‚é—®é¢˜ã€æ€§èƒ½æ’æŸ¥ã€å†…å­˜ä¼˜åŒ–ã€æ•°æ®ä¸å‡è¡¡")]),_._v(" "),t("li",[t("strong",[_._v("ğŸ’¼ å®æˆ˜åœºæ™¯é¢˜")]),_._v("ï¼šæ—¥å¿—åˆ†æã€å•†å“æœç´¢ã€ç´¢å¼•è®¾è®¡ã€æ•°æ®æ¸…ç†")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ”‘-é¢è¯•è¯æœ¯æ¨¡æ¿"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”‘-é¢è¯•è¯æœ¯æ¨¡æ¿"}},[_._v("#")]),_._v(" ğŸ”‘ é¢è¯•è¯æœ¯æ¨¡æ¿")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[t("strong",[_._v("é—®é¢˜ç±»å‹")])]),_._v(" "),t("th",[t("strong",[_._v("å›ç­”æ¡†æ¶")])]),_._v(" "),t("th",[t("strong",[_._v("å…³é”®è¦ç‚¹")])]),_._v(" "),t("th",[t("strong",[_._v("æ·±å…¥æ‰©å±•")])])])]),_._v(" "),t("tbody",[t("tr",[t("td",[t("strong",[_._v("æ¦‚å¿µè§£é‡Š")])]),_._v(" "),t("td",[_._v("å®šä¹‰â†’ç‰¹ç‚¹â†’åº”ç”¨åœºæ™¯â†’ç¤ºä¾‹")]),_._v(" "),t("td",[_._v("å‡†ç¡®å®šä¹‰ï¼Œçªå‡ºç‰¹ç‚¹")]),_._v(" "),t("td",[_._v("åº•å±‚åŸç†ï¼Œæºç åˆ†æ")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("å¯¹æ¯”åˆ†æ")])]),_._v(" "),t("td",[_._v("ç›¸åŒç‚¹â†’ä¸åŒç‚¹â†’ä½¿ç”¨åœºæ™¯â†’é€‰æ‹©å»ºè®®")]),_._v(" "),t("td",[_._v("å¤šç»´åº¦å¯¹æ¯”")]),_._v(" "),t("td",[_._v("æ€§èƒ½å·®å¼‚ï¼Œå®é™…åº”ç”¨")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("åŸç†è§£æ")])]),_._v(" "),t("td",[_._v("èƒŒæ™¯â†’å®ç°æœºåˆ¶â†’æ‰§è¡Œæµç¨‹â†’æ³¨æ„äº‹é¡¹")]),_._v(" "),t("td",[_._v("å›¾è§£æµç¨‹")]),_._v(" "),t("td",[_._v("Luceneå±‚é¢ï¼ŒJVMè°ƒä¼˜")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("ä¼˜åŒ–å®è·µ")])]),_._v(" "),t("td",[_._v("é—®é¢˜ç°è±¡â†’åˆ†ææ€è·¯â†’è§£å†³æ–¹æ¡ˆâ†’ç›‘æ§éªŒè¯")]),_._v(" "),t("td",[_._v("å®é™…æ¡ˆä¾‹")]),_._v(" "),t("td",[_._v("æœ€ä½³å®è·µï¼Œè¸©å‘ç»éªŒ")])])])]),_._v(" "),t("hr"),_._v(" "),t("h2",{attrs:{id:"ğŸ”¥-ä¸€ã€åŸºç¡€æ¦‚å¿µç±»-esæ ¸å¿ƒ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”¥-ä¸€ã€åŸºç¡€æ¦‚å¿µç±»-esæ ¸å¿ƒ"}},[_._v("#")]),_._v(" ğŸ”¥ ä¸€ã€åŸºç¡€æ¦‚å¿µç±»ï¼ˆESæ ¸å¿ƒï¼‰")]),_._v(" "),t("blockquote",[t("p",[t("strong",[_._v("æ ¸å¿ƒæ€æƒ³")]),_._v("ï¼šElasticsearchæ˜¯åŸºäºLuceneçš„åˆ†å¸ƒå¼æœç´¢å¼•æ“ï¼Œé€šè¿‡å€’æ’ç´¢å¼•å®ç°å¿«é€Ÿå…¨æ–‡æ£€ç´¢ï¼Œé€šè¿‡åˆ†ç‰‡å’Œå‰¯æœ¬å®ç°æ°´å¹³æ‰©å±•å’Œé«˜å¯ç”¨ã€‚")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-ä»€ä¹ˆæ˜¯-elasticsearch-å®ƒçš„æ ¸å¿ƒåº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-ä»€ä¹ˆæ˜¯-elasticsearch-å®ƒçš„æ ¸å¿ƒåº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆ"}},[_._v("#")]),_._v(" ğŸ¯ ä»€ä¹ˆæ˜¯ Elasticsearchï¼Ÿå®ƒçš„æ ¸å¿ƒåº”ç”¨åœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ")]),_._v(" "),t("ol",[t("li",[t("p",[t("strong",[_._v("Elasticsearch æ˜¯ä»€ä¹ˆï¼Ÿ")])]),_._v(" "),t("p",[_._v("Elasticsearchï¼ˆESï¼‰æ˜¯åŸºäº Lucene çš„ "),t("strong",[_._v("åˆ†å¸ƒå¼æœç´¢ä¸åˆ†æå¼•æ“")]),_._v("ã€‚å®ƒé€šè¿‡ "),t("strong",[_._v("å€’æ’ç´¢å¼•")]),_._v("ï¼ˆæ–‡æœ¬ï¼‰ä¸ "),t("strong",[_._v("åˆ—å¼/æ ‘ç»“æ„")]),_._v("ï¼ˆæ•°å€¼ã€åœ°ç†ã€å‘é‡ï¼‰å®ç° "),t("strong",[_._v("é«˜å¹¶å‘ã€ä½å»¶è¿Ÿ")]),_._v(" çš„æ£€ç´¢ä¸èšåˆï¼Œæ”¯æŒ "),t("strong",[_._v("æ°´å¹³æ‰©å±•ã€è‡ªåŠ¨åˆ†ç‰‡ä¸å‰¯æœ¬")]),_._v("ã€è¿‘å®æ—¶(NRT)æœç´¢ã€‚")]),_._v(" "),t("p",[_._v("å¸¸ç”¨äºï¼š")]),_._v(" "),t("ul",[t("li",[_._v("å…¨æ–‡æœç´¢ï¼ˆæœç´¢å¼•æ“ã€æ—¥å¿—æ£€ç´¢ï¼‰")]),_._v(" "),t("li",[_._v("å®æ—¶æ•°æ®åˆ†æï¼ˆç›‘æ§ã€æŠ¥è¡¨ï¼‰")]),_._v(" "),t("li",[_._v("å¤§è§„æ¨¡æ•°æ®å­˜å‚¨ä¸å¿«é€ŸæŸ¥è¯¢ï¼ˆELKï¼šElasticsearch + Logstash + Kibanaï¼‰")])]),_._v(" "),t("p",[_._v("ä¸€å¥è¯æ€»ç»“ï¼š Elasticsearch å°±æ˜¯â€œèƒ½å­˜æ•°æ®çš„æœç´¢å¼•æ“â€ï¼Œç‰¹åˆ«é€‚åˆ"),t("strong",[_._v("æ¨¡ç³ŠæŸ¥è¯¢ã€å…¨æ–‡æ£€ç´¢ã€å®æ—¶åˆ†æ")]),_._v("çš„åœºæ™¯ã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("Elasticsearch çš„ç‰¹ç‚¹")])]),_._v(" "),t("ul",[t("li",[t("p",[t("strong",[_._v("å…¨æ–‡æ£€ç´¢")]),_._v("ï¼šæ”¯æŒåˆ†è¯ã€å€’æ’ç´¢å¼•ï¼Œèƒ½å¿«é€Ÿè¿›è¡Œæ¨¡ç³Šæœç´¢ã€å…³é”®è¯é«˜äº®ç­‰ã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("åˆ†å¸ƒå¼")]),_._v("ï¼šå¤©ç„¶æ”¯æŒæ°´å¹³æ‰©å±•ï¼Œæ•°æ®åˆ†ç‰‡å­˜å‚¨ï¼Œå‰¯æœ¬ä¿è¯é«˜å¯ç”¨ã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("è¿‘å®æ—¶ï¼ˆNRTï¼‰")]),_._v("ï¼šæ•°æ®å†™å…¥åå‡ ä¹èƒ½ç«‹å³è¢«æœç´¢åˆ°ï¼ˆé»˜è®¤åˆ·æ–°é—´éš” 1 ç§’ï¼‰ã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("å¤šç§æŸ¥è¯¢æ–¹å¼")]),_._v("ï¼šæ”¯æŒç»“æ„åŒ–æŸ¥è¯¢ï¼ˆç±»ä¼¼ SQLï¼‰ã€å…¨æ–‡æ£€ç´¢ã€èšåˆåˆ†æã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("Schema çµæ´»")]),_._v("ï¼šå­—æ®µå¯ä»¥åŠ¨æ€æ·»åŠ ï¼Œä¸éœ€è¦å›ºå®šè¡¨ç»“æ„ã€‚")])])])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-es-å’Œ-mysql-çš„åŒºåˆ«-ä»€ä¹ˆæ—¶å€™é€‰ç”¨-es"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-å’Œ-mysql-çš„åŒºåˆ«-ä»€ä¹ˆæ—¶å€™é€‰ç”¨-es"}},[_._v("#")]),_._v(" ğŸ¯ ES å’Œ MySQL çš„åŒºåˆ«ï¼Ÿä»€ä¹ˆæ—¶å€™é€‰ç”¨ ESï¼Ÿ")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("å¯¹æ¯”ç»´åº¦")]),_._v(" "),t("th",[_._v("Elasticsearch")]),_._v(" "),t("th",[_._v("å…³ç³»å‹æ•°æ®åº“ (RDBMS)")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[t("strong",[_._v("æ•°æ®æ¨¡å‹")])]),_._v(" "),t("td",[_._v("æ–‡æ¡£å‹ï¼ˆJSON æ ¼å¼ï¼‰ï¼Œç´¢å¼• â†’ æ–‡æ¡£ â†’ å­—æ®µ")]),_._v(" "),t("td",[_._v("è¡¨æ ¼å‹ï¼ˆè¡Œã€åˆ—ã€è¡¨ï¼‰")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("å­˜å‚¨ç»“æ„")])]),_._v(" "),t("td",[_._v("å€’æ’ç´¢å¼•ï¼ˆé€‚åˆæœç´¢ï¼‰")]),_._v(" "),t("td",[_._v("B+ æ ‘ï¼ˆé€‚åˆäº‹åŠ¡ã€èŒƒå›´æŸ¥è¯¢ï¼‰")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("æŸ¥è¯¢èƒ½åŠ›")])]),_._v(" "),t("td",[_._v("å…¨æ–‡æ£€ç´¢ã€æ¨¡ç³ŠåŒ¹é…ã€èšåˆåˆ†æ")]),_._v(" "),t("td",[_._v("SQL æŸ¥è¯¢ï¼ˆç²¾ç¡®åŒ¹é…ã€å¤æ‚å…³è”ï¼‰")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("æ‰©å±•æ€§")])]),_._v(" "),t("td",[_._v("åˆ†å¸ƒå¼æ¶æ„ï¼Œæ°´å¹³æ‰©å±•æ–¹ä¾¿")]),_._v(" "),t("td",[_._v("å•æœºä¸ºä¸»ï¼Œåˆ†åº“åˆ†è¡¨æ‰©å±•å¤æ‚")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("äº‹åŠ¡æ”¯æŒ")])]),_._v(" "),t("td",[_._v("ä¸æ”¯æŒå¤æ‚äº‹åŠ¡ï¼ˆä»…ä¿è¯å•æ–‡æ¡£åŸå­æ€§ï¼‰")]),_._v(" "),t("td",[_._v("æ”¯æŒ ACID äº‹åŠ¡")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("åœºæ™¯é€‚ç”¨")])]),_._v(" "),t("td",[_._v("æœç´¢å¼•æ“ã€æ—¥å¿—åˆ†æã€å®æ—¶ç›‘æ§")]),_._v(" "),t("td",[_._v("é‡‘èäº¤æ˜“ã€åº“å­˜ç®¡ç†ã€å¼ºä¸€è‡´æ€§ç³»ç»Ÿ")])]),_._v(" "),t("tr",[t("td",[t("strong",[_._v("æ¨¡å¼ï¼ˆSchemaï¼‰")])]),_._v(" "),t("td",[_._v("çµæ´» schemaï¼Œå¯åŠ¨æ€æ·»åŠ å­—æ®µ")]),_._v(" "),t("td",[_._v("ä¸¥æ ¼ schemaï¼Œç»“æ„éœ€æå‰å®šä¹‰")])])])]),_._v(" "),t("blockquote",[t("p",[_._v("Elasticsearch æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„æœç´¢å’Œåˆ†æå¼•æ“ï¼Œåº•å±‚åŸºäº Luceneï¼Œå¸¸ç”¨äºå…¨æ–‡æ£€ç´¢å’Œå®æ—¶æ•°æ®åˆ†æã€‚\nå’Œå…³ç³»å‹æ•°æ®åº“ä¸åŒï¼ŒES ä½¿ç”¨æ–‡æ¡£å­˜å‚¨å’Œå€’æ’ç´¢å¼•ï¼Œæ›´é€‚åˆå¤„ç†æ¨¡ç³Šæœç´¢å’Œå¤§è§„æ¨¡éç»“æ„åŒ–æ•°æ®ï¼›è€Œå…³ç³»å‹æ•°æ®åº“å¼ºè°ƒäº‹åŠ¡ä¸€è‡´æ€§å’Œç»“æ„åŒ–æŸ¥è¯¢ï¼Œæ›´é€‚åˆä¸šåŠ¡ç³»ç»Ÿçš„æ•°æ®å­˜å‚¨ã€‚")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-es-ä¸­çš„ç´¢å¼•-index-ã€ç±»å‹-type-7-x-ä¹‹ååºŸå¼ƒ-ã€æ–‡æ¡£-document-ã€å­—æ®µ-field-åˆ†åˆ«æ˜¯ä»€ä¹ˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-ä¸­çš„ç´¢å¼•-index-ã€ç±»å‹-type-7-x-ä¹‹ååºŸå¼ƒ-ã€æ–‡æ¡£-document-ã€å­—æ®µ-field-åˆ†åˆ«æ˜¯ä»€ä¹ˆ"}},[_._v("#")]),_._v(" ğŸ¯ ES ä¸­çš„ç´¢å¼•ï¼ˆIndexï¼‰ã€ç±»å‹ï¼ˆTypeï¼Œ7.x ä¹‹ååºŸå¼ƒï¼‰ã€æ–‡æ¡£ï¼ˆDocumentï¼‰ã€å­—æ®µï¼ˆFieldï¼‰åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ")]),_._v(" "),t("ul",[t("li",[t("p",[t("strong",[_._v("Index")]),_._v("ï¼šç±»ä¼¼â€œåº“â€ï¼Œç”±å¤šä¸ªåˆ†ç‰‡ï¼ˆShardï¼‰ç»„æˆã€‚")])]),_._v(" "),t("li",[t("p",[_._v("Typeï¼ˆç±»å‹ï¼Œ7.x ä¹‹ååºŸå¼ƒï¼‰ï¼šåœ¨æ—©æœŸç‰ˆæœ¬ï¼ˆ6.x åŠä¹‹å‰ï¼‰ï¼Œä¸€ä¸ªç´¢å¼•å¯ä»¥æœ‰å¤šä¸ª "),t("strong",[_._v("ç±»å‹ï¼ˆTypeï¼‰")]),_._v("ï¼Œç±»ä¼¼æ•°æ®åº“ä¸­çš„ "),t("strong",[_._v("è¡¨ï¼ˆTableï¼‰")]),_._v("ã€‚")]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("ä½œç”¨")]),_._v("ï¼šä¸åŒç±»å‹çš„æ•°æ®å¯ä»¥æ”¾åœ¨åŒä¸€ä¸ªç´¢å¼•é‡Œï¼Œæ¯ä¸ªç±»å‹æœ‰è‡ªå·±çš„ Mappingï¼ˆå­—æ®µå®šä¹‰ï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ä¸ºä»€ä¹ˆåºŸå¼ƒ")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("ES å†…éƒ¨åº•å±‚å…¶å®æ²¡æœ‰ â€œå¤šè¡¨â€ æ¦‚å¿µï¼Œæ‰€æœ‰ type éƒ½æ˜¯å†™åœ¨ä¸€ä¸ªéšè—å­—æ®µ "),t("code",[_._v("_type")]),_._v(" ä¸Šã€‚")]),_._v(" "),t("li",[_._v("å¤šä¸ª type å…±ç”¨ä¸€ä¸ªå€’æ’ç´¢å¼•ï¼Œå®¹æ˜“å¯¼è‡´ "),t("strong",[_._v("å­—æ®µå†²çª")]),_._v("ï¼ˆåŒåå­—æ®µä¸åŒç±»å‹ï¼‰ã€‚")]),_._v(" "),t("li",[_._v("7.x ä¹‹åï¼Œä¸€ä¸ªç´¢å¼•åªå…è®¸æœ‰ä¸€ä¸ª typeï¼ˆé»˜è®¤ "),t("code",[_._v("_doc")]),_._v("ï¼‰ï¼Œ8.x å®Œå…¨ç§»é™¤ã€‚")])])])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("Document")]),_._v("ï¼š")]),_._v(" "),t("p",[t("strong",[_._v("å®šä¹‰")]),_._v("ï¼šæ–‡æ¡£æ˜¯ Elasticsearch å­˜å‚¨å’Œæ£€ç´¢çš„åŸºæœ¬å•ä½ï¼Œç›¸å½“äºå…³ç³»å‹æ•°æ®åº“ä¸­çš„ "),t("strong",[_._v("ä¸€è¡Œæ•°æ®ï¼ˆRowï¼‰")]),_._v("ã€‚")]),_._v(" "),t("p",[t("strong",[_._v("ç‰¹ç‚¹")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("ç”¨ JSON æ ¼å¼å­˜å‚¨æ•°æ®ã€‚")]),_._v(" "),t("li",[_._v("æ¯ä¸ªæ–‡æ¡£éƒ½æœ‰ä¸€ä¸ª "),t("code",[_._v("_id")]),_._v("ï¼Œç”¨äºå”¯ä¸€æ ‡è¯†ã€‚")]),_._v(" "),t("li",[_._v("æ–‡æ¡£å±äºæŸä¸ªç´¢å¼•ã€‚")])]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"id"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"Alice"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"age"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("25")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"city"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"Beijing"')]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])]),t("p",[_._v("è¿™æ˜¯å­˜æ”¾åœ¨ "),t("code",[_._v("users")]),_._v(" ç´¢å¼•ä¸‹çš„ä¸€ä¸ªæ–‡æ¡£ã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("Fieldï¼ˆå­—æ®µï¼‰")]),_._v(": å­—æ®µå°±æ˜¯æ–‡æ¡£ä¸­çš„ä¸€ä¸ª "),t("strong",[_._v("é”®å€¼å¯¹ï¼ˆKey-Valueï¼‰")]),_._v("ï¼Œç›¸å½“äºå…³ç³»å‹æ•°æ®åº“ä¸­çš„ "),t("strong",[_._v("åˆ—ï¼ˆColumnï¼‰")]),_._v("ã€‚")]),_._v(" "),t("p",[t("strong",[_._v("ç‰¹ç‚¹")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("æ¯ä¸ªå­—æ®µå¯ä»¥æœ‰ä¸åŒçš„æ•°æ®ç±»å‹ï¼ˆtextã€keywordã€integerã€dateã€booleanâ€¦ï¼‰ã€‚")])]),_._v(" "),t("li",[t("p",[_._v("å­—æ®µå¯ä»¥åµŒå¥—ï¼Œæ¯”å¦‚ï¼š")]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"user"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"Alice"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"age"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("25")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])]),t("p",[_._v("è¿™é‡Œ "),t("code",[_._v("user")]),_._v(" æ˜¯ä¸€ä¸ªå¯¹è±¡å­—æ®µï¼Œ"),t("code",[_._v("user.name")]),_._v(" å’Œ "),t("code",[_._v("user.age")]),_._v(" æ˜¯å­å­—æ®µã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("Mapping")]),_._v("ï¼šå­—æ®µçš„æ•°æ®ç±»å‹å’Œåˆ†è¯æ–¹å¼é€šè¿‡ Mapping æ¥å®šä¹‰ã€‚")])])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("Shard")]),_._v("ï¼šç´¢å¼•çš„æ°´å¹³åˆ‡åˆ†å•ä½ï¼Œ"),t("strong",[_._v("Primary Shard")]),_._v(" + "),t("strong",[_._v("Replica Shard")]),_._v("ï¼›Replica æä¾›é«˜å¯ç”¨ä¸è¯»æ‰©å±•ã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("NRT")]),_._v("ï¼šå†™å…¥å…ˆè¿›å…¥å†…å­˜å¹¶è®°å½•åˆ° "),t("strong",[_._v("translog")]),_._v("ï¼Œåˆ·æ–°ï¼ˆrefreshï¼Œé»˜è®¤ 1sï¼‰åç”Ÿæˆå¯æœç´¢çš„ segmentï¼Œæ•… "),t("strong",[_._v("è¿‘å®æ—¶")]),_._v("è€Œéç»å¯¹å®æ—¶ã€‚")])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-å€’æ’ç´¢å¼•æ˜¯ä»€ä¹ˆ-ä¸ºä»€ä¹ˆ-es-æŸ¥è¯¢å¿«"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å€’æ’ç´¢å¼•æ˜¯ä»€ä¹ˆ-ä¸ºä»€ä¹ˆ-es-æŸ¥è¯¢å¿«"}},[_._v("#")]),_._v(" ğŸ¯ å€’æ’ç´¢å¼•æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆ ES æŸ¥è¯¢å¿«ï¼Ÿ")]),_._v(" "),t("p",[_._v("ä¼ ç»Ÿçš„æˆ‘ä»¬çš„æ£€ç´¢æ˜¯é€šè¿‡æ–‡ç« ï¼Œé€ä¸ªéå†æ‰¾åˆ°å¯¹åº”å…³é”®è¯çš„ä½ç½®ã€‚"),t("strong",[_._v("è€Œå€’æ’ç´¢å¼•ï¼Œæ˜¯é€šè¿‡åˆ†è¯ç­–ç•¥ï¼Œå½¢æˆäº†è¯å’Œæ–‡ç« çš„æ˜ å°„å…³ç³»è¡¨ï¼Œè¿™ç§è¯å…¸+æ˜ å°„è¡¨å³ä¸ºå€’æ’ç´¢å¼•")]),_._v("ã€‚æœ‰äº†å€’æ’ç´¢å¼•ï¼Œå°±èƒ½å®ç°"),t("code",[_._v("oï¼ˆ1ï¼‰æ—¶é—´å¤æ‚åº¦")]),_._v(" çš„æ•ˆç‡æ£€ç´¢æ–‡ç« äº†ï¼Œæå¤§çš„æé«˜äº†æ£€ç´¢æ•ˆç‡ã€‚"),t("img",{attrs:{src:"https://www3.nd.edu/~pbui/teaching/cse.30331.fa16/static/img/mapreduce-wordcount.png",alt:"åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"}})]),_._v(" "),t("p",[_._v("å­¦æœ¯çš„è§£ç­”æ–¹å¼ï¼š")]),_._v(" "),t("blockquote",[t("p",[_._v("å€’æ’ç´¢å¼•ï¼Œç›¸åäºä¸€ç¯‡æ–‡ç« åŒ…å«äº†å“ªäº›è¯ï¼Œå®ƒä»è¯å‡ºå‘ï¼Œè®°è½½äº†è¿™ä¸ªè¯åœ¨å“ªäº›æ–‡æ¡£ä¸­å‡ºç°è¿‡ï¼Œç”±ä¸¤éƒ¨åˆ†ç»„æˆâ€”â€”è¯å…¸å’Œå€’æ’è¡¨ã€‚")])]),_._v(" "),t("p",[t("code",[_._v("åŠ åˆ†é¡¹")]),_._v(" ï¼šå€’æ’ç´¢å¼•çš„åº•å±‚å®ç°æ˜¯åŸºäºï¼šFSTï¼ˆFinite State Transducerï¼‰æ•°æ®ç»“æ„ã€‚luceneä»4+ç‰ˆæœ¬åå¼€å§‹å¤§é‡ä½¿ç”¨çš„æ•°æ®ç»“æ„æ˜¯FSTã€‚FSTæœ‰ä¸¤ä¸ªä¼˜ç‚¹ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("ç©ºé—´å ç”¨å°ã€‚é€šè¿‡å¯¹è¯å…¸ä¸­å•è¯å‰ç¼€å’Œåç¼€çš„é‡å¤åˆ©ç”¨ï¼Œå‹ç¼©äº†å­˜å‚¨ç©ºé—´ï¼›")]),_._v(" "),t("li",[_._v("æŸ¥è¯¢é€Ÿåº¦å¿«ã€‚O(len(str))çš„æŸ¥è¯¢æ—¶é—´å¤æ‚åº¦ã€‚")])]),_._v(" "),t("p",[_._v("å»ºç´¢å¼•æ—¶ï¼šæ–‡æœ¬ç» "),t("strong",[_._v("Analyzerï¼ˆåˆ†è¯å™¨ï¼šå­—ç¬¦è¿‡æ»¤â†’Tokenizerâ†’Token è¿‡æ»¤ï¼‰")]),_._v(" æ‹†æˆ Termï¼›å»ºç«‹ "),t("strong",[_._v("Termâ†’PostingList(DocIDã€ä½ç½®ã€é¢‘ç‡)")]),_._v(" çš„å€’æ’è¡¨ã€‚æŸ¥è¯¢æ—¶åªéœ€æŒ‰ Term ç›´è¾¾å€™é€‰ Docï¼Œç»“åˆ "),t("strong",[_._v("BM25")]),_._v(" ç­‰ç›¸å…³æ€§æ¨¡å‹æ‰“åˆ†ï¼Œé¿å…å…¨è¡¨æ‰«æã€‚")]),_._v(" "),t("ul",[t("li",[_._v("è¯å…¸ï¼ˆTerm Dictionaryï¼‰ç”¨ "),t("strong",[_._v("FST")]),_._v(" å‹ç¼©ï¼›PostingList æ”¯æŒ "),t("strong",[_._v("è·³è¡¨")]),_._v("/å—å‹ç¼©ä»¥åŠ é€Ÿè·³è½¬ä¸èŠ‚çœå†…å­˜/ç£ç›˜ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("é«˜æ•ˆçš„è¿‡æ»¤ä¸Šä¸‹æ–‡")]),_._v("ï¼ˆbool filterï¼‰å¯èµ° "),t("strong",[_._v("bitset")]),_._v(" ç¼“å­˜ï¼Œè¿›ä¸€æ­¥å‡å°‘å€™é€‰é›†ã€‚")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-ä»€ä¹ˆæ˜¯åˆ†ç‰‡-shard-å’Œå‰¯æœ¬-replica-ä½œç”¨æ˜¯ä»€ä¹ˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-ä»€ä¹ˆæ˜¯åˆ†ç‰‡-shard-å’Œå‰¯æœ¬-replica-ä½œç”¨æ˜¯ä»€ä¹ˆ"}},[_._v("#")]),_._v(" ğŸ¯ ä»€ä¹ˆæ˜¯åˆ†ç‰‡ï¼ˆShardï¼‰å’Œå‰¯æœ¬ï¼ˆReplicaï¼‰ï¼Ÿä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ")]),_._v(" "),t("blockquote",[t("ul",[t("li",[t("strong",[_._v("åˆ†ç‰‡ï¼ˆShardï¼‰")]),_._v(" æ˜¯ Elasticsearch çš„ "),t("strong",[_._v("æ°´å¹³æ‰©å±•æœºåˆ¶")]),_._v("ï¼ŒæŠŠç´¢å¼•åˆ‡åˆ†æˆå¤šä¸ªå°å—ï¼Œåˆ†å¸ƒåˆ°ä¸åŒèŠ‚ç‚¹ï¼Œä¿è¯å­˜å‚¨å’Œè®¡ç®—èƒ½åŠ›èƒ½éšç€èŠ‚ç‚¹æ•°æ‰©å±•ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("å‰¯æœ¬ï¼ˆReplicaï¼‰")]),_._v(" æ˜¯ Elasticsearch çš„ "),t("strong",[_._v("é«˜å¯ç”¨å’Œè¯»æ‰©å±•æœºåˆ¶")]),_._v("ï¼Œä¿è¯åœ¨èŠ‚ç‚¹å®•æœºæ—¶æ•°æ®ä¸ä¸¢å¤±ï¼ŒåŒæ—¶åˆ†æ‹…æŸ¥è¯¢å‹åŠ›ã€‚")]),_._v(" "),t("li",[_._v("å†™å…¥å…ˆåˆ°ä¸»åˆ†ç‰‡ï¼Œå†å¤åˆ¶åˆ°å‰¯æœ¬ï¼›æŸ¥è¯¢å¯åœ¨ä¸»åˆ†ç‰‡æˆ–å‰¯æœ¬æ‰§è¡Œã€‚")])])]),_._v(" "),t("p",[_._v("åˆ†ç‰‡æ˜¯ä¸ºäº†å°†æ•°æ®åˆ†æ•£åˆ°å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼Œå®ç°æ•°æ®çš„åˆ†å¸ƒå¼å­˜å‚¨ï¼›å‰¯æœ¬ç”¨äºæé«˜ç³»ç»Ÿçš„å®¹é”™æ€§å’ŒæŸ¥è¯¢æ€§èƒ½ã€‚")]),_._v(" "),t("ol",[t("li",[_._v("åˆ†ç‰‡ï¼ˆShardï¼‰")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("å®šä¹‰")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("Elasticsearch ä¸­çš„æ•°æ®é‡å¯èƒ½éå¸¸å¤§ï¼Œå•å°æœºå™¨æ— æ³•å­˜ä¸‹ï¼Œæ‰€ä»¥ä¸€ä¸ªç´¢å¼•ä¼šè¢«"),t("strong",[_._v("åˆ‡åˆ†æˆå¤šä¸ªåˆ†ç‰‡ï¼ˆShardï¼‰")]),_._v("ã€‚")]),_._v(" "),t("li",[_._v("æ¯ä¸ªåˆ†ç‰‡æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ª "),t("strong",[_._v("Lucene ç´¢å¼•ï¼ˆåº•å±‚å­˜å‚¨å•å…ƒï¼‰")]),_._v("ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("ç±»å‹")]),_._v("ï¼š\n"),t("ul",[t("li",[t("strong",[_._v("ä¸»åˆ†ç‰‡ï¼ˆPrimary Shardï¼‰")]),_._v("ï¼šå­˜æ”¾åŸå§‹æ•°æ®ï¼Œå†™å…¥æ—¶å¿…é¡»å…ˆå†™å…¥ä¸»åˆ†ç‰‡ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("å‰¯æœ¬åˆ†ç‰‡ï¼ˆReplica Shardï¼‰")]),_._v("ï¼šä¸»åˆ†ç‰‡çš„æ‹·è´ï¼Œç”¨äº "),t("strong",[_._v("å®¹é”™ + è¯»è¯·æ±‚è´Ÿè½½å‡è¡¡")]),_._v("ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("ç‰¹ç‚¹")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("åˆ†ç‰‡åœ¨ä¸åŒèŠ‚ç‚¹ä¸Šåˆ†å¸ƒï¼Œä¿è¯æ•°æ®æ°´å¹³æ‰©å±•ã€‚")]),_._v(" "),t("li",[_._v("æ¯ä¸ªåˆ†ç‰‡å¤§å°å»ºè®®æ§åˆ¶åœ¨ "),t("strong",[_._v("10GB ~ 50GB")]),_._v(" ä¹‹é—´ï¼Œå¤ªå¤§æ¢å¤å’Œè¿ç§»æ…¢ï¼Œå¤ªå°åˆ™åˆ†ç‰‡æ•°è¿‡å¤šå½±å“æ€§èƒ½ã€‚")]),_._v(" "),t("li",[_._v("ç´¢å¼•åœ¨åˆ›å»ºæ—¶å¯ä»¥è®¾ç½®åˆ†ç‰‡æ•°é‡ï¼ˆä¸å¯ä¿®æ”¹ï¼‰ï¼Œå‰¯æœ¬æ•°é‡å¯ä»¥åŠ¨æ€è°ƒæ•´ã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[_._v("å‰¯æœ¬ï¼ˆReplicaï¼‰")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("å®šä¹‰")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("Replica æ˜¯ Primary Shard çš„å®Œæ•´æ‹·è´ã€‚")]),_._v(" "),t("li",[_._v("é»˜è®¤æ¯ä¸ªä¸»åˆ†ç‰‡æœ‰ "),t("strong",[_._v("1 ä¸ªå‰¯æœ¬")]),_._v("ï¼Œå¯ä»¥é€šè¿‡ "),t("code",[_._v("number_of_replicas")]),_._v(" è®¾ç½®ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("ä½œç”¨")]),_._v("ï¼š\n"),t("ol",[t("li",[t("strong",[_._v("é«˜å¯ç”¨")]),_._v("ï¼šå¦‚æœæŸä¸ªèŠ‚ç‚¹å®•æœºï¼Œå‰¯æœ¬å¯ä»¥æå‡ä¸ºä¸»åˆ†ç‰‡ï¼Œä¿è¯æ•°æ®ä¸ä¸¢ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("è¯»è´Ÿè½½å‡è¡¡")]),_._v("ï¼šæŸ¥è¯¢è¯·æ±‚å¯ä»¥åœ¨ä¸»åˆ†ç‰‡æˆ–å‰¯æœ¬åˆ†ç‰‡ä¸Šæ‰§è¡Œï¼Œä»è€Œåˆ†æ•£æŸ¥è¯¢å‹åŠ›ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("æ³¨æ„")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("å†™æ“ä½œåªä¼šåœ¨ "),t("strong",[_._v("ä¸»åˆ†ç‰‡")]),_._v(" ä¸Šæ‰§è¡Œï¼Œç„¶åå¼‚æ­¥å¤åˆ¶åˆ°å‰¯æœ¬ã€‚")]),_._v(" "),t("li",[_._v("ä¸ºäº†é¿å…æ•°æ®ä¸ä¸€è‡´ï¼ŒES ä¿è¯"),t("strong",[_._v("å‰¯æœ¬å’Œä¸»åˆ†ç‰‡ä¸åœ¨åŒä¸€èŠ‚ç‚¹ä¸Š")]),_._v("ã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[t("p",[_._v("å†™å…¥æµç¨‹")]),_._v(" "),t("p",[_._v("â‘  å®¢æˆ·ç«¯å‘é€å†™è¯·æ±‚åˆ°ä»»æ„èŠ‚ç‚¹ï¼ˆåè°ƒèŠ‚ç‚¹ï¼‰ã€‚")]),_._v(" "),t("p",[_._v("â‘¡ åè°ƒèŠ‚ç‚¹æ ¹æ® "),t("strong",[_._v("è·¯ç”±ç®—æ³•")]),_._v("ï¼ˆé»˜è®¤ä½¿ç”¨ "),t("code",[_._v("_id")]),_._v(" hashï¼‰æ‰¾åˆ°ç›®æ ‡ä¸»åˆ†ç‰‡ã€‚")]),_._v(" "),t("p",[_._v("â‘¢å†™å…¥ä¸»åˆ†ç‰‡æˆåŠŸåï¼Œä¸»åˆ†ç‰‡å†æŠŠæ•°æ®å¤åˆ¶åˆ°å¯¹åº”çš„å‰¯æœ¬åˆ†ç‰‡ã€‚")]),_._v(" "),t("p",[_._v("â‘£ ä¸»åˆ†ç‰‡å’Œæ‰€æœ‰å‰¯æœ¬éƒ½ç¡®è®¤åï¼Œå†™å…¥æˆåŠŸã€‚")])])]),_._v(" "),t("hr"),_._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[_._v("æŸ¥è¯¢æµç¨‹")])]),_._v(" "),t("p",[_._v("â€‹\tâ‘   å®¢æˆ·ç«¯å‘é€æŸ¥è¯¢è¯·æ±‚åˆ°åè°ƒèŠ‚ç‚¹ã€‚")]),_._v(" "),t("p",[_._v("â€‹\tâ‘¡ åè°ƒèŠ‚ç‚¹æŠŠè¯·æ±‚åˆ†å‘åˆ°ä¸»åˆ†ç‰‡æˆ–å‰¯æœ¬åˆ†ç‰‡ã€‚")]),_._v(" "),t("p",[_._v("â€‹\tâ‘¢ å„åˆ†ç‰‡æ‰§è¡ŒæŸ¥è¯¢ï¼Œè¿”å›ç»“æœåˆ°åè°ƒèŠ‚ç‚¹ã€‚")]),_._v(" "),t("p",[_._v("â€‹\tâ‘£ åè°ƒèŠ‚ç‚¹åˆå¹¶ã€æ’åºåè¿”å›ç»™å®¢æˆ·ç«¯ã€‚")]),_._v(" "),t("hr"),_._v(" "),t("p",[_._v("åœ¨åˆ›å»ºç´¢å¼•æ—¶ï¼Œå¯ä»¥æŒ‡å®šåˆ†ç‰‡æ•°å’Œå‰¯æœ¬æ•°ï¼Œç¤ºä¾‹ï¼š")]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[_._v("PUT /my_index\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"settings"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"number_of_shards"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("5")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"number_of_replicas"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("1")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])]),t("h2",{attrs:{id:"ğŸ“Š-äºŒã€æŸ¥è¯¢ä¸ç´¢å¼•åŸç†-æ ¸å¿ƒæœºåˆ¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“Š-äºŒã€æŸ¥è¯¢ä¸ç´¢å¼•åŸç†-æ ¸å¿ƒæœºåˆ¶"}},[_._v("#")]),_._v(" ğŸ“Š äºŒã€æŸ¥è¯¢ä¸ç´¢å¼•åŸç†ï¼ˆæ ¸å¿ƒæœºåˆ¶ï¼‰")]),_._v(" "),t("blockquote",[t("p",[t("strong",[_._v("æ ¸å¿ƒæ€æƒ³")]),_._v("ï¼šç†è§£ESçš„å­˜å‚¨æœºåˆ¶ï¼ˆå€’æ’ç´¢å¼•ï¼‰ã€æŸ¥è¯¢æœºåˆ¶ï¼ˆQuery DSLï¼‰ã€åˆ†è¯æœºåˆ¶ï¼ˆAnalyzerï¼‰å’Œæ˜ å°„æœºåˆ¶ï¼ˆMappingï¼‰æ˜¯æŒæ¡ESçš„å…³é”®ã€‚")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("æŸ¥è¯¢æ–¹å¼")]),_._v("ï¼š"),t("a",{attrs:{href:"#es-%E6%94%AF%E6%8C%81%E5%93%AA%E4%BA%9B%E6%9F%A5%E8%AF%A2%E6%96%B9%E5%BC%8F"}},[_._v("ESæŸ¥è¯¢ç±»å‹")]),_._v(" | "),t("a",{attrs:{href:"#term-vs-matchmatch_phraseboolfilter-%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E9%80%89%E5%9E%8B"}},[_._v("term vs match")])]),_._v(" "),t("li",[t("strong",[_._v("å­—æ®µç±»å‹")]),_._v("ï¼š"),t("a",{attrs:{href:"#text-%E4%B8%8E-keyword-%E6%9C%89%E4%BD%95%E5%8C%BA%E5%88%AB%E5%A6%82%E4%BD%95%E4%B8%A4%E7%94%A8"}},[_._v("text vs keyword")]),_._v(" | "),t("a",{attrs:{href:"#mapping%E6%98%A0%E5%B0%84%E6%98%AF%E4%BB%80%E4%B9%88%E5%8A%A8%E6%80%81-mapping-%E5%92%8C%E9%9D%99%E6%80%81-mapping-%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB"}},[_._v("Mappingæœºåˆ¶")])]),_._v(" "),t("li",[t("strong",[_._v("åˆ†è¯åˆ†æ")]),_._v("ï¼š"),t("a",{attrs:{href:"#es-%E4%B8%AD%E7%9A%84%E5%88%86%E8%AF%8D%E5%99%A8analyzer%E6%98%AF%E4%BB%80%E4%B9%88%E5%B8%B8%E8%A7%81%E6%9C%89%E5%93%AA%E4%BA%9B"}},[_._v("åˆ†è¯å™¨åŸç†")]),_._v(" | "),t("a",{attrs:{href:"#%E5%A6%82%E4%BD%95%E5%9C%A8-elasticsearch-%E4%B8%AD%E8%BF%9B%E8%A1%8C%E5%85%A8%E6%96%87%E6%90%9C%E7%B4%A2"}},[_._v("å…¨æ–‡æœç´¢")])]),_._v(" "),t("li",[t("strong",[_._v("å­˜å‚¨æ£€ç´¢")]),_._v("ï¼š"),t("a",{attrs:{href:"#es-%E7%9A%84%E6%96%87%E6%A1%A3%E6%98%AF%E5%A6%82%E4%BD%95%E8%A2%AB%E5%AD%98%E5%82%A8%E5%92%8C%E6%A3%80%E7%B4%A2%E7%9A%84"}},[_._v("æ–‡æ¡£å­˜å‚¨æµç¨‹")]),_._v(" | "),t("a",{attrs:{href:"#%E8%AF%A6%E7%BB%86%E6%8F%8F%E8%BF%B0%E4%B8%80%E4%B8%8Belasticsearch%E7%B4%A2%E5%BC%95%E6%96%87%E6%A1%A3%E7%9A%84%E8%BF%87%E7%A8%8B"}},[_._v("ç´¢å¼•å†™å…¥è¿‡ç¨‹")]),_._v(" | "),t("a",{attrs:{href:"#%E8%AF%A6%E7%BB%86%E6%8F%8F%E8%BF%B0%E4%B8%80%E4%B8%8Belasticsearch%E6%90%9C%E7%B4%A2%E7%9A%84%E8%BF%87%E7%A8%8B"}},[_._v("æœç´¢è¿‡ç¨‹")])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-es-æ”¯æŒå“ªäº›æŸ¥è¯¢æ–¹å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-æ”¯æŒå“ªäº›æŸ¥è¯¢æ–¹å¼"}},[_._v("#")]),_._v(" ğŸ¯ ES æ”¯æŒå“ªäº›æŸ¥è¯¢æ–¹å¼ï¼Ÿ")]),_._v(" "),t("ol",[t("li",[t("p",[t("strong",[_._v("Match æŸ¥è¯¢")]),_._v("ï¼šæœ€å¸¸ç”¨çš„æŸ¥è¯¢ç±»å‹ï¼Œå…¨æ–‡æœç´¢æŸ¥è¯¢ï¼Œä¼šå¯¹è¾“å…¥çš„æŸ¥è¯¢è¯è¿›è¡Œåˆ†æï¼ˆåˆ†è¯ï¼‰ã€‚")]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"query"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"match"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"field_name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"search_value"')]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("Term æŸ¥è¯¢")]),_._v("ï¼šç²¾ç¡®æŸ¥è¯¢ï¼Œä¸è¿›è¡Œåˆ†æã€‚é€šå¸¸ç”¨äºå…³é”®è¯æˆ–æ•°å­—ç­‰ä¸éœ€è¦åˆ†è¯çš„å­—æ®µã€‚")]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"query"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"term"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"field_name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"exact_value"')]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("Range æŸ¥è¯¢")]),_._v("ï¼šèŒƒå›´æŸ¥è¯¢ï¼Œç”¨äºæŸ¥æ‰¾æŸä¸ªèŒƒå›´å†…çš„æ•°å€¼ã€æ—¥æœŸç­‰ã€‚")]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"query"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"range"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"field_name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n        "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"gte"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n        "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"lte"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("20")]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("Bool æŸ¥è¯¢")]),_._v("ï¼šç»„åˆæŸ¥è¯¢ï¼Œæ”¯æŒ "),t("code",[_._v("must")]),_._v("ï¼ˆå¿…é¡»åŒ¹é…ï¼‰ã€"),t("code",[_._v("should")]),_._v("ï¼ˆåº”è¯¥åŒ¹é…ï¼‰ã€"),t("code",[_._v("must_not")]),_._v("ï¼ˆå¿…é¡»ä¸åŒ¹é…ï¼‰ç­‰å­æŸ¥è¯¢çš„é€»è¾‘æ“ä½œã€‚")]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"query"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"bool"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"must"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("[")]),_._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"match"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"field_name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"value1"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"range"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"date_field"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"gte"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"2020-01-01"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("]")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("Aggregationsï¼ˆèšåˆï¼‰")]),_._v("ï¼šç”¨äºæ•°æ®ç»Ÿè®¡å’Œåˆ†æï¼Œå¦‚è®¡æ•°ã€æ±‚å’Œã€å¹³å‡å€¼ã€æœ€å¤§å€¼ã€æœ€å°å€¼ç­‰ã€‚")]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"aggs"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"average_price"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"avg"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n        "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"field"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"price"')]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-term-vs-matchã€match-phraseã€boolã€filter-çš„åŒºåˆ«ä¸é€‰å‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-term-vs-matchã€match-phraseã€boolã€filter-çš„åŒºåˆ«ä¸é€‰å‹"}},[_._v("#")]),_._v(" ğŸ¯ term vs matchã€match_phraseã€boolã€filter çš„åŒºåˆ«ä¸é€‰å‹ï¼Ÿ")]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("term")]),_._v("ï¼šä¸åˆ†è¯ï¼Œç²¾ç¡®åŒ¹é…ï¼ˆé€‚åˆ "),t("code",[_._v("keyword")]),_._v("/ID/ç å€¼ï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("match")]),_._v("ï¼šåˆ†è¯åæŸ¥è¯¢ï¼ˆé€‚åˆ "),t("code",[_._v("text")]),_._v(" å…¨æ–‡æ£€ç´¢ï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("match_phrase")]),_._v("ï¼šæŒ‰è¯åºåŒ¹é…çŸ­è¯­ï¼Œä¾èµ– position ä¿¡æ¯ï¼ˆæ€§èƒ½è¾ƒ match å·®ï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("bool")]),_._v("ï¼šç»„åˆæŸ¥è¯¢ï¼ˆmust/should/must_not/filterï¼‰ã€‚å…¶ä¸­ "),t("strong",[_._v("filter ä¸å‚ä¸æ‰“åˆ†")]),_._v("ã€å¯ç¼“å­˜ï¼Œé€‚åˆæ¡ä»¶ç­›é€‰ï¼ˆå¦‚æ—¶é—´ã€çŠ¶æ€ï¼‰ã€‚\né€‰å‹ï¼š"),t("strong",[_._v("ç»“æ„åŒ–ç²¾ç¡®æ¡ä»¶èµ° filter/termï¼Œå…¨æ–‡ç”¨ match/match_phrase")]),_._v("ã€‚")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-text-ä¸-keyword-æœ‰ä½•åŒºåˆ«-å¦‚ä½•ä¸¤ç”¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-text-ä¸-keyword-æœ‰ä½•åŒºåˆ«-å¦‚ä½•ä¸¤ç”¨"}},[_._v("#")]),_._v(" ğŸ¯ text ä¸ keyword æœ‰ä½•åŒºåˆ«ï¼Ÿå¦‚ä½•ä¸¤ç”¨ï¼Ÿ")]),_._v(" "),t("ul",[t("li",[_._v("è¯æœ¯ï¼štext ç”¨äºåˆ†è¯æ£€ç´¢ï¼›keyword ç”¨äºç²¾ç¡®åŒ¹é…/èšåˆ/æ’åºã€‚ä¸¤ç”¨ç”¨ multi-fieldsã€‚")]),_._v(" "),t("li",[_._v("å…³é”®è¦ç‚¹ï¼šä¸­æ–‡åˆ†è¯ ik_max_word/ik_smartï¼›é«˜åŸºæ•°å­—æ®µç”¨ keyword å¹¶å¼€å¯ doc_valuesã€‚")]),_._v(" "),t("li",[_._v("ç¤ºä¾‹")])]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[_._v("PUT /blog\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"mappings"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"properties"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"title"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v("  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"text"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"fields"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"keyword"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"keyword"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"tags"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v("   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"keyword"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])]),t("ul",[t("li",[_._v("å¸¸è§è¿½é—®ï¼šä¸ºä»€ä¹ˆèšåˆè¦ keywordï¼Ÿé¿å…åˆ†è¯ä¸è¯„åˆ†ï¼Œèµ°åˆ—å¼ doc_valuesã€‚")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-å¦‚ä½•åœ¨-elasticsearch-ä¸­è¿›è¡Œå…¨æ–‡æœç´¢"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å¦‚ä½•åœ¨-elasticsearch-ä¸­è¿›è¡Œå…¨æ–‡æœç´¢"}},[_._v("#")]),_._v(" ğŸ¯ å¦‚ä½•åœ¨ Elasticsearch ä¸­è¿›è¡Œå…¨æ–‡æœç´¢ï¼Ÿ")]),_._v(" "),t("p",[_._v("ä½¿ç”¨  "),t("code",[_._v("match")]),_._v(" æŸ¥è¯¢è¿›è¡Œå…¨æ–‡æœç´¢ã€‚ä¾‹å¦‚ï¼š")]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"query"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"match"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"field_name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"search_text"')]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])]),t("h3",{attrs:{id:"ğŸ¯-es-ä¸­çš„åˆ†è¯å™¨-analyzer-æ˜¯ä»€ä¹ˆ-å¸¸è§æœ‰å“ªäº›"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-ä¸­çš„åˆ†è¯å™¨-analyzer-æ˜¯ä»€ä¹ˆ-å¸¸è§æœ‰å“ªäº›"}},[_._v("#")]),_._v(" ğŸ¯ ES ä¸­çš„åˆ†è¯å™¨ï¼ˆAnalyzerï¼‰æ˜¯ä»€ä¹ˆï¼Ÿå¸¸è§æœ‰å“ªäº›ï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[t("strong",[_._v("Analyzerï¼ˆåˆ†è¯å™¨ï¼‰")]),_._v(" æ˜¯ ES ç”¨æ¥æŠŠæ–‡æœ¬è½¬æ¢æˆå€’æ’ç´¢å¼•é‡Œçš„ token çš„ç»„ä»¶ã€‚")]),_._v(" "),t("p",[_._v("å®ƒç”± "),t("strong",[_._v("å­—ç¬¦è¿‡æ»¤å™¨ â†’ åˆ†è¯å™¨ â†’ è¯é¡¹è¿‡æ»¤å™¨")]),_._v(" ä¸‰éƒ¨åˆ†ç»„æˆã€‚")]),_._v(" "),t("p",[_._v("å¸¸è§åˆ†è¯å™¨æœ‰ "),t("strong",[_._v("standardã€simpleã€whitespaceã€stopã€keywordã€patternã€language analyzer")]),_._v("ï¼Œä¸­æ–‡å¸¸ç”¨ "),t("strong",[_._v("IK åˆ†è¯å™¨")]),_._v("ã€‚")]),_._v(" "),t("p",[t("strong",[_._v("é€‰æ‹©åˆ†è¯å™¨çš„å…³é”®")]),_._v("ï¼šå†™å…¥å’ŒæŸ¥è¯¢è¦ç”¨ä¸€è‡´çš„åˆ†è¯æ–¹å¼ï¼Œå¦åˆ™å¯èƒ½å¯¼è‡´æŸ¥ä¸åˆ°ç»“æœã€‚")])]),_._v(" "),t("p",[_._v("åˆ†è¯å™¨æ˜¯ Elasticsearch åœ¨å»ºç«‹å€’æ’ç´¢å¼•æ—¶ï¼Œç”¨æ¥æŠŠ "),t("strong",[_._v("æ–‡æœ¬åˆ‡åˆ†æˆä¸€ä¸ªä¸ªè¯é¡¹ï¼ˆTermï¼‰")]),_._v(" çš„å·¥å…·ã€‚")]),_._v(" "),t("p",[_._v("å®ƒå†³å®šäº†ï¼š")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("æ–‡æœ¬å¦‚ä½•åˆ†è¯ï¼ˆtokenizer è´Ÿè´£ï¼‰")])]),_._v(" "),t("li",[t("p",[_._v("åˆ†è¯ç»“æœå¦‚ä½•å¤„ç†ï¼ˆcharacter filter å’Œ token filter è´Ÿè´£ï¼‰")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("ä½œç”¨")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("å†™å…¥æ—¶")]),_._v("ï¼šæ–‡æ¡£è¿›å…¥ ESï¼Œå­—æ®µå€¼ä¼šç»è¿‡åˆ†è¯å™¨ï¼Œæ‹†æˆè‹¥å¹²è¯é¡¹ï¼Œå­˜å…¥å€’æ’ç´¢å¼•ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("æŸ¥è¯¢æ—¶")]),_._v("ï¼šç”¨æˆ·çš„æœç´¢å…³é”®è¯ä¹Ÿä¼šç»è¿‡åŒæ ·çš„åˆ†è¯å™¨å¤„ç†ï¼Œç„¶åå»å€’æ’ç´¢å¼•é‡ŒåŒ¹é…ã€‚")])])])]),_._v(" "),t("p",[_._v("ğŸ‘‰ åˆ†è¯å™¨çš„ä¸€è‡´æ€§éå¸¸é‡è¦ï¼šå†™å…¥å’ŒæŸ¥è¯¢æ—¶è¦ç”¨ç›¸åŒæˆ–å…¼å®¹çš„åˆ†è¯æ–¹å¼ï¼Œå¦åˆ™ä¼šå‡ºç°â€œæŸ¥ä¸åˆ°â€çš„æƒ…å†µã€‚")]),_._v(" "),t("p",[t("strong",[_._v("åˆ†è¯å™¨çš„ç»„æˆï¼ˆ3 éƒ¨åˆ†ï¼‰")])]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("Character Filtersï¼ˆå­—ç¬¦è¿‡æ»¤å™¨ï¼‰")]),_._v("ï¼š\nåœ¨åˆ†è¯å‰å…ˆå¯¹æ–‡æœ¬åšé¢„å¤„ç†ï¼Œä¾‹å¦‚å»æ‰ HTML æ ‡ç­¾ã€æ›¿æ¢ç¬¦å·ç­‰ã€‚\n"),t("ul",[t("li",[_._v("ä¾‹å­ï¼šæŠŠ "),t("code",[_._v("<b>Hello</b>")]),_._v(" è½¬æ¢ä¸º "),t("code",[_._v("Hello")]),_._v("ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("Tokenizerï¼ˆåˆ†è¯å™¨ï¼‰")]),_._v("ï¼š\næ ¸å¿ƒç»„ä»¶ï¼Œå†³å®šå¦‚ä½•åˆ‡åˆ†æ–‡æœ¬æˆ tokenã€‚\n"),t("ul",[t("li",[_._v("ä¾‹å­ï¼š"),t("code",[_._v('"Hello World"')]),_._v(" â†’ "),t("code",[_._v('["Hello", "World"]')]),_._v("ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("Token Filtersï¼ˆè¯é¡¹è¿‡æ»¤å™¨ï¼‰")]),_._v("ï¼š\nå¯¹åˆ‡å‡ºæ¥çš„è¯é¡¹è¿›ä¸€æ­¥å¤„ç†ï¼Œæ¯”å¦‚å¤§å°å†™è½¬æ¢ã€åœç”¨è¯è¿‡æ»¤ã€è¯å¹²è¿˜åŸç­‰ã€‚\n"),t("ul",[t("li",[_._v("ä¾‹å­ï¼šæŠŠ "),t("code",[_._v('["Running", "Runs"]')]),_._v(" â†’ "),t("code",[_._v('["run", "run"]')]),_._v("ã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("å¸¸è§çš„å†…ç½®åˆ†è¯å™¨ï¼ˆAnalyzerï¼‰")])]),_._v(" "),t("ul",[t("li",[t("p",[_._v("Standard Analyzerï¼ˆé»˜è®¤åˆ†è¯å™¨ï¼‰ï¼šES é»˜è®¤åˆ†è¯å™¨ï¼ŒåŸºäº Unicode Text Segmentationã€‚")]),_._v(" "),t("ul",[t("li",[_._v("æŒ‰è¯æ³•è§„åˆ™æ‹†åˆ†å•è¯ã€å°å†™åŒ–ã€å»æ‰æ ‡ç‚¹ç¬¦å·ã€‚")]),_._v(" "),t("li",[t("code",[_._v('"The QUICK brown-foxes."')]),_._v(" â†’ "),t("code",[_._v('["the", "quick", "brown", "foxes"]')])])])]),_._v(" "),t("li",[t("p",[_._v("Simple Analyzerï¼šåªæŒ‰ç…§éå­—æ¯å­—ç¬¦æ‹†åˆ†ã€‚")]),_._v(" "),t("ul",[t("li",[_._v("å…¨éƒ¨è½¬å°å†™ã€ä¸ä¼šå»æ‰åœç”¨è¯ã€‚")]),_._v(" "),t("li",[t("code",[_._v('"Hello, WORLD!"')]),_._v(" â†’ "),t("code",[_._v('["hello", "world"]')])])])]),_._v(" "),t("li",[t("p",[_._v("Whitespace Analyzerï¼šä»…ä»…æŒ‰ç…§ç©ºæ ¼æ‹†åˆ†ï¼Œä¸åšå¤§å°å†™è½¬æ¢ã€‚")]),_._v(" "),t("ul",[t("li",[t("code",[_._v('"Hello World Test"')]),_._v(" â†’ "),t("code",[_._v('["Hello", "World", "Test"]')])])])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-mapping-æ˜ å°„-æ˜¯ä»€ä¹ˆ-åŠ¨æ€-mapping-å’Œé™æ€-mapping-æœ‰ä»€ä¹ˆåŒºåˆ«"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-mapping-æ˜ å°„-æ˜¯ä»€ä¹ˆ-åŠ¨æ€-mapping-å’Œé™æ€-mapping-æœ‰ä»€ä¹ˆåŒºåˆ«"}},[_._v("#")]),_._v(" ğŸ¯ Mappingï¼ˆæ˜ å°„ï¼‰æ˜¯ä»€ä¹ˆï¼ŸåŠ¨æ€ mapping å’Œé™æ€ mapping æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[t("strong",[_._v("Mapping å°±æ˜¯ç´¢å¼•çš„å­—æ®µå®šä¹‰ï¼Œç±»ä¼¼æ•°æ®åº“çš„è¡¨ç»“æ„ã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("åŠ¨æ€ mapping")]),_._v("ï¼šå­—æ®µè‡ªåŠ¨è¯†åˆ«ï¼Œæ–¹ä¾¿ä½†æœ‰é£é™©ï¼Œé€‚åˆå¿«é€Ÿå¼€å‘ã€‚")]),_._v(" "),t("p",[t("strong",[_._v("é™æ€ mapping")]),_._v("ï¼šå­—æ®µæ‰‹åŠ¨å®šä¹‰ï¼Œå®‰å…¨å¯æ§ï¼Œé€‚åˆç”Ÿäº§ç¯å¢ƒã€‚")]),_._v(" "),t("p",[_._v("é€šå¸¸ç”Ÿäº§ç¯å¢ƒæ¨è "),t("strong",[_._v("é™æ€ mapping")]),_._v(" æˆ– "),t("strong",[_._v("åŠ¨æ€æ¨¡æ¿ + éƒ¨åˆ†é™æ€ mapping")]),_._v(" æ¥å¹³è¡¡çµæ´»æ€§ä¸å¯æ§æ€§ã€‚")])]),_._v(" "),t("p",[_._v("åœ¨ Elasticsearch ä¸­ï¼Œ"),t("strong",[_._v("Mapping å°±æ˜¯ç´¢å¼•ä¸­å­—æ®µçš„ç»“æ„å®šä¹‰ï¼ˆç±»ä¼¼å…³ç³»å‹æ•°æ®åº“ä¸­çš„è¡¨ç»“æ„å’Œå­—æ®µç±»å‹çº¦æŸï¼‰")]),_._v("ã€‚")]),_._v(" "),t("p",[_._v("å®ƒå†³å®šäº†ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("æ¯ä¸ªå­—æ®µçš„æ•°æ®ç±»å‹ï¼ˆå¦‚ "),t("code",[_._v("text")]),_._v("ã€"),t("code",[_._v("keyword")]),_._v("ã€"),t("code",[_._v("integer")]),_._v("ã€"),t("code",[_._v("date")]),_._v("ï¼‰ã€‚")]),_._v(" "),t("li",[_._v("å­—æ®µæ˜¯å¦å¯è¢«ç´¢å¼•ï¼ˆ"),t("code",[_._v("index: true/false")]),_._v("ï¼‰ã€‚")]),_._v(" "),t("li",[_._v("ä½¿ç”¨çš„åˆ†è¯å™¨ï¼ˆanalyzerï¼‰ã€‚")]),_._v(" "),t("li",[_._v("æ˜¯å¦å­˜å‚¨åŸå§‹å€¼ï¼ˆ"),t("code",[_._v("store")]),_._v("ï¼‰ã€‚")])]),_._v(" "),t("p",[_._v("ğŸ‘‰ ç®€å•è¯´ï¼š"),t("strong",[_._v("Mapping å®šä¹‰äº†æ–‡æ¡£ä¸­å­—æ®µæ˜¯å¦‚ä½•å­˜å‚¨å’Œç´¢å¼•çš„ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("å¸¸è§å­—æ®µç±»å‹")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("å­—ç¬¦ä¸²ç±»å‹")]),_._v("ï¼š\n"),t("ul",[t("li",[t("code",[_._v("text")]),_._v("ï¼šä¼šåˆ†è¯ï¼Œé€‚åˆå…¨æ–‡æ£€ç´¢ã€‚")]),_._v(" "),t("li",[t("code",[_._v("keyword")]),_._v("ï¼šä¸åˆ†è¯ï¼Œé€‚åˆç²¾ç¡®åŒ¹é…ï¼ˆIDã€æ ‡ç­¾ã€é‚®ç®±ç­‰ï¼‰ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("æ•°å­—ç±»å‹")]),_._v("ï¼š"),t("code",[_._v("integer")]),_._v("ã€"),t("code",[_._v("long")]),_._v("ã€"),t("code",[_._v("double")]),_._v("ã€"),t("code",[_._v("float")]),_._v(" ç­‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("å¸ƒå°”ç±»å‹")]),_._v("ï¼š"),t("code",[_._v("boolean")]),_._v("ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("æ—¥æœŸç±»å‹")]),_._v("ï¼š"),t("code",[_._v("date")]),_._v("ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("å¤æ‚ç±»å‹")]),_._v("ï¼š"),t("code",[_._v("object")]),_._v("ã€"),t("code",[_._v("nested")]),_._v("ï¼ˆä¸“é—¨ç”¨äºåµŒå¥—å¯¹è±¡ï¼‰ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("åŠ¨æ€ Mapping")]),_._v("ï¼šElasticsearch æ”¯æŒ "),t("strong",[_._v("åŠ¨æ€æ˜ å°„")]),_._v("ï¼Œå³æ’å…¥æ–‡æ¡£æ—¶ï¼Œå¦‚æœå­—æ®µä¸å­˜åœ¨ï¼Œä¼šè‡ªåŠ¨æ¨æ–­å­—æ®µç±»å‹å¹¶æ·»åŠ åˆ° mappingã€‚")]),_._v(" "),t("ul",[t("li",[t("p",[t("strong",[_._v("ä¼˜ç‚¹")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("ä½¿ç”¨æ–¹ä¾¿ï¼Œä¸éœ€è¦æå‰è®¾è®¡è¡¨ç»“æ„ã€‚")]),_._v(" "),t("li",[_._v("é€‚åˆå¿«é€Ÿå¼€å‘ã€æ¢ç´¢æ•°æ®ç»“æ„ã€‚")])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("ç¼ºç‚¹")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("æ¨æ–­ç±»å‹å¯èƒ½ä¸å‡†ç¡®ï¼ˆæ¯”å¦‚ "),t("code",[_._v('"123"')]),_._v(" å¯èƒ½è¢«è¯†åˆ«ä¸º "),t("code",[_._v("long")]),_._v("ï¼Œä½†å…¶å®æ˜¯å­—ç¬¦ä¸²ï¼‰ã€‚")]),_._v(" "),t("li",[_._v("ä¸€æ—¦å­—æ®µç±»å‹è¢«ç¡®å®šï¼Œå°±ä¸èƒ½ä¿®æ”¹ã€‚")]),_._v(" "),t("li",[_._v("å®¹æ˜“å‡ºç° mapping çˆ†ç‚¸ï¼ˆæ¯”å¦‚ JSON åŠ¨æ€å­—æ®µè¿‡å¤šï¼‰ã€‚")])]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"age"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("25")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"Tom"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"is_active"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[_._v("true")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])]),t("p",[_._v("ES ä¼šè‡ªåŠ¨ç”Ÿæˆ mappingï¼š")]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"properties"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"age"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"long"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"text"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"fields"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"keyword"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"keyword"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"is_active"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"boolean"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])])])]),_._v(" "),t("p",[t("strong",[_._v("é™æ€ Mapping")]),_._v("ï¼šç”¨æˆ·åœ¨åˆ›å»ºç´¢å¼•æ—¶ï¼Œ"),t("strong",[_._v("æ‰‹åŠ¨æŒ‡å®š mapping ç»“æ„")]),_._v("ï¼Œå­—æ®µç±»å‹å’Œé…ç½®ä¸ä¼šä¾èµ– ES çš„è‡ªåŠ¨æ¨æ–­ã€‚")]),_._v(" "),t("ul",[t("li",[t("p",[t("strong",[_._v("ä¼˜ç‚¹")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("ç±»å‹æ›´ç²¾ç¡®ï¼Œé¿å… ES è‡ªåŠ¨æ¨æ–­é”™è¯¯ã€‚")]),_._v(" "),t("li",[_._v("å¯æŒ‡å®š analyzerã€indexã€store ç­‰é…ç½®ï¼Œæ›´çµæ´»ã€‚")]),_._v(" "),t("li",[_._v("é¿å… mapping çˆ†ç‚¸é—®é¢˜ã€‚")])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("ç¼ºç‚¹")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("éœ€è¦æå‰è®¾è®¡æ•°æ®ç»“æ„ã€‚")]),_._v(" "),t("li",[_._v("çµæ´»æ€§ä¸å¦‚åŠ¨æ€ mappingã€‚")])]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[_._v("PUT users\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"mappings"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"properties"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"age"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"integer"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"name"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"keyword"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"created_at"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"type"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"date"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"format"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"yyyy-MM-dd HH:mm:ss"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-mapping-æœ‰ä½•è®²ç©¶-text-vs-keywordã€multi-fieldsã€normalizer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-mapping-æœ‰ä½•è®²ç©¶-text-vs-keywordã€multi-fieldsã€normalizer"}},[_._v("#")]),_._v(" ğŸ¯ Mapping æœ‰ä½•è®²ç©¶ï¼Ÿtext vs keywordã€multi-fieldsã€normalizerï¼Ÿ")]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("text")]),_._v("ï¼šåˆ†è¯ï¼Œé€‚åˆå…¨æ–‡æ£€ç´¢ï¼Œä¸é€‚åˆèšåˆ/æ’åºï¼ˆé™¤éå¯ç”¨ "),t("code",[_._v("fielddata")]),_._v("ï¼Œä½†æè€—å†…å­˜ï¼Œä¸æ¨èï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("keyword")]),_._v("ï¼šä¸åˆ†è¯ï¼Œé€‚åˆç²¾ç¡®åŒ¹é…ã€èšåˆã€æ’åºï¼›å¯é… "),t("strong",[_._v("normalizer")]),_._v("ï¼ˆå°å†™åŒ–ã€å»ç©ºæ ¼ï¼‰åšè§„èŒƒåŒ–ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("multi-fields")]),_._v("ï¼šä¸€ä¸ªå­—æ®µæ—¢è¦æœç´¢åˆè¦èšåˆï¼š"),t("code",[_._v("title")]),_._v(" æ˜ å°„ä¸º "),t("code",[_._v("text")]),_._v("ï¼ŒåŒæ—¶åŠ  "),t("code",[_._v("title.keyword")]),_._v(" ä¸º "),t("code",[_._v("keyword")]),_._v("ã€‚")]),_._v(" "),t("li",[_._v("å°½é‡ "),t("strong",[_._v("é™æ€æ˜ç¡® mapping")]),_._v("ï¼Œç”¨ "),t("strong",[_._v("dynamic_templates")]),_._v(" æ§åˆ¶è‡ªåŠ¨æ˜ å°„ï¼Œé¿å…è¯¯åˆ¤ç±»å‹ï¼ˆå¦‚æ•°å€¼è¢«æ˜ å°„æˆ textï¼‰ã€‚")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-es-çš„æ–‡æ¡£æ˜¯å¦‚ä½•è¢«å­˜å‚¨å’Œæ£€ç´¢çš„"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-çš„æ–‡æ¡£æ˜¯å¦‚ä½•è¢«å­˜å‚¨å’Œæ£€ç´¢çš„"}},[_._v("#")]),_._v(" ğŸ¯ ES çš„æ–‡æ¡£æ˜¯å¦‚ä½•è¢«å­˜å‚¨å’Œæ£€ç´¢çš„ï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[t("strong",[_._v("å­˜å‚¨")]),_._v("ï¼šæ–‡æ¡£ä»¥ JSON å½¢å¼å†™å…¥ï¼Œæ ¹æ® "),t("code",[_._v("_id")]),_._v(" è·¯ç”±åˆ°åˆ†ç‰‡ â†’ åˆ†è¯å™¨å¯¹ "),t("code",[_._v("text")]),_._v(" å­—æ®µå»ºç«‹å€’æ’ç´¢å¼•ï¼ŒåŒæ—¶å­˜å‚¨åŸå§‹æ–‡æ¡£ "),t("code",[_._v("_source")]),_._v("ï¼Œæ•°æ®è½åˆ° Lucene çš„ "),t("strong",[_._v("segment")]),_._v(" æ–‡ä»¶ã€‚")]),_._v(" "),t("p",[t("strong",[_._v("æ£€ç´¢")]),_._v("ï¼šæŸ¥è¯¢è¯·æ±‚åˆ†å‘åˆ°å„åˆ†ç‰‡ â†’ åˆ†è¯åŒ¹é…å€’æ’ç´¢å¼• â†’ è®¡ç®—ç›¸å…³åº¦ â†’ å„åˆ†ç‰‡è¿”å›ç»“æœ â†’ åè°ƒèŠ‚ç‚¹åˆå¹¶æ’åº â†’ è¿”å›æœ€ç»ˆç»“æœã€‚")]),_._v(" "),t("p",[t("strong",[_._v("æ ¸å¿ƒç»“æ„")]),_._v("ï¼šå€’æ’ç´¢å¼•ï¼ˆå…¨æ–‡æ£€ç´¢ï¼‰ã€æ­£æ’ç´¢å¼•ï¼ˆèšåˆ/æ’åºï¼‰ã€æ®µæ–‡ä»¶ï¼ˆå­˜å‚¨å•å…ƒï¼‰ã€‚")])]),_._v(" "),t("p",[_._v("åœ¨ Elasticsearch ä¸­ï¼Œæ–‡æ¡£æ˜¯ JSON æ ¼å¼çš„ï¼Œå­˜å‚¨è¿‡ç¨‹å¤§è‡´å¦‚ä¸‹ï¼š")]),_._v(" "),t("p",[t("strong",[_._v("å†™å…¥æµç¨‹")])]),_._v(" "),t("ol",[t("li",[t("p",[t("strong",[_._v("å®¢æˆ·ç«¯å†™å…¥æ–‡æ¡£")]),_._v("ï¼ˆJSON å¯¹è±¡ï¼‰ã€‚")]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"id"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"title"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"Elasticsearch is great"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"tag"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"search"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("è·¯ç”±åˆ°åˆ†ç‰‡")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("æ ¹æ®æ–‡æ¡£çš„ "),t("code",[_._v("_id")]),_._v("ï¼ˆæˆ–æŒ‡å®šçš„ routing å€¼ï¼‰ï¼Œé€šè¿‡ "),t("strong",[_._v("hash ç®—æ³•")]),_._v("å†³å®šå­˜å‚¨åœ¨å“ªä¸ªä¸»åˆ†ç‰‡ï¼ˆPrimary Shardï¼‰ä¸Šã€‚")]),_._v(" "),t("li",[_._v("å¤åˆ¶åˆ°å‰¯æœ¬åˆ†ç‰‡ï¼ˆReplica Shardï¼‰ã€‚")])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("å€’æ’ç´¢å¼•ï¼ˆInverted Indexï¼‰æ„å»º")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("å¯¹ "),t("code",[_._v("text")]),_._v(" ç±»å‹å­—æ®µï¼ˆå¦‚ "),t("code",[_._v("title")]),_._v("ï¼‰æ‰§è¡Œ "),t("strong",[_._v("åˆ†è¯ï¼ˆAnalyzerï¼‰")]),_._v(" â†’ "),t("code",[_._v('["elasticsearch", "is", "great"]')]),_._v("ã€‚")]),_._v(" "),t("li",[_._v("å°†æ¯ä¸ªè¯æ¡å†™å…¥å€’æ’ç´¢å¼•ï¼ˆTerm Dictionary + Posting Listï¼‰ã€‚")]),_._v(" "),t("li",[_._v("å¯¹ "),t("code",[_._v("keyword")]),_._v("ã€"),t("code",[_._v("date")]),_._v("ã€"),t("code",[_._v("integer")]),_._v(" ç­‰å­—æ®µå­˜å‚¨ä¸ºå•å€¼ï¼Œç›´æ¥å†™å…¥ç´¢å¼•ç»“æ„ã€‚")])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("å­˜å‚¨åŸå§‹æ–‡æ¡£")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("ES é»˜è®¤ä¼šåœ¨ "),t("code",[_._v("_source")]),_._v(" å­—æ®µé‡Œå­˜å‚¨åŸå§‹ JSON æ–‡æ¡£ï¼Œä¾¿äºåç»­è¿”å›å’Œ reindexã€‚")]),_._v(" "),t("li",[_._v("åº•å±‚åŸºäº "),t("strong",[_._v("Lucene")]),_._v("ï¼Œå­˜å‚¨åœ¨ "),t("strong",[_._v("æ®µï¼ˆsegmentï¼‰")]),_._v(" æ–‡ä»¶ä¸­ã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("æ–‡æ¡£æ˜¯å¦‚ä½•æ£€ç´¢çš„ï¼Ÿ")])]),_._v(" "),t("p",[t("strong",[_._v("æŸ¥è¯¢æµç¨‹")])]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("å®¢æˆ·ç«¯å‘èµ·æŸ¥è¯¢è¯·æ±‚")]),_._v("ï¼šå¯ä»¥æ˜¯å…¨æ–‡æ£€ç´¢ï¼ˆmatchï¼‰ã€ç²¾ç¡®åŒ¹é…ï¼ˆtermï¼‰ã€èšåˆï¼ˆaggregationï¼‰ç­‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("è·¯ç”±åˆ°æ‰€æœ‰ç›¸å…³åˆ†ç‰‡")]),_._v("ï¼šåè°ƒèŠ‚ç‚¹ï¼ˆcoordinating nodeï¼‰å°†æŸ¥è¯¢å¹¿æ’­åˆ°ç›®æ ‡ç´¢å¼•çš„æ‰€æœ‰åˆ†ç‰‡ï¼ˆä¸»åˆ†ç‰‡æˆ–å‰¯æœ¬åˆ†ç‰‡ï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("åˆ†ç‰‡å†…æ‰§è¡Œæœç´¢")]),_._v(" "),t("ul",[t("li",[_._v("å¯¹ "),t("code",[_._v("text")]),_._v(" å­—æ®µï¼Œå…ˆå¯¹æŸ¥è¯¢å­—ç¬¦ä¸²åˆ†è¯ã€‚\n"),t("ul",[t("li",[_._v("ä¾‹å¦‚ï¼šæœç´¢ "),t("code",[_._v('"great elasticsearch"')]),_._v(" â†’ åˆ†è¯æˆ "),t("code",[_._v('["great", "elasticsearch"]')]),_._v("ã€‚")])])]),_._v(" "),t("li",[_._v("åœ¨å€’æ’ç´¢å¼•é‡Œæ‰¾åˆ°åŒ…å«è¿™äº›è¯çš„æ–‡æ¡£ IDï¼ˆdocIDï¼‰ã€‚")]),_._v(" "),t("li",[_._v("è®¡ç®—æ¯ä¸ªæ–‡æ¡£çš„ç›¸å…³åº¦ï¼ˆTF-IDF / BM25ï¼‰ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("åˆå¹¶ç»“æœ")]),_._v(" "),t("ul",[t("li",[_._v("å„åˆ†ç‰‡è¿”å›åŒ¹é…ç»“æœå’Œå¾—åˆ†ã€‚")]),_._v(" "),t("li",[_._v("åè°ƒèŠ‚ç‚¹åˆå¹¶ã€æ’åºï¼Œå– Top N è¿”å›ç»™å®¢æˆ·ç«¯ã€‚")])])])]),_._v(" "),t("p",[t("strong",[_._v("èšåˆæµç¨‹")])]),_._v(" "),t("ul",[t("li",[_._v("å¦‚æœæ˜¯ "),t("strong",[_._v("èšåˆæŸ¥è¯¢")]),_._v("ï¼ˆæ¯”å¦‚ç»Ÿè®¡ tag çš„æ•°é‡ï¼‰ï¼ŒES ä¼šå…ˆåœ¨æ¯ä¸ªåˆ†ç‰‡æ‰§è¡Œéƒ¨åˆ†èšåˆï¼Œå†ç”±åè°ƒèŠ‚ç‚¹åšæœ€ç»ˆåˆå¹¶ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("åº•å±‚æ•°æ®ç»“æ„")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("å€’æ’ç´¢å¼•ï¼ˆInverted Indexï¼‰")]),_._v(" "),t("ul",[t("li",[_._v("ç±»ä¼¼ä¸€æœ¬å­—å…¸ï¼Œè®°å½•â€œè¯ â†’ å‡ºç°åœ¨å“ªäº›æ–‡æ¡£â€ã€‚")]),_._v(" "),t("li",[_._v("æ¯”å¦‚ "),t("code",[_._v("great â†’ [doc1, doc5, doc7]")]),_._v("ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("æ­£æ’ç´¢å¼•ï¼ˆStored Fields / Doc Valuesï¼‰")]),_._v(" "),t("ul",[t("li",[_._v("è®°å½•â€œæ–‡æ¡£ â†’ å­—æ®µå€¼â€ï¼Œä¸»è¦ç”¨äºæ’åºã€èšåˆã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("æ®µï¼ˆSegmentï¼‰")]),_._v(" "),t("ul",[t("li",[_._v("Lucene çš„æœ€å°å­˜å‚¨å•å…ƒï¼Œå†™å…¥æ—¶åªèƒ½è¿½åŠ ï¼Œä¸å¯ä¿®æ”¹ã€‚")]),_._v(" "),t("li",[_._v("åˆ é™¤/æ›´æ–°æ–‡æ¡£å®é™…ä¸Šæ˜¯æ‰“æ ‡è®°ï¼ˆdeletedï¼‰ï¼Œé€šè¿‡ "),t("strong",[_._v("merge")]),_._v(" è¿‡ç¨‹æ¸…ç†ã€‚")])])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-è¯¦ç»†æè¿°ä¸€ä¸‹elasticsearchç´¢å¼•æ–‡æ¡£çš„è¿‡ç¨‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-è¯¦ç»†æè¿°ä¸€ä¸‹elasticsearchç´¢å¼•æ–‡æ¡£çš„è¿‡ç¨‹"}},[_._v("#")]),_._v(" ğŸ¯ è¯¦ç»†æè¿°ä¸€ä¸‹Elasticsearchç´¢å¼•æ–‡æ¡£çš„è¿‡ç¨‹")]),_._v(" "),t("p",[t("code",[_._v("é¢è¯•å®˜")]),_._v(" ï¼šæƒ³äº†è§£ESçš„åº•å±‚åŸç†ï¼Œä¸å†åªå…³æ³¨ä¸šåŠ¡å±‚é¢äº†ã€‚")]),_._v(" "),t("p",[t("code",[_._v("è§£ç­”")]),_._v(" ï¼šè¿™é‡Œçš„ç´¢å¼•æ–‡æ¡£åº”è¯¥ç†è§£ä¸ºæ–‡æ¡£å†™å…¥ESï¼Œåˆ›å»ºç´¢å¼•çš„è¿‡ç¨‹ã€‚æ–‡æ¡£å†™å…¥åŒ…å«ï¼šå•æ–‡æ¡£å†™å…¥å’Œæ‰¹é‡bulkå†™å…¥ï¼Œè¿™é‡Œåªè§£é‡Šä¸€ä¸‹ï¼šå•æ–‡æ¡£å†™å…¥æµç¨‹ã€‚")]),_._v(" "),t("p",[_._v("è®°ä½å®˜æ–¹æ–‡æ¡£ä¸­çš„è¿™ä¸ªå›¾ã€‚")]),_._v(" "),t("p",[t("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190119231620775.png",alt:""}})]),_._v(" "),t("p",[_._v("ç¬¬ä¸€æ­¥ï¼šå®¢æˆ·å†™é›†ç¾¤æŸèŠ‚ç‚¹å†™å…¥æ•°æ®ï¼Œå‘é€è¯·æ±‚ã€‚ï¼ˆå¦‚æœæ²¡æœ‰æŒ‡å®šè·¯ç”±/åè°ƒèŠ‚ç‚¹ï¼Œè¯·æ±‚çš„èŠ‚ç‚¹æ‰®æ¼”"),t("code",[_._v("è·¯ç”±èŠ‚ç‚¹")]),_._v(" çš„è§’è‰²ã€‚ï¼‰")]),_._v(" "),t("p",[_._v("ç¬¬äºŒæ­¥ï¼šèŠ‚ç‚¹1æ¥å—åˆ°è¯·æ±‚åï¼Œä½¿ç”¨æ–‡æ¡£_idæ¥ç¡®å®šæ–‡æ¡£å±äºåˆ†ç‰‡0ã€‚è¯·æ±‚ä¼šè¢«è½¬åˆ°å¦å¤–çš„èŠ‚ç‚¹ï¼Œå‡å®šèŠ‚ç‚¹3ã€‚å› æ­¤åˆ†ç‰‡0çš„ä¸»åˆ†ç‰‡åˆ†é…åˆ°èŠ‚ç‚¹3ä¸Šã€‚")]),_._v(" "),t("p",[_._v("ç¬¬ä¸‰æ­¥ï¼šèŠ‚ç‚¹3åœ¨ä¸»åˆ†ç‰‡ä¸Šæ‰§è¡Œå†™æ“ä½œï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™å°†è¯·æ±‚å¹¶è¡Œè½¬å‘åˆ°èŠ‚ç‚¹1å’ŒèŠ‚ç‚¹2çš„å‰¯æœ¬åˆ†ç‰‡ä¸Šï¼Œç­‰å¾…ç»“æœè¿”å›ã€‚æ‰€æœ‰çš„å‰¯æœ¬åˆ†ç‰‡éƒ½æŠ¥å‘ŠæˆåŠŸï¼ŒèŠ‚ç‚¹3å°†å‘åè°ƒèŠ‚ç‚¹ï¼ˆèŠ‚ç‚¹1ï¼‰æŠ¥å‘ŠæˆåŠŸï¼ŒèŠ‚ç‚¹1å‘è¯·æ±‚å®¢æˆ·ç«¯æŠ¥å‘Šå†™å…¥æˆåŠŸã€‚")]),_._v(" "),t("p",[_._v("å¦‚æœé¢è¯•å®˜å†é—®ï¼šç¬¬äºŒæ­¥ä¸­çš„æ–‡æ¡£è·å–åˆ†ç‰‡çš„è¿‡ç¨‹ï¼Ÿå›ç­”ï¼šå€ŸåŠ©è·¯ç”±ç®—æ³•è·å–ï¼Œè·¯ç”±ç®—æ³•å°±æ˜¯æ ¹æ®è·¯ç”±å’Œæ–‡æ¡£idè®¡ç®—ç›®æ ‡çš„åˆ†ç‰‡idçš„è¿‡ç¨‹ã€‚")]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v("shard = hash(_routing) % (num_of_primary_shards)\n")])])]),t("h3",{attrs:{id:"ğŸ¯-è¯¦ç»†æè¿°ä¸€ä¸‹elasticsearchæœç´¢çš„è¿‡ç¨‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-è¯¦ç»†æè¿°ä¸€ä¸‹elasticsearchæœç´¢çš„è¿‡ç¨‹"}},[_._v("#")]),_._v(" ğŸ¯ è¯¦ç»†æè¿°ä¸€ä¸‹Elasticsearchæœç´¢çš„è¿‡ç¨‹ï¼Ÿ")]),_._v(" "),t("p",[_._v("æœç´¢æ‹†è§£ä¸ºâ€œquery then fetchâ€ ä¸¤ä¸ªé˜¶æ®µã€‚"),t("strong",[_._v("queryé˜¶æ®µçš„ç›®çš„")]),_._v("ï¼šå®šä½åˆ°ä½ç½®ï¼Œä½†ä¸å–ã€‚æ­¥éª¤æ‹†è§£å¦‚ä¸‹ï¼š")]),_._v(" "),t("ol",[t("li",[_._v("å‡è®¾ä¸€ä¸ªç´¢å¼•æ•°æ®æœ‰5ä¸»+1å‰¯æœ¬ å…±10åˆ†ç‰‡ï¼Œä¸€æ¬¡è¯·æ±‚ä¼šå‘½ä¸­ï¼ˆä¸»æˆ–è€…å‰¯æœ¬åˆ†ç‰‡ä¸­ï¼‰çš„ä¸€ä¸ªã€‚")]),_._v(" "),t("li",[_._v("æ¯ä¸ªåˆ†ç‰‡åœ¨æœ¬åœ°è¿›è¡ŒæŸ¥è¯¢ï¼Œç»“æœè¿”å›åˆ°æœ¬åœ°æœ‰åºçš„ä¼˜å…ˆé˜Ÿåˆ—ä¸­ã€‚")]),_._v(" "),t("li",[_._v("ç¬¬ 2 æ­¥éª¤çš„ç»“æœå‘é€åˆ°åè°ƒèŠ‚ç‚¹ï¼Œåè°ƒèŠ‚ç‚¹äº§ç”Ÿä¸€ä¸ªå…¨å±€çš„æ’åºåˆ—è¡¨ã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("fetché˜¶æ®µçš„ç›®çš„")]),_._v("ï¼šå–æ•°æ®ã€‚è·¯ç”±èŠ‚ç‚¹è·å–æ‰€æœ‰æ–‡æ¡£ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚")]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-å¦‚ä½•ä½¿ç”¨-elasticsearch-è¿›è¡Œæ—¥å¿—åˆ†æ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å¦‚ä½•ä½¿ç”¨-elasticsearch-è¿›è¡Œæ—¥å¿—åˆ†æ"}},[_._v("#")]),_._v(" ğŸ¯ "),t("strong",[_._v("å¦‚ä½•ä½¿ç”¨ Elasticsearch è¿›è¡Œæ—¥å¿—åˆ†æï¼Ÿ")])]),_._v(" "),t("p",[_._v("å¯ä»¥ä½¿ç”¨ Elasticsearch çš„èšåˆåŠŸèƒ½è¿›è¡Œæ—¥å¿—æ•°æ®çš„åˆ†æï¼Œæ¯”å¦‚æŒ‰æ—¥æœŸç»Ÿè®¡æ—¥å¿—æ•°é‡ã€æŒ‰æ—¥å¿—çº§åˆ«èšåˆç­‰ã€‚")]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-elasticsearch-ä¸­çš„-bulk-æ“ä½œæ˜¯ä»€ä¹ˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-elasticsearch-ä¸­çš„-bulk-æ“ä½œæ˜¯ä»€ä¹ˆ"}},[_._v("#")]),_._v(" ğŸ¯ Elasticsearch ä¸­çš„ "),t("code",[_._v("bulk")]),_._v(" æ“ä½œæ˜¯ä»€ä¹ˆï¼Ÿ")]),_._v(" "),t("p",[t("code",[_._v("bulk")]),_._v(" æ“ä½œç”¨äºæ‰¹é‡æ’å…¥ã€æ›´æ–°ã€åˆ é™¤æ–‡æ¡£ï¼Œèƒ½å¤Ÿæé«˜æ“ä½œæ•ˆç‡ï¼Œå‡å°‘å•ç‹¬è¯·æ±‚çš„å¼€é”€ã€‚")]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-elasticsearch-ä¸­çš„èšåˆ-aggregation-æ˜¯ä»€ä¹ˆ-å¦‚ä½•ä½¿ç”¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-elasticsearch-ä¸­çš„èšåˆ-aggregation-æ˜¯ä»€ä¹ˆ-å¦‚ä½•ä½¿ç”¨"}},[_._v("#")]),_._v(" ğŸ¯ "),t("strong",[_._v("Elasticsearch ä¸­çš„èšåˆï¼ˆAggregationï¼‰æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•ä½¿ç”¨ï¼Ÿ")])]),_._v(" "),t("p",[_._v("èšåˆæ˜¯ Elasticsearch ä¸­è¿›è¡Œæ•°æ®ç»Ÿè®¡å’Œåˆ†æçš„åŠŸèƒ½ï¼Œå¸¸è§çš„èšåˆç±»å‹æœ‰ "),t("code",[_._v("avg")]),_._v("ï¼ˆå¹³å‡å€¼ï¼‰ã€"),t("code",[_._v("sum")]),_._v("ï¼ˆæ€»å’Œï¼‰ã€"),t("code",[_._v("terms")]),_._v("ï¼ˆæŒ‰å€¼åˆ†ç»„ï¼‰ç­‰ã€‚")]),_._v(" "),t("hr"),_._v(" "),t("h2",{attrs:{id:"ğŸŒ-ä¸‰ã€é›†ç¾¤ä¸æ¶æ„-é«˜å¯ç”¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸŒ-ä¸‰ã€é›†ç¾¤ä¸æ¶æ„-é«˜å¯ç”¨"}},[_._v("#")]),_._v(" ğŸŒ ä¸‰ã€é›†ç¾¤ä¸æ¶æ„ï¼ˆé«˜å¯ç”¨ï¼‰")]),_._v(" "),t("blockquote",[t("p",[t("strong",[_._v("æ ¸å¿ƒæ€æƒ³")]),_._v("ï¼šESé€šè¿‡ä¸»ä»èŠ‚ç‚¹ã€åˆ†ç‰‡å‰¯æœ¬ã€é€‰ä¸»æœºåˆ¶å®ç°åˆ†å¸ƒå¼é›†ç¾¤çš„é«˜å¯ç”¨ï¼Œç†è§£è¿™äº›æœºåˆ¶å¯¹ç”Ÿäº§ç¯å¢ƒè¿ç»´è‡³å…³é‡è¦ã€‚")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("èŠ‚ç‚¹è§’è‰²")]),_._v("ï¼š"),t("a",{attrs:{href:"#es-%E7%9A%84-master-%E8%8A%82%E7%82%B9%E5%92%8C-data-%E8%8A%82%E7%82%B9%E7%9A%84%E5%8C%BA%E5%88%AB"}},[_._v("Master vs DataèŠ‚ç‚¹")]),_._v(" | "),t("a",{attrs:{href:"#elasticsearch-%E7%9A%84%E9%9B%86%E7%BE%A4%E5%A6%82%E4%BD%95%E5%B7%A5%E4%BD%9C"}},[_._v("é›†ç¾¤å·¥ä½œåŸç†")])]),_._v(" "),t("li",[t("strong",[_._v("é€‰ä¸»æœºåˆ¶")]),_._v("ï¼š"),t("a",{attrs:{href:"#%E9%9B%86%E7%BE%A4%E9%80%89%E4%B8%BB%E7%9A%84%E5%8E%9F%E7%90%86%E6%98%AF%E4%BB%80%E4%B9%88"}},[_._v("é›†ç¾¤é€‰ä¸»åŸç†")]),_._v(" | "),t("a",{attrs:{href:"#%E6%80%8E%E4%B9%88%E4%BF%9D%E8%AF%81-elasticsearch-%E7%9A%84%E9%AB%98%E5%8F%AF%E7%94%A8"}},[_._v("é«˜å¯ç”¨ä¿è¯")])]),_._v(" "),t("li",[t("strong",[_._v("åˆ†ç‰‡ç®¡ç†")]),_._v("ï¼š"),t("a",{attrs:{href:"#%E5%88%86%E7%89%87%E5%A6%82%E4%BD%95%E8%A7%84%E5%88%92%E4%B8%8E%E5%B8%B8%E8%A7%81%E7%9B%91%E6%8E%A7"}},[_._v("åˆ†ç‰‡è§„åˆ’")]),_._v(" | "),t("a",{attrs:{href:"#%E5%A6%82%E6%9E%9C%E4%B8%80%E4%B8%AA%E5%88%86%E7%89%87%E4%B8%A2%E5%A4%B1%E4%BA%86es-%E6%98%AF%E5%A6%82%E4%BD%95%E6%81%A2%E5%A4%8D%E7%9A%84"}},[_._v("åˆ†ç‰‡æ¢å¤")])]),_._v(" "),t("li",[t("strong",[_._v("æ•°æ®æµè½¬")]),_._v("ï¼š"),t("a",{attrs:{href:"#%E5%86%99%E5%85%A5%E6%95%B0%E6%8D%AE%E6%97%B6es-%E7%9A%84%E5%86%99%E5%85%A5%E6%B5%81%E7%A8%8B%E6%98%AF%E6%80%8E%E6%A0%B7%E7%9A%84"}},[_._v("å†™å…¥æµç¨‹")]),_._v(" | "),t("a",{attrs:{href:"#%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E6%97%B6es-%E7%9A%84%E6%9F%A5%E8%AF%A2%E6%B5%81%E7%A8%8B%E6%98%AF%E6%80%8E%E6%A0%B7%E7%9A%84"}},[_._v("æŸ¥è¯¢æµç¨‹")]),_._v(" | "),t("a",{attrs:{href:"#%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96%E4%B8%8E-filter-%E7%9A%84%E4%BD%BF%E7%94%A8"}},[_._v("æŸ¥è¯¢ä¼˜åŒ–")])]),_._v(" "),t("li",[t("strong",[_._v("æ·±åˆ†é¡µé—®é¢˜")]),_._v("ï¼š"),t("a",{attrs:{href:"#%E6%B7%B1%E5%88%86%E9%A1%B5%E6%80%8E%E4%B9%88%E5%81%9Ascroll-%E4%B8%8E-search_after-%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9"}},[_._v("æ·±åˆ†é¡µåŸç†")])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-elasticsearch-çš„é›†ç¾¤å¦‚ä½•å·¥ä½œ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-elasticsearch-çš„é›†ç¾¤å¦‚ä½•å·¥ä½œ"}},[_._v("#")]),_._v(" ğŸ¯ Elasticsearch çš„é›†ç¾¤å¦‚ä½•å·¥ä½œï¼Ÿ")]),_._v(" "),t("p",[_._v("Elasticsearch çš„é›†ç¾¤ç”±å¤šä¸ªèŠ‚ç‚¹ç»„æˆï¼Œè¿™äº›èŠ‚ç‚¹é€šè¿‡ç½‘ç»œè¿›è¡Œé€šä¿¡ï¼Œå…±åŒè´Ÿè´£å­˜å‚¨å’Œå¤„ç†æ•°æ®ã€‚é›†ç¾¤ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥å……å½“ä¸åŒçš„è§’è‰²ï¼Œä¾‹å¦‚ä¸»èŠ‚ç‚¹ã€æ•°æ®èŠ‚ç‚¹å’Œåè°ƒèŠ‚ç‚¹ã€‚")]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-es-çš„-master-èŠ‚ç‚¹å’Œ-data-èŠ‚ç‚¹çš„åŒºåˆ«"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-çš„-master-èŠ‚ç‚¹å’Œ-data-èŠ‚ç‚¹çš„åŒºåˆ«"}},[_._v("#")]),_._v(" ğŸ¯ ES çš„ Master èŠ‚ç‚¹å’Œ Data èŠ‚ç‚¹çš„åŒºåˆ«ï¼Ÿ")]),_._v(" "),t("p",[_._v("åœ¨Elasticsearché›†ç¾¤ä¸­ï¼ŒMasterèŠ‚ç‚¹å’ŒDataèŠ‚ç‚¹æ‰¿æ‹…ç€ä¸åŒçš„è§’è‰²å’ŒèŒè´£ï¼š")]),_._v(" "),t("p",[t("strong",[_._v("MasterèŠ‚ç‚¹")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("ä¸»è¦è´Ÿè´£é›†ç¾¤å±‚é¢çš„ç®¡ç†æ“ä½œ")]),_._v(" "),t("li",[_._v("ç»´æŠ¤é›†ç¾¤çŠ¶æ€(Cluster State)çš„æƒå¨å‰¯æœ¬")]),_._v(" "),t("li",[_._v("è´Ÿè´£ç´¢å¼•çš„åˆ›å»ºã€åˆ é™¤ç­‰å…ƒæ•°æ®æ“ä½œ")]),_._v(" "),t("li",[_._v("å¤„ç†èŠ‚ç‚¹åŠ å…¥/ç¦»å¼€é›†ç¾¤çš„åè°ƒå·¥ä½œ")]),_._v(" "),t("li",[_._v("ä¸å­˜å‚¨æ•°æ®ï¼Œä¹Ÿä¸å‚ä¸æ•°æ®çš„CRUDæ“ä½œ")]),_._v(" "),t("li",[_._v("é€šè¿‡é€‰ä¸¾äº§ç”Ÿä¸»MasterèŠ‚ç‚¹(Leader)ï¼Œå…¶ä»–MasterèŠ‚ç‚¹ä½œä¸ºå€™é€‰èŠ‚ç‚¹")])]),_._v(" "),t("p",[t("strong",[_._v("DataèŠ‚ç‚¹")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("è´Ÿè´£æ•°æ®çš„å®é™…å­˜å‚¨å’Œæ£€ç´¢")]),_._v(" "),t("li",[_._v("å¤„ç†æ‰€æœ‰æ–‡æ¡£çº§åˆ«çš„CRUDæ“ä½œ")]),_._v(" "),t("li",[_._v("æ‰§è¡Œæœç´¢ã€èšåˆç­‰æ•°æ®æŸ¥è¯¢è¯·æ±‚")]),_._v(" "),t("li",[_._v("å‚ä¸ç´¢å¼•çš„åˆ†ç‰‡(Shard)åˆ†é…å’Œå¤åˆ¶")]),_._v(" "),t("li",[_._v("ä¸å‚ä¸é›†ç¾¤ç®¡ç†å†³ç­–")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-é›†ç¾¤é€‰ä¸»çš„åŸç†æ˜¯ä»€ä¹ˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-é›†ç¾¤é€‰ä¸»çš„åŸç†æ˜¯ä»€ä¹ˆ"}},[_._v("#")]),_._v(" ğŸ¯ é›†ç¾¤é€‰ä¸»çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ")]),_._v(" "),t("p",[_._v("Elasticsearché›†ç¾¤çš„é€‰ä¸»è¿‡ç¨‹åŸºäºåˆ†å¸ƒå¼ä¸€è‡´æ€§ç®—æ³•å®ç°ï¼Œä¸»è¦æµç¨‹å¦‚ä¸‹ï¼š")]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("å‘ç°é˜¶æ®µ")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("èŠ‚ç‚¹å¯åŠ¨æ—¶é€šè¿‡"),t("code",[_._v("discovery.seed_hosts")]),_._v("(7.x+)æˆ–"),t("code",[_._v("discovery.zen.ping.unicast.hosts")]),_._v("(7.xå‰)å‘ç°å…¶ä»–èŠ‚ç‚¹")]),_._v(" "),t("li",[_._v("ä½¿ç”¨Zen Discoveryæ¨¡å—è¿›è¡ŒèŠ‚ç‚¹é—´é€šä¿¡")])])]),_._v(" "),t("li",[t("strong",[_._v("é€‰ä¸¾è§¦å‘æ¡ä»¶")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("é›†ç¾¤å¯åŠ¨æ—¶")]),_._v(" "),t("li",[_._v("å½“å‰ä¸»èŠ‚ç‚¹å¤±æ•ˆæ—¶(å¿ƒè·³è¶…æ—¶)")]),_._v(" "),t("li",[_._v("ç½‘ç»œåˆ†åŒºå¯¼è‡´æ— æ³•è”ç³»ä¸»èŠ‚ç‚¹æ—¶")])])]),_._v(" "),t("li",[t("strong",[_._v("é€‰ä¸¾è¿‡ç¨‹")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("ç¬¦åˆæ¡ä»¶(master eligible)çš„èŠ‚ç‚¹å‚ä¸é€‰ä¸¾")]),_._v(" "),t("li",[_._v('åŸºäºBullyç®—æ³•å˜ç§å®ç°ï¼š a) æ¯ä¸ªèŠ‚ç‚¹å‘å…¶ä»–èŠ‚ç‚¹å‘é€æŠ•ç¥¨è¯·æ±‚ b) èŠ‚ç‚¹æ¯”è¾ƒID(é»˜è®¤æŒ‰èŠ‚ç‚¹IDå­—å…¸åº)ï¼ŒID"è¾ƒå¤§"çš„èŠ‚ç‚¹èƒœå‡º c) è·å¾—å¤šæ•°ç¥¨(N/2+1)çš„èŠ‚ç‚¹æˆä¸ºä¸»èŠ‚ç‚¹')])])]),_._v(" "),t("li",[t("strong",[_._v("é›†ç¾¤çŠ¶æ€å‘å¸ƒ")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("æ–°ä¸»èŠ‚ç‚¹ç”Ÿæˆæ–°ç‰ˆæœ¬é›†ç¾¤çŠ¶æ€")]),_._v(" "),t("li",[_._v("å°†é›†ç¾¤çŠ¶æ€å‘å¸ƒç»™æ‰€æœ‰èŠ‚ç‚¹")]),_._v(" "),t("li",[_._v("èŠ‚ç‚¹ç¡®è®¤æ¥æ”¶åå®Œæˆä¸»èŠ‚ç‚¹åˆ‡æ¢")])])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-åˆ†ç‰‡å¦‚ä½•è§„åˆ’ä¸å¸¸è§ç›‘æ§"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-åˆ†ç‰‡å¦‚ä½•è§„åˆ’ä¸å¸¸è§ç›‘æ§"}},[_._v("#")]),_._v(" ğŸ¯ åˆ†ç‰‡å¦‚ä½•è§„åˆ’ä¸å¸¸è§ç›‘æ§ï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[_._v("åˆ†ç‰‡çš„è§„åˆ’è¦ç»“åˆ "),t("strong",[_._v("æ•°æ®é‡ã€èŠ‚ç‚¹æ•°å’ŒæŸ¥è¯¢åœºæ™¯")]),_._v(" æ¥å†³å®šã€‚ä¸€èˆ¬å»ºè®®å•åˆ†ç‰‡æ§åˆ¶åœ¨ 10GB~50GB ä¹‹é—´ï¼Œé¿å…åˆ†ç‰‡è¿‡å¤šæˆ–è¿‡å°ã€‚\næ¯”å¦‚ä¸€ä¸ª 1TB çš„ç´¢å¼•ï¼Œå¦‚æœå•åˆ†ç‰‡ 40GBï¼Œå¤§æ¦‚éœ€è¦ 25 ä¸ªä¸»åˆ†ç‰‡ï¼ŒåŠ ä¸Šå‰¯æœ¬å°±æ˜¯ 50 ä¸ªåˆ†ç‰‡ï¼Œå†å¹³å‡åˆ†é…åˆ° 10 ä¸ªèŠ‚ç‚¹ä¸Šæ¯”è¾ƒåˆé€‚ã€‚")]),_._v(" "),t("p",[_._v("åœ¨ç›‘æ§æ–¹é¢ï¼Œä¸»è¦å…³æ³¨ "),t("strong",[_._v("é›†ç¾¤å¥åº·çŠ¶æ€")]),_._v("ï¼ˆgreen/yellow/redï¼‰ã€"),t("strong",[_._v("åˆ†ç‰‡åˆ†é…æ˜¯å¦å‡è¡¡")]),_._v("ã€"),t("strong",[_._v("æŸ¥è¯¢å’Œå†™å…¥å»¶è¿Ÿ")]),_._v("ã€"),t("strong",[_._v("JVM å†…å­˜å’Œ GC")]),_._v("ã€"),t("strong",[_._v("ç£ç›˜åˆ©ç”¨ç‡")]),_._v("ï¼Œä»¥åŠåˆ†ç‰‡å¤§å°æ˜¯å¦åˆç†ã€‚")]),_._v(" "),t("p",[_._v("å®é™…é¡¹ç›®é‡Œï¼Œæˆ‘ä¼šç»“åˆ "),t("strong",[_._v("_cat/shards")]),_._v("ã€"),t("strong",[_._v("_cluster/health")]),_._v(" å’Œç›‘æ§å¹³å°ï¼ˆæ¯”å¦‚ X-Pack Monitoringã€Prometheus + Grafanaï¼‰æ¥å®æ—¶ç›‘æ§è¿™äº›æŒ‡æ ‡ï¼Œé¿å…åˆ†ç‰‡ä¸å‡è¡¡æˆ–è€…èŠ‚ç‚¹è¿‡è½½ã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("ä¸€ã€åˆ†ç‰‡å¦‚ä½•è§„åˆ’")])]),_._v(" "),t("p",[t("strong",[_._v("1. åˆ†ç‰‡çš„åŸºæœ¬åŸåˆ™")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("ä¸»åˆ†ç‰‡æ•° (primary shards)")]),_._v(" å†³å®šç´¢å¼•çš„æœ€å¤§æ‰©å±•èƒ½åŠ›ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("å‰¯æœ¬æ•° (replicas)")]),_._v(" æä¾›é«˜å¯ç”¨å’Œå¹¶å‘æŸ¥è¯¢èƒ½åŠ›ã€‚")]),_._v(" "),t("li",[_._v("åˆ†ç‰‡ä¸€æ—¦å»ºå¥½ï¼Œä¸»åˆ†ç‰‡æ•°ä¸èƒ½æ”¹ï¼ˆé™¤é reindexï¼‰ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("2. è§„åˆ’æ€è·¯")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("å•åˆ†ç‰‡å¤§å°å»ºè®®")]),_._v("ï¼š10GBï½50GBï¼ˆLucene å±‚é¢å¤ªå¤§å¤ªå°éƒ½ä¸åˆé€‚ï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("æ€»åˆ†ç‰‡æ•°å»ºè®®")]),_._v("ï¼šä¸è¦è¶…è¿‡ "),t("code",[_._v("20 * èŠ‚ç‚¹æ•°")]),_._v("ï¼Œå¦åˆ™é›†ç¾¤ç®¡ç†å¼€é”€å¤§ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("è®¡ç®—æ–¹æ³•")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("é¢„ä¼°ç´¢å¼•å¤§å° Ã· å•åˆ†ç‰‡å¤§å° â‰ˆ ä¸»åˆ†ç‰‡æ•°ã€‚")]),_._v(" "),t("li",[_._v("ç»“åˆèŠ‚ç‚¹æ•°å’Œå‰¯æœ¬æ•°åšåˆ†é…ã€‚")])])])]),_._v(" "),t("p",[t("strong",[_._v("ä¾‹å­")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("é¢„è®¡ä¸€ä¸ªç´¢å¼• 1TB æ•°æ®ï¼Œæ¯ä¸ªåˆ†ç‰‡ 40GBã€‚")]),_._v(" "),t("li",[_._v("ä¸»åˆ†ç‰‡æ•° = 1000GB Ã· 40GB â‰ˆ 25ã€‚")]),_._v(" "),t("li",[_._v("å¦‚æœå‰¯æœ¬æ•° = 1ï¼Œæ€»åˆ†ç‰‡æ•° = 50ã€‚")]),_._v(" "),t("li",[_._v("å‡å¦‚æœ‰ 10 ä¸ªèŠ‚ç‚¹ï¼Œé‚£æ¯ä¸ªèŠ‚ç‚¹å¹³å‡åˆ†é… 5 ä¸ªåˆ†ç‰‡ï¼Œæ¯”è¾ƒå‡è¡¡ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("3. è¡Œä¸šå¸¸è§åšæ³•")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("æ—¥å¿—ç±»æ•°æ®")]),_._v("ï¼šæŒ‰å¤©/æœˆåˆ†ç´¢å¼•ï¼Œæ¯ä¸ªç´¢å¼•è®¾ç½®åˆé€‚çš„åˆ†ç‰‡æ•°ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("å•†å“åº“/ç”µå•†æ•°æ®")]),_._v("ï¼šç´¢å¼•ç›¸å¯¹ç¨³å®šï¼Œå¯ä»¥æŒ‰æ•°æ®é‡è§„åˆ’å›ºå®šåˆ†ç‰‡æ•°ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("å†·çƒ­åˆ†ç¦»")]),_._v("ï¼šæ–°æ•°æ®ç”¨å¿«ç›˜+è¾ƒå¤šå‰¯æœ¬ï¼Œè€æ•°æ®ç”¨æ…¢ç›˜+å‡å°‘å‰¯æœ¬ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("äºŒã€å¸¸è§ç›‘æ§æŒ‡æ ‡")])]),_._v(" "),t("p",[t("strong",[_._v("1. é›†ç¾¤å¥åº·ï¼ˆCluster Healthï¼‰")])]),_._v(" "),t("ul",[t("li",[t("code",[_._v("green")]),_._v("ï¼šæ‰€æœ‰ä¸»åˆ†ç‰‡å’Œå‰¯æœ¬éƒ½æ­£å¸¸ã€‚")]),_._v(" "),t("li",[t("code",[_._v("yellow")]),_._v("ï¼šä¸»åˆ†ç‰‡æ­£å¸¸ï¼Œä½†å‰¯æœ¬ç¼ºå¤±ï¼ˆé›†ç¾¤ä»å¯ç”¨ï¼Œä½†æ²¡æœ‰é«˜å¯ç”¨ä¿éšœï¼‰ã€‚")]),_._v(" "),t("li",[t("code",[_._v("red")]),_._v("ï¼šä¸»åˆ†ç‰‡ä¸å¯ç”¨ï¼Œæ•°æ®ä¸¢å¤±é£é™©å¤§ã€‚")])]),_._v(" "),t("p",[_._v("ğŸ‘‰ ç›‘æ§å·¥å…·ï¼š"),t("code",[_._v("_cluster/health")]),_._v(" APIã€‚")]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("2. åˆ†ç‰‡çŠ¶æ€")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("æœªåˆ†é…åˆ†ç‰‡ï¼ˆunassigned shardsï¼‰")]),_._v("ï¼šå¸¸è§åŸå› æ˜¯èŠ‚ç‚¹ä¸å¤Ÿï¼Œæˆ–è€…ç£ç›˜æ»¡äº†ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("åˆ†ç‰‡è¿ç§»")]),_._v("ï¼šå¤§è§„æ¨¡ rebalancing æ—¶ï¼Œé›†ç¾¤æ€§èƒ½ä¼šæŠ–åŠ¨ã€‚")])]),_._v(" "),t("p",[_._v("ğŸ‘‰ ç›‘æ§å·¥å…·ï¼š"),t("code",[_._v("_cat/shards")]),_._v("ã€‚")]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("3. æ€§èƒ½ç›¸å…³æŒ‡æ ‡")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("åˆ†ç‰‡å¤§å°")]),_._v("ï¼šæ˜¯å¦è¿‡å¤§ï¼ˆ>50GBï¼‰æˆ–è¿‡å°ï¼ˆ<1GBï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("æŸ¥è¯¢å»¶è¿Ÿ")]),_._v("ï¼šå¤§éƒ¨åˆ†å‘ç”Ÿåœ¨åˆ†ç‰‡å±‚é¢ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ç´¢å¼•é€Ÿç‡")]),_._v("ï¼šå†™å…¥ååæ˜¯å¦å‡è¡¡ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("æ®µåˆå¹¶ (merge) å¼€é”€")]),_._v("ï¼šå†™å…¥è¿‡å¿«æ—¶å¯èƒ½å¯¼è‡´å¤§é‡æ®µåˆå¹¶ï¼Œå½±å“æ€§èƒ½ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("4. èµ„æºç›¸å…³æŒ‡æ ‡")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("CPU ä½¿ç”¨ç‡")]),_._v("ï¼ˆæŸ¥è¯¢/å†™å…¥å¼€é”€ï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("JVM å†…å­˜ï¼ˆHeapï¼‰")]),_._v("ï¼šGC é¢‘ç‡ã€Old GC æ˜¯å¦é¢‘ç¹ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ç£ç›˜ä½¿ç”¨ç‡")]),_._v("ï¼šæ˜¯å¦è¶…è¿‡ watermarkï¼ˆ85% é»˜è®¤ï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("çº¿ç¨‹æ± ")]),_._v("ï¼šå†™å…¥/æœç´¢çº¿ç¨‹æ± æ˜¯å¦é¥±å’Œã€‚")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-å¦‚æœä¸€ä¸ªåˆ†ç‰‡ä¸¢å¤±äº†-es-æ˜¯å¦‚ä½•æ¢å¤çš„"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å¦‚æœä¸€ä¸ªåˆ†ç‰‡ä¸¢å¤±äº†-es-æ˜¯å¦‚ä½•æ¢å¤çš„"}},[_._v("#")]),_._v(" ğŸ¯ å¦‚æœä¸€ä¸ªåˆ†ç‰‡ä¸¢å¤±äº†ï¼ŒES æ˜¯å¦‚ä½•æ¢å¤çš„ï¼Ÿ")]),_._v(" "),t("p",[_._v("â€œåˆ†ç‰‡ä¸¢å¤±æ—¶ï¼Œä¸»èŠ‚ç‚¹å…ˆæŠŠè¯¥åˆ†ç‰‡æ ‡è®°ä¸ºæœªåˆ†é…ï¼Œç„¶åæŒ‰â€˜å°±è¿‘å¯ç”¨â€™æ¢å¤ï¼šå¦‚æœè¿˜æœ‰ä¸€ä»½å‰¯æœ¬åœ¨ä¸”æ˜¯ in-syncï¼Œå°±ç«‹å³æå‡ä¸ºä¸»åˆ†ç‰‡ï¼›å…¶ä½™å‰¯æœ¬é€šè¿‡â€˜å¯¹ç­‰æ¢å¤â€™ï¼ˆpeer recoveryï¼‰ä»æ–°ä¸»åˆ†ç‰‡æ‹·è´ segmentï¼Œå†æŒ‰åºå·å›æ”¾ translog è¡¥é½å¢é‡ï¼Œè¾¾åˆ°å…¨é‡ä¸€è‡´ã€‚è‹¥ä¸»å‰¯æœ¬éƒ½æ²¡äº†ï¼Œç´¢å¼•ä¼šå˜çº¢ï¼Œåªèƒ½ä»å¿«ç…§ä»“åº“åš snapshot restoreã€‚ä¸ºé™ä½æŠ–åŠ¨ï¼ŒESé»˜è®¤ä¼šå»¶è¿Ÿåˆ†é…ä¸€ä¼šå„¿ç­‰ä¸¢å¤±èŠ‚ç‚¹å›æ¥ï¼ˆindex.unassigned.node_left.delayed_timeoutï¼‰ï¼Œå¹¶å—å¹¶å‘/å¸¦å®½èŠ‚æµæ§åˆ¶ï¼ˆnode_concurrent_recoveriesã€indices.recovery.max_bytes_per_secï¼‰ã€‚è·¨å¯ç”¨åŒºè¿˜ä¼šç»“åˆåˆ†é…æ„ŸçŸ¥ï¼ˆallocation awarenessï¼‰é¿å…æŠŠå‰¯æœ¬æ”¾è¿›åŒä¸€æœºæ¶/å¯ç”¨åŒºï¼Œä»è€Œæå‡å®¹ç¾ã€‚â€")]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-å†™å…¥æ•°æ®æ—¶-es-çš„å†™å…¥æµç¨‹æ˜¯æ€æ ·çš„-primary-shardã€replica-shard-åè°ƒè¿‡ç¨‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å†™å…¥æ•°æ®æ—¶-es-çš„å†™å…¥æµç¨‹æ˜¯æ€æ ·çš„-primary-shardã€replica-shard-åè°ƒè¿‡ç¨‹"}},[_._v("#")]),_._v(" ğŸ¯ å†™å…¥æ•°æ®æ—¶ï¼ŒES çš„å†™å…¥æµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿï¼ˆPrimary Shardã€Replica Shard åè°ƒè¿‡ç¨‹ï¼‰")]),_._v(" "),t("p",[_._v("â€œå®¢æˆ·ç«¯è¯·æ±‚å…ˆåˆ°åè°ƒèŠ‚ç‚¹ï¼ŒæŒ‰ routingï¼ˆhash("),t("em",[_._v("routing) % ä¸»åˆ†ç‰‡æ•°ï¼‰è·¯ç”±åˆ°ä¸»åˆ†ç‰‡ã€‚ä¸»åˆ†ç‰‡æ‰§è¡Œå†™å…¥ï¼ˆæ ¡éªŒ/å»ºæ¨¡ã€å†™å†…å­˜ç´¢å¼•ç¼“å†²ä¸ translogï¼Œåˆ†é… seq_no/primary termï¼‰ï¼Œå†åŒæ­¥è½¬å‘ç»™æ‰€æœ‰ in-sync å‰¯æœ¬æ‰§è¡ŒåŒæ ·å†™å…¥ï¼Œå‰¯æœ¬è¿”å› ACK åæ•´ä½“æˆåŠŸè¿”å›ã€‚å†™å…¥åå¹¶ä¸ä¼šç«‹åˆ»å¯æœï¼Œç­‰ refreshï¼ˆé»˜è®¤â‰ˆ1sï¼‰æˆ–æ˜¾å¼ refresh æ‰å¯è§ï¼›flush ä¼šæŠŠ translog åˆ·ç›˜å¹¶ç”Ÿæˆ commitï¼Œmerge åå°åˆå¹¶å°æ®µã€‚â€")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-æŸ¥è¯¢æ•°æ®æ—¶-es-çš„æŸ¥è¯¢æµç¨‹æ˜¯æ€æ ·çš„-åè°ƒèŠ‚ç‚¹ã€åˆ†ç‰‡æŸ¥è¯¢ã€ç»“æœåˆå¹¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-æŸ¥è¯¢æ•°æ®æ—¶-es-çš„æŸ¥è¯¢æµç¨‹æ˜¯æ€æ ·çš„-åè°ƒèŠ‚ç‚¹ã€åˆ†ç‰‡æŸ¥è¯¢ã€ç»“æœåˆå¹¶"}},[_._v("#")]),_._v(" ğŸ¯ æŸ¥è¯¢æ•°æ®æ—¶ï¼ŒES çš„æŸ¥è¯¢æµç¨‹æ˜¯æ€æ ·çš„ï¼Ÿï¼ˆåè°ƒèŠ‚ç‚¹ã€åˆ†ç‰‡æŸ¥è¯¢ã€ç»“æœåˆå¹¶ï¼‰")]),_._v(" "),t("p",[_._v("æŸ¥è¯¢æ˜¯â€˜æ•£â€”å½’å¹¶â€”å–â€™ä¸¤é˜¶æ®µã€‚è¯·æ±‚å…ˆåˆ°åè°ƒèŠ‚ç‚¹ï¼ŒæŒ‰ç´¢å¼•ä¸è·¯ç”±æŒ‘å‡ºè¦æŸ¥çš„åˆ†ç‰‡ï¼›Query é˜¶æ®µå¹¶è¡ŒæŠŠæŸ¥è¯¢ä¸‹å‘åˆ°æ¯ä¸ªåˆ†ç‰‡ï¼ˆä¸»æˆ–ä»»ä¸€å‰¯æœ¬ï¼‰ï¼Œåˆ†ç‰‡æœ¬åœ°ç®—åˆ†/æ’åºå‡ºå±€éƒ¨ topN è¿”å›æ–‡æ¡£ID+æ’åºå€¼ï¼›åè°ƒèŠ‚ç‚¹å…¨å±€å½’å¹¶å¾—åˆ°æœ€ç»ˆ topNï¼›Fetch é˜¶æ®µå†æŒ‰è¿™äº›IDåˆ°å„åˆ†ç‰‡å– "),t("em",[_._v("source/é«˜äº®/inner hitsï¼Œæ‹¼è£…åè¿”å›ã€‚èšåˆä¼šåœ¨åˆ†ç‰‡å…ˆç®—å±€éƒ¨æ¡¶/åº¦é‡ï¼Œæœ€ååœ¨åè°ƒèŠ‚ç‚¹åš reduce æ±‡æ€»ã€‚")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-æŸ¥è¯¢ä¼˜åŒ–ä¸-filter-çš„ä½¿ç”¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-æŸ¥è¯¢ä¼˜åŒ–ä¸-filter-çš„ä½¿ç”¨"}},[_._v("#")]),_._v(" ğŸ¯ æŸ¥è¯¢ä¼˜åŒ–ä¸ filter çš„ä½¿ç”¨ï¼Ÿ")]),_._v(" "),t("ul",[t("li",[_._v("è¯æœ¯\n"),t("ul",[t("li",[_._v("å°½é‡ç”¨ bool.filterï¼ˆå¯ç¼“å­˜ä¸è®¡åˆ†ï¼‰ï¼›è£å‰ª _sourceï¼›åªå–éœ€è¦å­—æ®µï¼›é¿å…å¤§ wildcard/regexpã€‚")])])]),_._v(" "),t("li",[_._v("å…³é”®è¦ç‚¹\n"),t("ul",[t("li",[_._v("docvalue_fields/stored_fieldsï¼›pre_filter_shardï¼›åˆç†è·¯ç”±å‡å°‘ fan-outã€‚")])])]),_._v(" "),t("li",[_._v("ç¤ºä¾‹")])]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[_._v("GET idx/_search\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"_source"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"id"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"title"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"query"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"bool"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"filter"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("[")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"term"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"status"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"OK"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("]")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])]),t("ul",[t("li",[_._v("å¸¸è§è¿½é—®\n"),t("ul",[t("li",[_._v("query vs filterï¼Ÿfilter ä¸è®¡åˆ†å¯ç¼“å­˜ï¼›query è®¡åˆ†æ’åºã€‚")])])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-æ·±åˆ†é¡µæ€ä¹ˆåš-scroll-ä¸-search-after-å¦‚ä½•é€‰æ‹©"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-æ·±åˆ†é¡µæ€ä¹ˆåš-scroll-ä¸-search-after-å¦‚ä½•é€‰æ‹©"}},[_._v("#")]),_._v(" ğŸ¯ æ·±åˆ†é¡µæ€ä¹ˆåšï¼Ÿscroll ä¸ search_after å¦‚ä½•é€‰æ‹©ï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[_._v("ES é»˜è®¤åˆ†é¡µç”¨ from+sizeï¼Œä½†è¶…è¿‡ 1w æ¡ä¼šæœ‰æ·±åˆ†é¡µé—®é¢˜ï¼Œæ€§èƒ½å¼€é”€å¾ˆå¤§ã€‚\nå¦‚æœæ˜¯ "),t("strong",[_._v("å…¨é‡éå†å¯¼å‡ºæ•°æ®")]),_._v("ï¼Œé€‚åˆç”¨ "),t("strong",[_._v("scroll API")]),_._v("ï¼Œå®ƒä¼šåŸºäºä¸€ä¸ªå¿«ç…§æ»šåŠ¨æŸ¥è¯¢ã€‚\nå¦‚æœæ˜¯ "),t("strong",[_._v("åœ¨çº¿ä¸šåŠ¡åœºæ™¯éœ€è¦å®æ—¶ç¿»é¡µ")]),_._v("ï¼Œæ¨èç”¨ "),t("strong",[_._v("search_after")]),_._v("ï¼Œé€šè¿‡ä¸Šä¸€é¡µçš„æ’åºå€¼å–ä¸‹ä¸€é¡µï¼Œæ€§èƒ½æ›´å¥½ã€‚\nä¸¤è€…é€‰æ‹©æ—¶è¦çœ‹ä¸šåŠ¡åœºæ™¯ï¼š"),t("strong",[_._v("ç¦»çº¿å¯¼å‡ºç”¨ scrollï¼Œå®æ—¶åˆ†é¡µç”¨ search_after")]),_._v("ã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("ä¸€ã€ä¸ºä»€ä¹ˆä¼šæœ‰æ·±åˆ†é¡µé—®é¢˜ï¼Ÿ")])]),_._v(" "),t("ul",[t("li",[t("p",[_._v("ES é»˜è®¤åˆ†é¡µç”¨ "),t("code",[_._v("from + size")]),_._v("ï¼Œæ¯”å¦‚ï¼š")]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v('GET /products/_search\n{\n  "from": 10000,\n  "size": 10,\n  "query": { "match_all": {} }\n}\n')])])])]),_._v(" "),t("li",[t("p",[_._v("é—®é¢˜ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("ES ä¼šæŠŠ "),t("code",[_._v("from + size")]),_._v(" èŒƒå›´å†…çš„æ‰€æœ‰ç»“æœå–å‡ºï¼Œå†ä¸¢æ‰å‰ "),t("code",[_._v("from")]),_._v(" æ¡ã€‚")]),_._v(" "),t("li",[_._v("å¦‚æœ "),t("code",[_._v("from")]),_._v(" å¾ˆå¤§ï¼ˆæ¯”å¦‚ 100wï¼‰ï¼Œå°±ä¼šæ¶ˆè€—å¤§é‡ CPUã€å†…å­˜ï¼Œä¸¥é‡å½±å“æ€§èƒ½ã€‚")])])]),_._v(" "),t("li",[t("p",[_._v("ES é»˜è®¤é™åˆ¶ï¼š"),t("code",[_._v("index.max_result_window = 10000")]),_._v("ï¼Œè¶…è¿‡å°±æŠ¥é”™ã€‚")])])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("äºŒã€è§£å†³æ–¹æ¡ˆ")])]),_._v(" "),t("p",[t("strong",[_._v("1. Scroll API")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("åŸç†")]),_._v("ï¼šä¿æŒä¸€ä¸ªå¿«ç…§ï¼ˆsnapshotï¼‰ï¼Œæ¸¸æ ‡å¼æ»šåŠ¨æŸ¥è¯¢ï¼Œé€‚åˆ "),t("strong",[_._v("å…¨é‡éå†")]),_._v("ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ç‰¹ç‚¹")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("å¿«ç…§å›ºå®šï¼Œæ•°æ®ä¸ä¼šå› æ–°å¢/åˆ é™¤è€Œå˜åŒ–ã€‚")]),_._v(" "),t("li",[_._v("æ¯æ¬¡è¿”å›ä¸€æ‰¹ï¼Œæ¸¸æ ‡å¾€åç§»åŠ¨ã€‚")]),_._v(" "),t("li",[_._v("å¸¸ç”¨äº "),t("strong",[_._v("æ•°æ®å¯¼å‡º")]),_._v("ã€"),t("strong",[_._v("æ‰¹é‡å¤„ç†")]),_._v("ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("ç¼ºç‚¹")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("ä¸é€‚åˆå®æ—¶åœºæ™¯ï¼ˆæ•°æ®æ›´æ–°ä¸ä¼šä½“ç°åœ¨å¿«ç…§ä¸­ï¼‰ã€‚")]),_._v(" "),t("li",[_._v("å ç”¨å†…å­˜èµ„æºï¼Œéœ€è¦åŠæ—¶æ¸…ç† scroll ä¸Šä¸‹æ–‡ã€‚")])])])]),_._v(" "),t("p",[t("strong",[_._v("ä¾‹å­")]),_._v("ï¼š")]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v('# åˆå§‹åŒ– scroll\nGET /products/_search?scroll=1m\n{\n  "size": 1000,\n  "query": { "match_all": {} }\n}\n\n# åç»­ä½¿ç”¨ _scroll_id æ‹‰å–ä¸‹ä¸€æ‰¹\nGET /_search/scroll\n{\n  "scroll": "1m",\n  "scroll_id": "DnF1ZXJ5VGhlbkZldGNoBQAAAAAAAa=="\n}\n')])])]),t("hr"),_._v(" "),t("p",[t("strong",[_._v("2. search_after")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("åŸç†")]),_._v("ï¼šåŸºäºä¸Šä¸€é¡µçš„â€œæ’åºå€¼â€æ¥å–ä¸‹ä¸€é¡µã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ç‰¹ç‚¹")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("ä¸éœ€è¦ç»´æŠ¤å¿«ç…§ï¼Œæ€§èƒ½æ¯” scroll æ›´è½»é‡ã€‚")]),_._v(" "),t("li",[_._v("é€‚åˆ "),t("strong",[_._v("å®æ—¶åˆ†é¡µæŸ¥è¯¢")]),_._v("ï¼Œæ¯”å¦‚ç”µå•†å•†å“ç¿»é¡µã€‚")]),_._v(" "),t("li",[_._v("å¿…é¡»æœ‰ "),t("strong",[_._v("å”¯ä¸€çš„æ’åºå­—æ®µ")]),_._v("ï¼ˆé€šå¸¸ç”¨æ—¶é—´æˆ³ + _id ä½œä¸º tie-breakerï¼‰ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("ç¼ºç‚¹")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("åªèƒ½å¾€åç¿»é¡µï¼Œä¸èƒ½ç›´æ¥è·³åˆ°ç¬¬ N é¡µã€‚")])])])]),_._v(" "),t("p",[t("strong",[_._v("ä¾‹å­")]),_._v("ï¼š")]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v('GET /products/_search\n{\n  "size": 10,\n  "query": { "match_all": {} },\n  "sort": [\n    { "price": "asc" },\n    { "_id": "asc" }\n  ],\n  "search_after": [100, "doc123"] \n}\n')])])]),t("p",[_._v("è¿™é‡Œ "),t("code",[_._v('100, "doc123"')]),_._v(" å°±æ˜¯ä¸Šä¸€é¡µæœ€åä¸€æ¡æ–‡æ¡£çš„æ’åºå€¼ã€‚")]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("ä¸‰ã€å¦‚ä½•é€‰æ‹©ï¼Ÿ")])]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("æ–¹å¼")]),_._v(" "),t("th",[_._v("é€‚ç”¨åœºæ™¯")]),_._v(" "),t("th",[_._v("ä¼˜ç‚¹")]),_._v(" "),t("th",[_._v("ç¼ºç‚¹")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("from+size")]),_._v(" "),t("td",[_._v("å°æ•°æ®åˆ†é¡µï¼ˆ<1w æ¡ï¼‰")]),_._v(" "),t("td",[_._v("ç®€å•")]),_._v(" "),t("td",[_._v("æ·±åˆ†é¡µæ€§èƒ½å·®")])]),_._v(" "),t("tr",[t("td",[_._v("scroll")]),_._v(" "),t("td",[_._v("å¤§è§„æ¨¡å¯¼å‡ºã€æ‰¹å¤„ç†")]),_._v(" "),t("td",[_._v("èƒ½éå†å…¨é‡æ•°æ®")]),_._v(" "),t("td",[_._v("ä¸å®æ—¶ï¼Œå ç”¨å†…å­˜")])]),_._v(" "),t("tr",[t("td",[_._v("search_after")]),_._v(" "),t("td",[_._v("å®æ—¶ä¸šåŠ¡åˆ†é¡µ")]),_._v(" "),t("td",[_._v("é«˜æ•ˆã€è½»é‡")]),_._v(" "),t("td",[_._v("åªèƒ½å¾€åç¿»ï¼Œä¸èƒ½éšæœºè·³é¡µ")])])])]),_._v(" "),t("hr"),_._v(" "),t("h2",{attrs:{id:"âš¡-å››ã€æ€§èƒ½ä¼˜åŒ–ç±»-é«˜é¢‘é‡ç‚¹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#âš¡-å››ã€æ€§èƒ½ä¼˜åŒ–ç±»-é«˜é¢‘é‡ç‚¹"}},[_._v("#")]),_._v(" âš¡ å››ã€æ€§èƒ½ä¼˜åŒ–ç±»ï¼ˆé«˜é¢‘é‡ç‚¹ï¼‰")]),_._v(" "),t("blockquote",[t("p",[t("strong",[_._v("æ ¸å¿ƒæ€æƒ³")]),_._v("ï¼šæ€§èƒ½ä¼˜åŒ–æ˜¯ESé¢è¯•çš„é‡ä¸­ä¹‹é‡ï¼Œæ¶µç›–å†™å…¥ä¼˜åŒ–ã€æŸ¥è¯¢ä¼˜åŒ–ã€æ·±åˆ†é¡µã€ç¼“å­˜ç­–ç•¥ç­‰å¤šä¸ªæ–¹é¢ï¼Œä½“ç°çœŸå®ç”Ÿäº§ç¯å¢ƒçš„æŠ€æœ¯æ°´å¹³ã€‚")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("å†™å…¥ä¼˜åŒ–")]),_._v("ï¼š"),t("a",{attrs:{href:"#es-%E5%86%99%E5%85%A5%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%9C%89%E5%93%AA%E4%BA%9B%E6%96%B9%E5%BC%8F"}},[_._v("å†™å…¥æ€§èƒ½ä¼˜åŒ–")]),_._v(" | "),t("a",{attrs:{href:"#%E5%86%99%E5%85%A5%E4%B8%BA%E4%BD%95%E8%BF%91%E5%AE%9E%E6%97%B6%E5%A6%82%E4%BD%95%E6%8F%90%E5%90%9E%E5%90%90"}},[_._v("æ‰¹é‡æ“ä½œä¼˜åŒ–")])]),_._v(" "),t("li",[t("strong",[_._v("æŸ¥è¯¢ä¼˜åŒ–")]),_._v("ï¼š"),t("a",{attrs:{href:"#es-%E6%9F%A5%E8%AF%A2%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96%E6%9C%89%E5%93%AA%E4%BA%9B%E6%96%B9%E5%BC%8F"}},[_._v("æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–")]),_._v(" | "),t("a",{attrs:{href:"#%E6%80%8E%E4%B9%88%E4%BC%98%E5%8C%96-elasticsearch-%E7%9A%84%E6%9F%A5%E8%AF%A2%E6%80%A7%E8%83%BD"}},[_._v("æ·±åˆ†é¡µä¼˜åŒ–")])]),_._v(" "),t("li",[t("strong",[_._v("ç´¢å¼•è®¾è®¡")]),_._v("ï¼š"),t("a",{attrs:{href:"#es-%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E7%B4%A2%E5%BC%95%E6%9D%A5%E5%AD%98%E5%82%A8%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE"}},[_._v("æ—¥å¿—æ•°æ®è®¾è®¡")]),_._v(" | "),t("a",{attrs:{href:"#%E7%B4%A2%E5%BC%95%E6%95%B0%E9%87%8F%E8%BF%87%E5%A4%9A%E4%BC%9A%E6%9C%89%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98"}},[_._v("ç´¢å¼•æ•°é‡é—®é¢˜")]),_._v(" | "),t("a",{attrs:{href:"#%E5%A4%A7%E9%87%8F%E5%B0%8F%E6%96%87%E6%A1%A3-vs-%E5%B0%91%E9%87%8F%E5%A4%A7%E6%96%87%E6%A1%A3%E5%AF%B9%E6%80%A7%E8%83%BD%E6%9C%89%E4%BD%95%E5%BD%B1%E5%93%8D"}},[_._v("æ–‡æ¡£å¤§å°å½±å“")])]),_._v(" "),t("li",[t("strong",[_._v("æ ¸å¿ƒæœºåˆ¶")]),_._v("ï¼š"),t("a",{attrs:{href:"#refreshflushmerge-%E7%9A%84%E5%8C%BA%E5%88%AB%E5%AE%83%E4%BB%AC%E5%90%84%E8%87%AA%E8%A7%A3%E5%86%B3%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98"}},[_._v("refresh/flush/merge")]),_._v(" | "),t("a",{attrs:{href:"#es-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%98%AF%E8%BF%91%E5%AE%9E%E6%97%B6nrt%E6%90%9C%E7%B4%A2"}},[_._v("è¿‘å®æ—¶åŸç†")]),_._v(" | "),t("a",{attrs:{href:"#elasticsearch%E5%9C%A8%E9%83%A8%E7%BD%B2%E6%97%B6%E5%AF%B9linux%E7%9A%84%E8%AE%BE%E7%BD%AE%E6%9C%89%E5%93%AA%E4%BA%9B%E4%BC%98%E5%8C%96%E6%96%B9%E6%B3%95"}},[_._v("éƒ¨ç½²ä¼˜åŒ–")])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-es-å†™å…¥æ€§èƒ½ä¼˜åŒ–æœ‰å“ªäº›æ–¹å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-å†™å…¥æ€§èƒ½ä¼˜åŒ–æœ‰å“ªäº›æ–¹å¼"}},[_._v("#")]),_._v(" ğŸ¯ ES å†™å…¥æ€§èƒ½ä¼˜åŒ–æœ‰å“ªäº›æ–¹å¼ï¼Ÿ")]),_._v(" "),t("p",[_._v("â€œå†™å…¥æƒ³å¿«ï¼Œå…ˆåšå¯¹å»ºæ¨¡ï¼Œå†ç”¨æ‰¹é‡ã€è°ƒâ€˜åˆ·æ–°/å‰¯æœ¬/åˆå¹¶â€™ï¼Œæ§åˆ¶åˆ†ç‰‡ä¸è·¯ç”±ï¼Œé¿å…æ˜‚è´µçš„è„šæœ¬/ç®¡é“ã€‚å¯¼å…¥æœŸå…³åˆ·æ–°å’Œå‰¯æœ¬ã€èµ°Bulkå¤§æ‰¹æ¬¡å¹¶è¡Œï¼›å¯¼å…¥åæ¢å¤æ­£å¸¸å¹¶ç”¨ILMåšæ»šåŠ¨ä¸å†·çƒ­åˆ†å±‚ï¼Œç›‘æ§æ‹’ç»ä¸åˆå¹¶å°±åŸºæœ¬ç¨³äº†ã€‚â€")]),_._v(" "),t("p",[t("strong",[_._v("å¯è½åœ°æ¸…å•ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰")])]),_._v(" "),t("ul",[t("li",[t("p",[_._v("å»ºæ¨¡ä¼˜åŒ–")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("å­—æ®µç±»å‹ç²¾å‡†ï¼šå…¨æ–‡æ£€ç´¢ç”¨ textï¼Œç²¾ç¡®/èšåˆç”¨ keywordï¼ˆå¿…è¦æ—¶ multi-fieldsï¼‰ã€‚")])]),_._v(" "),t("li",[t("p",[_._v("å…³é—­ä¸å¿…è¦ç‰¹æ€§ï¼šå¯¹ keyword å…³é—­ normsï¼›è£å‰ª "),t("em",[_._v("sourceï¼ˆåªä¿ç•™å¿…è¦å­—æ®µï¼‰ï¼›é¿å… dynamic=true å¯¼è‡´å­—æ®µçˆ†ç‚¸ã€‚")])])]),_._v(" "),t("li",[t("p",[_._v("é«˜åŸºæ•°ID/æ ‡ç­¾ç›´æ¥ keywordï¼›åµŒå¥—è°¨æ…ï¼ˆnested å†™æˆæœ¬é«˜ï¼‰ã€‚")])])])]),_._v(" "),t("li",[t("p",[_._v("æ‰¹é‡å†™å…¥")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("Bulk å•æ‰¹ 5â€“15MBã€å¹¶å‘ 2â€“4 é€šé“ï¼ˆBulkProcessorï¼‰ï¼›å¤±è´¥æŒ‡æ•°é€€é¿é‡è¯•ã€‚")])]),_._v(" "),t("li",[t("p",[_._v("å®¢æˆ·ç«¯åšé¢„å¤„ç†/æ ¡éªŒï¼Œå°‘ç”¨ ingest pipeline è„šæœ¬ï¼ˆpainlessï¼‰åšå¤æ‚é€»è¾‘ã€‚")])])])]),_._v(" "),t("li",[t("p",[_._v("åˆ·æ–°/å‰¯æœ¬/Translogï¼ˆå¯¼å…¥æœŸä¸åœ¨çº¿æœŸåˆ†æ²»ï¼‰")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("å¯¼å…¥æœŸï¼šindex.refresh_interval=-1ã€index.number_of_replicas=0ã€å¤§ Bulkï¼›å¯¼å…¥å®Œæ¢å¤å¦‚ 1s å’Œ >=1 å‰¯æœ¬ã€‚")])]),_._v(" "),t("li",[t("p",[_._v("Translogï¼šé»˜è®¤ request æœ€ç¨³ï¼›è‹¥è¿½æ±‚ååå¯è¯„ä¼° index.translog.durability=asyncï¼ˆæœ‰ä¸¢å¤±é£é™©ï¼‰ã€‚")])]),_._v(" "),t("li",[t("p",[_._v("wait_for_active_shards è®¾é»˜è®¤/è¾ƒä½ï¼Œé¿å…å†™é˜»å¡ã€‚")])])])]),_._v(" "),t("li",[t("p",[_._v("åˆå¹¶ä¸æ®µï¼ˆSegmentsï¼‰")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("è®©åˆå¹¶åœ¨åå°è‡ªç„¶è¿›è¡Œï¼›ä»…å¯¹åªè¯»å†·ç´¢å¼•å†è€ƒè™‘ forcemergeï¼ˆå°å¿ƒè€—æ—¶/IOï¼‰ã€‚")])]),_._v(" "),t("li",[t("p",[_._v("å…³æ³¨ index.merge.policy.* ä¸åˆå¹¶é€Ÿç‡ï¼Œé¿å…å°æ®µè¿‡å¤šã€‚")])])])]),_._v(" "),t("li",[t("p",[_._v("åˆ†ç‰‡ä¸è·¯ç”±")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("åˆ†ç‰‡æ•°åˆç†ï¼šå•åˆ†ç‰‡ 10â€“50GB å‚è€ƒï¼›è¿‡å¤šåˆ†ç‰‡ä¼šæ‹–æ…¢å†™å…¥ä¸åˆå¹¶ã€‚")])]),_._v(" "),t("li",[t("p",[_._v("å¤šç§Ÿæˆ·/å¤§ä¸šåŠ¡ç”¨ _routing é™ä½ fan-outï¼›å¤§ä½“é‡ç”¨ rollover + åˆ«ååˆ‡æµã€‚")])])])]),_._v(" "),t("li",[t("p",[_._v("èµ„æºä¸çº¿ç¨‹")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("SSD/NVMeï¼›å † â‰¤ 32GBï¼ˆç•™ Page Cacheï¼‰ï¼›indices.memory.index_buffer_size é€‚å½“å¢å¤§ï¼ˆå¦‚ 10%â€“20%ï¼‰ã€‚")])]),_._v(" "),t("li",[t("p",[_._v("å…³æ³¨ threadpool.write/bulk é˜Ÿåˆ—ä¸æ‹’ç»ï¼ˆrejectedï¼‰ï¼›indices.recovery.max_bytes_per_sec ä¸è¦å¤ªä½ã€‚")])])])]),_._v(" "),t("li",[t("p",[_._v("å‹ç¼©ä¸ç¼–è§£ç ")]),_._v(" "),t("ul",[t("li",[_._v("å†™å¯†é›†ç´¢å¼•ä¿æŒé»˜è®¤ codecï¼›åªè¯»å†·ç´¢å¼•å¯ç”¨ index.codec=best_compression é™å­˜å‚¨ã€‚")])])]),_._v(" "),t("li",[t("p",[_._v("OS/éƒ¨ç½²")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("å…³é—­ swapã€vm.max_map_count è¶³å¤Ÿã€XFS/EXT4ï¼Œç£ç›˜ä¸ç½‘å¡ä¸ä¸­æ–­é™é€Ÿã€‚")])]),_._v(" "),t("li",[t("p",[_._v("çƒ­æ¸©å†·èŠ‚ç‚¹ï¼ˆILMï¼‰+ å¿«ç…§åˆ°å¯¹è±¡å­˜å‚¨ï¼Œé™ä½çƒ­åŒºå‹åŠ›ã€‚")])])])]),_._v(" "),t("li",[t("p",[_._v("ç›‘æ§ä¸å‹æµ‹")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("ç›¯ï¼šbulk åå/å»¶è¿Ÿã€threadpool rejectionsã€segments/mergesã€GCã€refresh æ—¶é—´ã€indexing_pressureã€‚")])]),_._v(" "),t("li",[t("p",[_._v("é¢„ä¼°å†™å…¥å³°å€¼ï¼Œå‹æµ‹åå®šæ‰¹é‡ä¸å¹¶å‘ã€‚")])])])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-es-æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–æœ‰å“ªäº›æ–¹å¼"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–æœ‰å“ªäº›æ–¹å¼"}},[_._v("#")]),_._v(" ğŸ¯ ES æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–æœ‰å“ªäº›æ–¹å¼ï¼Ÿ")]),_._v(" "),t("p",[_._v('"æŸ¥è¯¢æƒ³å¿«ï¼Œå…ˆçœ‹ç´¢å¼•ç»“æ„åˆç†ä¸åˆç†ï¼Œå†ä¼˜åŒ–æŸ¥è¯¢è¯­å¥æœ¬èº«ã€‚ç´¢å¼•å±‚é¢åšå¥½mappingã€åˆ†ç‰‡æ•°ã€è·¯ç”±ï¼›æŸ¥è¯¢å±‚é¢ç”¨filterä»£æ›¿queryã€æ§åˆ¶è¿”å›å­—æ®µã€åˆ†é¡µç”¨search_afterã€‚é«˜å¹¶å‘åœºæ™¯å¼€ç¼“å­˜ã€ç”¨èšåˆpre-è®¡ç®—ï¼Œé¿å…æ·±åº¦åˆ†é¡µå’Œå¤æ‚è„šæœ¬ï¼Œç›‘æ§æ…¢æŸ¥è¯¢å°±åŸºæœ¬å¤Ÿç”¨äº†ã€‚"')]),_._v(" "),t("p",[t("strong",[_._v("å¯è½åœ°æ¸…å•ï¼ˆæŒ‰ä¼˜å…ˆçº§ï¼‰")])]),_._v(" "),t("p",[t("strong",[_._v("ç´¢å¼•è®¾è®¡ä¼˜åŒ–")])]),_._v(" "),t("ul",[t("li",[t("p",[_._v("Mappingä¼˜åŒ–")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("å­—æ®µç±»å‹ç²¾å‡†ï¼šå…¨æ–‡ç”¨text+keyword multi-fieldsï¼Œç²¾ç¡®æŸ¥æ‰¾åªç”¨keyword")])]),_._v(" "),t("li",[t("p",[_._v("é«˜åŸºæ•°å­—æ®µé¿å…èšåˆï¼Œç”¨doc_values=falseèŠ‚çœç©ºé—´")])]),_._v(" "),t("li",[t("p",[_._v("ä¸éœ€è¦è¯„åˆ†çš„ç”¨keywordï¼Œå…³é—­normsï¼ˆkeywordé»˜è®¤å·²å…³é—­ï¼‰")])])])]),_._v(" "),t("li",[t("p",[_._v("åˆ†ç‰‡è®¾è®¡")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("å•åˆ†ç‰‡10-50GBï¼Œè¿‡å¤šåˆ†ç‰‡å¢åŠ åè°ƒå¼€é”€")])]),_._v(" "),t("li",[t("p",[_._v("ç”¨_routingå‡å°‘æŸ¥è¯¢fan-outï¼Œæå‡å‘½ä¸­ç‡")])])])]),_._v(" "),t("li",[t("p",[_._v("ç´¢å¼•ç»“æ„")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("æ—¶é—´åºåˆ—æ•°æ®ç”¨ILM rolloverï¼ŒæŸ¥è¯¢åªå‘½ä¸­å¿…è¦æ—¶é—´æ®µ")])]),_._v(" "),t("li",[t("p",[_._v("å†·çƒ­åˆ†ç¦»ï¼šå†å²æ•°æ®æ”¾warm/coldèŠ‚ç‚¹")])])])])]),_._v(" "),t("p",[t("strong",[_._v("æŸ¥è¯¢è¯­å¥ä¼˜åŒ–")])]),_._v(" "),t("ul",[t("li",[t("p",[_._v("Filter vs Query")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("ç²¾ç¡®åŒ¹é…ç”¨filterï¼ˆæœ‰ç¼“å­˜ã€æ— è¯„åˆ†ï¼‰ï¼štermã€rangeã€bool-filter")])]),_._v(" "),t("li",[t("p",[_._v("å…¨æ–‡æ£€ç´¢æ‰ç”¨queryï¼šmatchã€multi_match")]),_._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"bool"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"filter"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"term"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"status"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"active"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v("*")]),t("span",{pre:!0,attrs:{class:"token comment"}},[_._v("// ç”¨filter*")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"must"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"match"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"title"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"elasticsearch"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("]")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v("*")]),t("span",{pre:!0,attrs:{class:"token comment"}},[_._v("// éœ€è¦è¯„åˆ†ç”¨must*")]),_._v("\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])])])])]),_._v(" "),t("li",[t("p",[_._v("è¿”å›å­—æ®µæ§åˆ¶")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("ç”¨_source_includes/"),t("em",[_._v("source_excludesåªè¿”å›éœ€è¦å­—æ®µ")])])]),_._v(" "),t("li",[t("p",[_._v("å¤§æ–‡æ¡£åœºæ™¯ç”¨stored_fieldsæ›¿ä»£_source")])]),_._v(" "),t("li",[t("p",[_._v("ç»Ÿè®¡æŸ¥è¯¢ç”¨size=0ï¼Œä¸è¿”å›hits")])])])])]),_._v(" "),t("p",[t("strong",[_._v("åˆ†é¡µä¼˜åŒ–")])]),_._v(" "),t("ul",[t("li",[t("p",[_._v("é¿å…æ·±åº¦åˆ†é¡µ")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("from+sizeæœ€å¤š10000æ¡ï¼ˆindex.max_result_windowï¼‰")])]),_._v(" "),t("li",[t("p",[_._v("å¤§æ•°æ®é‡ç”¨search_after+sortï¼ˆæ¨èï¼‰")])]),_._v(" "),t("li",[t("p",[_._v("å†å²æ•°æ®éå†ç”¨scrollï¼ˆ7.xåæ¨èsearch_afterï¼‰")])])])])]),_._v(" "),t("p",[t("strong",[_._v("èšåˆæ€§èƒ½ä¼˜åŒ–")])]),_._v(" "),t("ul",[t("li",[t("p",[_._v("åˆç†ä½¿ç”¨èšåˆ")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("é«˜åŸºæ•°èšåˆç”¨compositeï¼Œé¿å…termsé»˜è®¤size=10çš„é™åˆ¶")])]),_._v(" "),t("li",[t("p",[_._v("å¤šå±‚èšåˆæ§åˆ¶æ·±åº¦ï¼Œå…ˆfilterå†èšåˆ")])]),_._v(" "),t("li",[t("p",[_._v("æ•°å€¼èšåˆä¼˜äºå­—ç¬¦ä¸²èšåˆ")])])])])]),_._v(" "),t("p",[t("strong",[_._v("ç¼“å­˜ç­–ç•¥")])]),_._v(" "),t("ul",[t("li",[t("p",[_._v("æŸ¥è¯¢ç¼“å­˜")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("filteræŸ¥è¯¢è‡ªåŠ¨ç¼“å­˜ï¼Œé‡å¤æŸ¥è¯¢å‘½ä¸­ç¼“å­˜")])]),_._v(" "),t("li",[t("p",[_._v("æ§åˆ¶indices.queries.cache.sizeï¼ˆé»˜è®¤10%å †å†…å­˜ï¼‰")])])])]),_._v(" "),t("li",[t("p",[_._v("è¯·æ±‚ç¼“å­˜")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("å®Œå…¨ç›¸åŒè¯·æ±‚ç”¨request cacheï¼Œé€‚åˆdashboardåœºæ™¯")])]),_._v(" "),t("li",[t("p",[_._v("size=0çš„èšåˆæŸ¥è¯¢å®¹æ˜“å‘½ä¸­ç¼“å­˜")])])])])]),_._v(" "),t("p",[t("strong",[_._v("é«˜çº§ä¼˜åŒ–")])]),_._v(" "),t("ul",[t("li",[t("p",[_._v("Routingä½¿ç”¨")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("å¤šç§Ÿæˆ·åœºæ™¯ç”¨_routingï¼Œé¿å…æŸ¥è¯¢æ‰€æœ‰åˆ†ç‰‡")])]),_._v(" "),t("li",[t("p",[_._v("å¤§å®¢æˆ·æ•°æ®ç‹¬ç«‹routing key")])])])]),_._v(" "),t("li",[t("p",[_._v("å­—æ®µä¼˜åŒ–")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("ä¸éœ€è¦çš„å­—æ®µè®¾enabled=false")])]),_._v(" "),t("li",[t("p",[_._v("æ•°ç»„/å¯¹è±¡å­—æ®µè°¨æ…ä½¿ç”¨nestedï¼ˆæŸ¥è¯¢æˆæœ¬é«˜ï¼‰")])])])]),_._v(" "),t("li",[t("p",[_._v("è„šæœ¬ä¼˜åŒ–")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("é¿å…script_scoreåœ¨å¤§æ•°æ®é›†ä¸Šä½¿ç”¨")])]),_._v(" "),t("li",[t("p",[_._v("ç”¨painlessé¢„ç¼–è¯‘ï¼Œé¿å…è¿è¡Œæ—¶ç¼–è¯‘")])])])])]),_._v(" "),t("p",[t("strong",[_._v("ç³»ç»Ÿå±‚é¢ä¼˜åŒ–")])]),_._v(" "),t("ul",[t("li",[t("p",[_._v("ç¡¬ä»¶é…ç½®")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("SSDå­˜å‚¨ï¼Œå……è¶³å†…å­˜åšPage Cache")])]),_._v(" "),t("li",[t("p",[_._v("å †å†…å­˜â‰¤32GBï¼Œå‰©ä½™ç»™ç³»ç»Ÿç¼“å­˜")])])])]),_._v(" "),t("li",[t("p",[_._v("JVMè°ƒä¼˜")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("G1GCé€‚åˆå¤§å †ï¼Œå…³æ³¨GCé¢‘ç‡")])]),_._v(" "),t("li",[t("p",[_._v("é¿å…å†…å­˜äº¤æ¢ï¼ˆswappiness=1ï¼‰")])])])])]),_._v(" "),t("p",[t("strong",[_._v("ä¸€å¥è¯ç­–ç•¥")])]),_._v(" "),t("ul",[t("li",[t("p",[_._v("æŸ¥è¯¢å‰ï¼šç´¢å¼•ç»“æ„åˆç†ã€mappingä¼˜åŒ–ã€åˆ†ç‰‡é€‚é‡")])]),_._v(" "),t("li",[t("p",[_._v("æŸ¥è¯¢ä¸­ï¼šfilteræ›¿ä»£queryã€æ§åˆ¶è¿”å›ã€search_afteråˆ†é¡µ")])]),_._v(" "),t("li",[t("p",[_._v("æŸ¥è¯¢åï¼šç›‘æ§æ…¢æŸ¥è¯¢ã€profileåˆ†æã€ç¼“å­˜å‘½ä¸­ç‡")])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-es-å¦‚ä½•è®¾è®¡ç´¢å¼•æ¥å­˜å‚¨æ—¥å¿—æ•°æ®"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-å¦‚ä½•è®¾è®¡ç´¢å¼•æ¥å­˜å‚¨æ—¥å¿—æ•°æ®"}},[_._v("#")]),_._v(" ğŸ¯ ES å¦‚ä½•è®¾è®¡ç´¢å¼•æ¥å­˜å‚¨"),t("strong",[_._v("æ—¥å¿—æ•°æ®")]),_._v("ï¼Ÿ")]),_._v(" "),t("p",[_._v("æ—¥å¿—æ•°æ®å…¸å‹çš„æ—¶é—´åºåˆ—+å¤§æ‰¹é‡å†™å…¥ï¼Œæ ¸å¿ƒæ˜¯æŒ‰æ—¶é—´æ»šåŠ¨ç´¢å¼•ã€å†·çƒ­åˆ†ç¦»ã€‚ç”¨ILMè‡ªåŠ¨rolloverï¼ˆæŒ‰å¤§å°/æ—¶é—´ï¼‰ï¼Œmappingè®¾è®¡timestamp+level+messageç»“æ„ï¼Œå†™å…¥æœŸå…³åˆ·æ–°æå‡ååï¼ŒæŸ¥è¯¢æœŸç”¨ç´¢å¼•æ¨¡æ¿åŒ¹é…æ—¶é—´èŒƒå›´ã€‚å†·æ•°æ®å‹ç¼©+è¿ç§»åˆ°warm/coldèŠ‚ç‚¹ï¼Œæœ€è€æ•°æ®åˆ é™¤æˆ–å¿«ç…§åˆ°å¯¹è±¡å­˜å‚¨ã€‚")]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-ç´¢å¼•æ•°é‡è¿‡å¤šä¼šæœ‰ä»€ä¹ˆé—®é¢˜"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-ç´¢å¼•æ•°é‡è¿‡å¤šä¼šæœ‰ä»€ä¹ˆé—®é¢˜"}},[_._v("#")]),_._v(" ğŸ¯ ç´¢å¼•æ•°é‡è¿‡å¤šä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ")]),_._v(" "),t("p",[_._v("\"ç´¢å¼•æ•°é‡è¿‡å¤šä¸»è¦ä¸‰ä¸ªé—®é¢˜ï¼šé›†ç¾¤å…ƒæ•°æ®çˆ†ç‚¸æ‹–æ…¢MasterèŠ‚ç‚¹ï¼Œæ¯ä¸ªç´¢å¼•çš„åˆ†ç‰‡å¢åŠ åè°ƒå¼€é”€ï¼Œå¤§é‡å°ç´¢å¼•æµªè´¹èµ„æºä¸”æŸ¥è¯¢ä½æ•ˆã€‚è§£å†³æ–¹æ¡ˆæ˜¯åˆå¹¶ç›¸å…³ç´¢å¼•ã€ç”¨åˆ«å+è·¯ç”±ã€ILMè‡ªåŠ¨rolloveræ§åˆ¶æ•°é‡ï¼Œæ ¸å¿ƒåŸåˆ™æ˜¯'å®è¦å‡ ä¸ªå¤§ç´¢å¼•ï¼Œä¸è¦æˆåƒä¸Šä¸‡å°ç´¢å¼•'ã€‚â€")]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-å¤§é‡å°æ–‡æ¡£-vs-å°‘é‡å¤§æ–‡æ¡£-å¯¹æ€§èƒ½æœ‰ä½•å½±å“"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å¤§é‡å°æ–‡æ¡£-vs-å°‘é‡å¤§æ–‡æ¡£-å¯¹æ€§èƒ½æœ‰ä½•å½±å“"}},[_._v("#")]),_._v(" ğŸ¯ å¤§é‡å°æ–‡æ¡£ vs. å°‘é‡å¤§æ–‡æ¡£ï¼Œå¯¹æ€§èƒ½æœ‰ä½•å½±å“ï¼Ÿ")]),_._v(" "),t("p",[_._v("å¤§é‡å°æ–‡æ¡£ä¼šå¢åŠ ç´¢å¼•å¼€é”€å’Œmergeå‹åŠ›ï¼Œä½†æŸ¥è¯¢ç²¾å‡†ï¼›å°‘é‡å¤§æ–‡æ¡£å‡å°‘ç´¢å¼•å¼€é”€ä½†å†…å­˜å ç”¨å¤§ã€ç½‘ç»œä¼ è¾“æ…¢ã€‚é€‰æ‹©ç­–ç•¥çœ‹åœºæ™¯ï¼šé«˜é¢‘ç²¾ç¡®æŸ¥è¯¢ç”¨å°æ–‡æ¡£+åˆç†æ‰¹é‡å†™å…¥ï¼Œå¤§æ‰¹é‡åˆ†æç”¨å¤§æ–‡æ¡£+"),t("em",[_._v("sourceè£å‰ªã€‚æ ¸å¿ƒæ˜¯å¹³è¡¡ç´¢å¼•æ•ˆç‡å’ŒæŸ¥è¯¢éœ€æ±‚ï¼Œä¸€èˆ¬å•æ–‡æ¡£1KB-1MBæ¯”è¾ƒåˆé€‚ã€‚")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-refreshã€flushã€merge-çš„åŒºåˆ«-å®ƒä»¬å„è‡ªè§£å†³ä»€ä¹ˆé—®é¢˜"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-refreshã€flushã€merge-çš„åŒºåˆ«-å®ƒä»¬å„è‡ªè§£å†³ä»€ä¹ˆé—®é¢˜"}},[_._v("#")]),_._v(" ğŸ¯ refreshã€flushã€merge çš„åŒºåˆ«ï¼Ÿå®ƒä»¬å„è‡ªè§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[_._v('"refreshè®©æ–°å†™å…¥æ•°æ®å¯æœç´¢ï¼Œflushç¡®ä¿æ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œmergeåˆå¹¶å°segmentæå‡æŸ¥è¯¢æ•ˆç‡ã€‚refreshæ§åˆ¶å¯è§æ€§ï¼ˆé»˜è®¤1ç§’ï¼‰ï¼Œflushæ§åˆ¶å®‰å…¨æ€§ï¼ˆæœ‰translogä¿æŠ¤ï¼‰ï¼Œmergeæ§åˆ¶æ€§èƒ½ï¼ˆåå°è‡ªåŠ¨ï¼‰ã€‚å®æ—¶æ€§è¦æ±‚é«˜è°ƒrefreshé¢‘ç‡ï¼Œå®‰å…¨æ€§è¦æ±‚é«˜è°ƒflushç­–ç•¥ï¼ŒæŸ¥è¯¢æ…¢äº†å…³æ³¨mergeçŠ¶æ€ã€‚"')])]),_._v(" "),t("p",[t("strong",[_._v("Refresh - æ•°æ®å¯è§æ€§")])]),_._v(" "),t("ul",[t("li",[t("p",[_._v("ä½œç”¨ï¼šå†…å­˜æ•°æ® â†’ å¯æœç´¢çŠ¶æ€ï¼ˆä»åœ¨å†…å­˜ï¼‰")])]),_._v(" "),t("li",[t("p",[_._v("é»˜è®¤ï¼šæ¯1ç§’è‡ªåŠ¨æ‰§è¡Œ")])]),_._v(" "),t("li",[t("p",[_._v("è°ƒä¼˜ï¼š")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("é«˜å†™å…¥åœºæ™¯ï¼šè°ƒåˆ°30sæˆ–å…³é—­(-1)")])]),_._v(" "),t("li",[t("p",[_._v("å®æ—¶æœç´¢ï¼šè°ƒåˆ°100msæˆ–ç”¨?refresh=wait_for")])]),_._v(" "),t("li",[t("p",[_._v("å¯¼å…¥æœŸå…³é—­ï¼Œå®Œæˆåæ¢å¤")])])])])]),_._v(" "),t("p",[t("strong",[_._v("Flush - æ•°æ®æŒä¹…åŒ–")])]),_._v(" "),t("ul",[t("li",[t("p",[_._v("ä½œç”¨ï¼šå†…å­˜segment + translog â†’ ç£ç›˜æŒä¹…åŒ–")])]),_._v(" "),t("li",[t("p",[_._v("è§¦å‘ï¼štranslogè¾¾åˆ°512MBæˆ–30åˆ†é’Ÿ")])]),_._v(" "),t("li",[t("p",[_._v("å®‰å…¨çº§åˆ«ï¼š")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("requestï¼šæ¯æ¬¡å†™å…¥ç«‹å³fsyncï¼ˆå®‰å…¨ï¼‰")])]),_._v(" "),t("li",[t("p",[_._v("asyncï¼š5ç§’é—´éš”fsyncï¼ˆæ€§èƒ½å¥½ï¼‰")])])])])]),_._v(" "),t("p",[t("strong",[_._v("Merge - æ€§èƒ½ä¼˜åŒ–")])]),_._v(" "),t("ul",[t("li",[t("p",[_._v("ä½œç”¨ï¼šå¤šä¸ªå°segment â†’ å¤§segmentï¼Œç‰©ç†åˆ é™¤å·²åˆ æ–‡æ¡£")])]),_._v(" "),t("li",[t("p",[_._v("ç­–ç•¥ï¼šåå°è‡ªåŠ¨æ‰§è¡Œï¼Œä¸€èˆ¬ä¸éœ€è¦æ‰‹åŠ¨å¹²é¢„")])]),_._v(" "),t("li",[t("p",[_._v("æ‰‹åŠ¨ï¼šåªè¯»ç´¢å¼•å¯_forcemergeåˆå¹¶åˆ°1ä¸ªsegment")])])]),_._v(" "),t("p",[t("strong",[_._v("æ•°æ®æµè½¬è¿‡ç¨‹")])]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v("å†™å…¥ â†’ Memory Buffer + Translog\nâ†“ Refreshï¼ˆ1sï¼‰\nå¯æœç´¢çš„Segmentï¼ˆå†…å­˜ï¼‰\nâ†“ Flushï¼ˆ512MB/30minï¼‰  \næŒä¹…åŒ–Segmentï¼ˆç£ç›˜ï¼‰\nâ†“ Mergeï¼ˆåå°ï¼‰\nä¼˜åŒ–çš„å¤§Segment\n")])])]),t("p",[t("strong",[_._v("åœºæ™¯é…ç½®")])]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[_._v("// é«˜å†™å…¥åœºæ™¯")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"refresh_interval"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"-1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"flush_threshold"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"1gb"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[_._v("// å®æ—¶æœç´¢  ")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"refresh_interval"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"100ms"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"translog.durability"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"request"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[_._v("// æŸ¥è¯¢ä¼˜åŒ–")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"refresh_interval"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"30s"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v(" å®Œæˆå"),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"_forcemerge"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])]),t("p",[t("strong",[_._v("ç›‘æ§è¦ç‚¹")])]),_._v(" "),t("ul",[t("li",[t("p",[_._v("Refreshï¼š_cat/indices?h=pri.refresh.total_time")])]),_._v(" "),t("li",[t("p",[_._v("Flushï¼š_cat/indices?h=pri.flush.total_time")])]),_._v(" "),t("li",[t("p",[_._v("Mergeï¼š_cat/segmentsæŸ¥çœ‹segmentæ•°é‡å’Œå¤§å°")])])]),_._v(" "),t("p",[t("strong",[_._v("ä¸€å¥è¯è®°å¿†")])]),_._v(" "),t("p",[_._v("Refreshæ§åˆ¶ä½•æ—¶å¯æœï¼ˆé»˜è®¤1sï¼‰ï¼ŒFlushæ§åˆ¶ä½•æ—¶å®‰å…¨ï¼ˆtranslogæ»¡äº†ï¼‰ï¼ŒMergeæ§åˆ¶æŸ¥è¯¢å¿«æ…¢ï¼ˆè‡ªåŠ¨åˆå¹¶ï¼‰ï¼Œæ ¹æ®è¯»å†™åœºæ™¯è°ƒæ•´ä¸‰ä¸ªå‚æ•°çš„é¢‘ç‡å³å¯ã€‚")]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-es-ä¸ºä»€ä¹ˆæ˜¯-è¿‘å®æ—¶-nrt-æœç´¢"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-ä¸ºä»€ä¹ˆæ˜¯-è¿‘å®æ—¶-nrt-æœç´¢"}},[_._v("#")]),_._v(" ğŸ¯ ES ä¸ºä»€ä¹ˆæ˜¯â€œè¿‘å®æ—¶ï¼ˆNRTï¼‰â€æœç´¢ï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[_._v("Elasticsearch æ˜¯ "),t("strong",[_._v("è¿‘å®æ—¶æœç´¢ï¼ˆNRTï¼‰")]),_._v("ï¼Œå› ä¸ºï¼š")]),_._v(" "),t("ol",[t("li",[_._v("æ–‡æ¡£å†™å…¥å…ˆè¿›å…¥å†…å­˜ bufferï¼Œå¹¶è®°å½•åœ¨ translogï¼›")]),_._v(" "),t("li",[_._v("åªæœ‰åœ¨ Lucene æ‰§è¡Œ "),t("strong",[_._v("refresh")]),_._v("ï¼ˆé»˜è®¤ 1s ä¸€æ¬¡ï¼‰åï¼Œå†…å­˜æ•°æ®æ‰å†™å…¥æ–°çš„ segment å¹¶å¯¹æœç´¢å¯è§ï¼›")]),_._v(" "),t("li",[_._v("å› æ­¤ï¼Œå†™å…¥ååˆ°èƒ½è¢«æ£€ç´¢ä¹‹é—´å­˜åœ¨ "),t("strong",[_._v("çº¦ 1 ç§’çš„å»¶è¿Ÿ")]),_._v("ã€‚")])])]),_._v(" "),t("ol",[t("li",[t("p",[_._v("ä»€ä¹ˆæ˜¯ NRTï¼ˆNear Real-Timeï¼Œè¿‘å®æ—¶ï¼‰")]),_._v(" "),t("p",[_._v("Elasticsearch ä¸æ˜¯ä¸¥æ ¼çš„å®æ—¶æœç´¢ï¼Œè€Œæ˜¯ "),t("strong",[_._v("è¿‘å®æ—¶æœç´¢")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("å½“ä½ å†™å…¥ä¸€ä¸ªæ–‡æ¡£åï¼Œ"),t("strong",[_._v("ä¸ä¼šç«‹åˆ»å°±èƒ½è¢«æœç´¢åˆ°")]),_._v("ã€‚")])]),_._v(" "),t("li",[t("p",[_._v("é»˜è®¤æƒ…å†µä¸‹ï¼Œå¤§çº¦ "),t("strong",[_._v("1 ç§’å»¶è¿Ÿ")]),_._v(" åæ‰å¯è¢«æ£€ç´¢ã€‚")])])])])]),_._v(" "),t("hr"),_._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[t("p",[_._v("åŸå› ï¼šLucene çš„æ®µï¼ˆSegmentï¼‰æœºåˆ¶")]),_._v(" "),t("p",[_._v("Elasticsearch åº•å±‚ç”¨ "),t("strong",[_._v("Lucene")]),_._v(" æ¥å­˜å‚¨å’Œæ£€ç´¢æ•°æ®ã€‚Lucene çš„å­˜å‚¨å•å…ƒæ˜¯ "),t("strong",[_._v("segment")]),_._v(" æ–‡ä»¶ï¼Œè€Œ segment æ˜¯"),t("strong",[_._v("åªè¯»ä¸å¯ä¿®æ”¹")]),_._v("çš„ï¼Œå†™å…¥æµç¨‹å¦‚ä¸‹ï¼š")]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("å†™å…¥å†…å­˜ç¼“å†²åŒºï¼ˆIndexing Bufferï¼‰")]),_._v(" "),t("ul",[t("li",[_._v("æ–°æ–‡æ¡£å…ˆå†™å…¥ ES çš„å†…å­˜ bufferã€‚")]),_._v(" "),t("li",[_._v("åŒæ—¶å†™ä¸€ä»½åˆ° "),t("strong",[_._v("äº‹åŠ¡æ—¥å¿—ï¼ˆtranslogï¼‰")]),_._v("ï¼Œç”¨äºæ•…éšœæ¢å¤ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("refresh æ“ä½œ")]),_._v(" "),t("ul",[t("li",[_._v("Lucene ä¼šå®šæœŸï¼ˆé»˜è®¤ 1 ç§’ï¼‰æŠŠå†…å­˜ buffer ä¸­çš„æ•°æ®å†™å…¥ä¸€ä¸ªæ–°çš„ segment æ–‡ä»¶ï¼Œå¹¶ç”Ÿæˆå€’æ’ç´¢å¼•ï¼Œå¼€æ”¾ç»™æœç´¢ä½¿ç”¨ã€‚")]),_._v(" "),t("li",[_._v("åªæœ‰åœ¨ refresh ä¹‹åï¼Œæ–‡æ¡£æ‰ä¼šè¢«æ£€ç´¢åˆ°ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("flush æ“ä½œ")]),_._v(" "),t("ul",[t("li",[_._v("å°†å†…å­˜æ•°æ® + translog æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œç”Ÿæˆæ–°çš„ segmentï¼Œå¹¶æ¸…ç©º translogã€‚")]),_._v(" "),t("li",[_._v("flush ä¸æ˜¯æ¯ç§’éƒ½å‘ç”Ÿï¼Œè€Œæ˜¯æŒ‰æ¡ä»¶è§¦å‘ï¼ˆå¦‚ translog å¤ªå¤§ï¼‰ã€‚")])])])])])]),_._v(" "),t("hr"),_._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[t("p",[_._v("NRT çš„å…³é”®ç‚¹")]),_._v(" "),t("ul",[t("li",[t("p",[t("strong",[_._v("å†™å…¥åé©¬ä¸Šå¯è·å–ï¼ˆgetï¼‰")]),_._v("ï¼š\nES å†™å…¥æ–‡æ¡£åï¼Œå¯ä»¥ç«‹å³é€šè¿‡ "),t("code",[_._v("_id")]),_._v(" æ¥ "),t("strong",[_._v("get")]),_._v("ï¼Œå› ä¸ºå®ƒç›´æ¥ä»å†…å­˜å’Œ translog é‡Œæ‹¿æ•°æ®ã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("å†™å…¥åå»¶è¿Ÿå¯æœç´¢")]),_._v("ï¼š\néœ€è¦ç­‰åˆ°ä¸‹ä¸€æ¬¡ "),t("strong",[_._v("refresh")]),_._v("ï¼Œæ–‡æ¡£æ‰ä¼šå‡ºç°åœ¨å€’æ’ç´¢å¼•é‡Œï¼Œä»è€Œèƒ½è¢«æœç´¢åˆ°ã€‚")])])])])]),_._v(" "),t("p",[_._v("â€‹\tæ‰€ä»¥ ES æ‰è¢«ç§°ä¸º "),t("strong",[_._v("è¿‘å®æ—¶")]),_._v("æœç´¢ç³»ç»Ÿï¼ˆNRTï¼‰ï¼Œè€Œä¸æ˜¯ä¸¥æ ¼å®æ—¶ï¼ˆRTï¼‰ã€‚")]),_._v(" "),t("hr"),_._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[_._v("å‚æ•°ä¸è°ƒä¼˜")])]),_._v(" "),t("ul",[t("li",[t("p",[t("code",[_._v("index.refresh_interval")])]),_._v(" "),t("ul",[t("li",[_._v("é»˜è®¤ "),t("code",[_._v("1s")]),_._v("ï¼Œè¡¨ç¤ºæ¯ç§’ refresh ä¸€æ¬¡ã€‚")]),_._v(" "),t("li",[_._v("å¯ä»¥è°ƒå¤§ï¼ˆå¦‚ "),t("code",[_._v("30s")]),_._v("ï¼‰ï¼Œæé«˜å†™å…¥æ€§èƒ½ï¼Œé™ä½æœç´¢å®æ—¶æ€§ã€‚")]),_._v(" "),t("li",[_._v("å¯ä»¥è®¾ä¸º "),t("code",[_._v("-1")]),_._v("ï¼Œå…³é—­è‡ªåŠ¨ refreshï¼ˆå†™å…¥ååæœ€å¤§ï¼Œä½†æœç´¢ä¸åˆ°æ–°æ–‡æ¡£ï¼Œç›´åˆ°æ‰‹åŠ¨ refreshï¼‰ã€‚")])])]),_._v(" "),t("li",[t("p",[_._v("æ‰‹åŠ¨æ‰§è¡Œï¼š")]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v("POST /my_index/_refresh\n")])])])])]),_._v(" "),t("hr"),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-å†™å…¥ä¸ºä½•-è¿‘å®æ—¶-å¦‚ä½•æåå"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å†™å…¥ä¸ºä½•-è¿‘å®æ—¶-å¦‚ä½•æåå"}},[_._v("#")]),_._v(" ğŸ¯ å†™å…¥ä¸ºä½•â€œè¿‘å®æ—¶â€ï¼Ÿå¦‚ä½•æååï¼Ÿ")]),_._v(" "),t("ul",[t("li",[_._v("è¯æœ¯\n"),t("ul",[t("li",[_._v("å†™å…¥â†’å†…å­˜ bufferï¼›refresh æš´éœ²æ–° segment å¯æœï¼ˆé»˜è®¤ 1sï¼‰ï¼›flush æŒä¹…åŒ– translog+commitï¼›merge åå°åˆå¹¶ã€‚æ‰¹é‡å†™ç”¨ bulkï¼Œå†™å¤šæ—¶ä¸´æ—¶è°ƒå¤§ refresh_intervalã€‚")])])]),_._v(" "),t("li",[_._v("å…³é”®è¦ç‚¹\n"),t("ul",[t("li",[_._v("bulk 5â€“15MB/æ‰¹ã€å¹¶å‘é€šé“é€‚ä¸­ï¼›å†™å‰ replicas=0ã€refresh=-1ï¼Œå†™åæ¢å¤ã€‚")])])]),_._v(" "),t("li",[_._v("ç¤ºä¾‹")])]),_._v(" "),t("div",{staticClass:"language-properties extra-class"},[t("pre",{pre:!0,attrs:{class:"language-properties"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key attr-name"}},[_._v("index.refresh_interval")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("=")]),t("span",{pre:!0,attrs:{class:"token value attr-value"}},[_._v("1s   # æ‰¹é‡å¯¼å…¥ä¸´æ—¶ -1")]),_._v("\n")])])]),t("ul",[t("li",[_._v("å¸¸è§è¿½é—®\n"),t("ul",[t("li",[_._v("ä¸ºä»€ä¹ˆä¸è¦é¢‘ç¹ refreshï¼Ÿå°æ®µå¤ªå¤šå½±å“æ£€ç´¢ä¸åˆå¹¶ã€‚")])])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-æ€ä¹ˆä¼˜åŒ–-elasticsearch-çš„æŸ¥è¯¢æ€§èƒ½"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-æ€ä¹ˆä¼˜åŒ–-elasticsearch-çš„æŸ¥è¯¢æ€§èƒ½"}},[_._v("#")]),_._v(" ğŸ¯ "),t("strong",[_._v("æ€ä¹ˆä¼˜åŒ–")]),_._v(" "),t("strong",[_._v("Elasticsearch")]),_._v(" çš„æŸ¥è¯¢æ€§èƒ½ï¼Ÿ")]),_._v(" "),t("p",[t("strong",[_._v("ä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢")])]),_._v(" "),t("p",[_._v("åœ¨ Elasticsearch é‡Œé¢ï¼Œä¹Ÿæœ‰ä¸¤ç§å¯è¡Œçš„ä¼˜åŒ–æ‰‹æ®µã€‚")]),_._v(" "),t("ol",[t("li",[t("p",[_._v("Scroll å’Œ Scroll Scanï¼šè¿™ç§æ–¹å¼é€‚åˆä¸€æ¬¡æ€§æŸ¥è¯¢å¤§é‡çš„æ•°æ®ï¼Œæ¯”å¦‚è¯´å¯¼å‡ºæ•°æ®ä¹‹ç±»çš„åœºæ™¯ã€‚è¿™ç§ç”¨æ³•æ›´åŠ æ¥è¿‘ä½ åœ¨åˆ«çš„è¯­è¨€æˆ–è€…ä¸­é—´ä»¶é‡Œé¢æ¥è§¦åˆ°çš„æ¸¸æ ‡çš„æ¦‚å¿µã€‚")])]),_._v(" "),t("li",[t("p",[_._v("Search Afterï¼šä¹Ÿå°±æ˜¯ç¿»é¡µï¼Œä½ åœ¨æŸ¥è¯¢çš„æ—¶å€™éœ€è¦åœ¨å½“æ¬¡æŸ¥è¯¢é‡Œé¢å¸¦ä¸Šä¸Šä¸€æ¬¡æŸ¥è¯¢ä¸­è¿”å›çš„ search_after å­—æ®µã€‚")])])]),_._v(" "),t("p",[t("strong",[_._v("å¢å¤§åˆ·æ–°é—´éš”")])]),_._v(" "),t("ul",[t("li",[_._v("å¯ä»¥æŠŠ index.refresh_interval è°ƒå¤§ä¸€äº›")])]),_._v(" "),t("p",[t("strong",[_._v("ä¼˜åŒ–ä¸å¿…è¦å­—æ®µ")])]),_._v(" "),t("p",[t("strong",[_._v("å†·çƒ­åˆ†ç¦»")])]),_._v(" "),t("p",[_._v("å®ƒçš„åŸºæœ¬æ€è·¯æ˜¯åŒä¸€ä¸ªä¸šåŠ¡é‡Œé¢æ•°æ®ä¹Ÿæœ‰å†·çƒ­ä¹‹åˆ†ã€‚å¯¹äºå†·æ•°æ®æ¥è¯´ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨è¿è¡Œåœ¨å»‰ä»·æœåŠ¡å™¨ä¸Šçš„ Elasticsearch æ¥å­˜å‚¨ï¼›è€Œå¯¹")]),_._v(" "),t("p",[_._v("äºçƒ­æ•°æ®æ¥è¯´ï¼Œå°±å¯ä»¥ä½¿ç”¨è¿è¡Œåœ¨æ˜‚è´µçš„é«˜æ€§èƒ½æœåŠ¡å™¨ä¸Šçš„ Elasticsearchã€‚")]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-elasticsearch-ç´¢å¼•æ•°æ®å¤šäº†æ€ä¹ˆåŠ-å¦‚ä½•è°ƒä¼˜-éƒ¨ç½²"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-elasticsearch-ç´¢å¼•æ•°æ®å¤šäº†æ€ä¹ˆåŠ-å¦‚ä½•è°ƒä¼˜-éƒ¨ç½²"}},[_._v("#")]),_._v(" ğŸ¯ Elasticsearch ç´¢å¼•æ•°æ®å¤šäº†æ€ä¹ˆåŠï¼Œå¦‚ä½•è°ƒä¼˜ï¼Œéƒ¨ç½²")]),_._v(" "),t("p",[t("code",[_._v("é¢è¯•å®˜")]),_._v(" ï¼šæƒ³äº†è§£å¤§æ•°æ®é‡çš„è¿ç»´èƒ½åŠ›ã€‚")]),_._v(" "),t("p",[t("code",[_._v("è§£ç­”")]),_._v(" ï¼šç´¢å¼•æ•°æ®çš„è§„åˆ’ï¼Œåº”åœ¨å‰æœŸåšå¥½è§„åˆ’ï¼Œæ­£æ‰€è°“â€œè®¾è®¡å…ˆè¡Œï¼Œç¼–ç åœ¨åâ€ï¼Œè¿™æ ·æ‰èƒ½æœ‰æ•ˆçš„é¿å…çªå¦‚å…¶æ¥çš„æ•°æ®æ¿€å¢å¯¼è‡´é›†ç¾¤å¤„ç†èƒ½åŠ›ä¸è¶³å¼•å‘çš„çº¿ä¸Šå®¢æˆ·æ£€ç´¢æˆ–è€…å…¶ä»–ä¸šåŠ¡å—åˆ°å½±å“ã€‚å¦‚ä½•è°ƒä¼˜ï¼Œæ­£å¦‚é—®é¢˜1æ‰€è¯´ï¼Œè¿™é‡Œç»†åŒ–ä¸€ä¸‹ï¼š")]),_._v(" "),t("h4",{attrs:{id:"_3-1-åŠ¨æ€ç´¢å¼•å±‚é¢"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-åŠ¨æ€ç´¢å¼•å±‚é¢"}},[_._v("#")]),_._v(" 3.1 åŠ¨æ€ç´¢å¼•å±‚é¢")]),_._v(" "),t("p",[_._v("åŸºäº"),t("code",[_._v("æ¨¡æ¿+æ—¶é—´+rollover apiæ»šåŠ¨")]),_._v(" åˆ›å»ºç´¢å¼•ï¼Œä¸¾ä¾‹ï¼šè®¾è®¡é˜¶æ®µå®šä¹‰ï¼šblogç´¢å¼•çš„æ¨¡æ¿æ ¼å¼ä¸ºï¼šblog_index_æ—¶é—´æˆ³çš„å½¢å¼ï¼Œæ¯å¤©é€’å¢æ•°æ®ã€‚")]),_._v(" "),t("p",[_._v("è¿™æ ·åšçš„å¥½å¤„ï¼šä¸è‡³äºæ•°æ®é‡æ¿€å¢å¯¼è‡´å•ä¸ªç´¢å¼•æ•°æ®é‡éå¸¸å¤§ï¼Œæ¥è¿‘äºä¸Šçº¿2çš„32æ¬¡å¹‚-1ï¼Œç´¢å¼•å­˜å‚¨è¾¾åˆ°äº†TB+ç”šè‡³æ›´å¤§ã€‚")]),_._v(" "),t("p",[_._v("ä¸€æ—¦å•ä¸ªç´¢å¼•å¾ˆå¤§ï¼Œå­˜å‚¨ç­‰å„ç§é£é™©ä¹Ÿéšä¹‹è€Œæ¥ï¼Œæ‰€ä»¥è¦æå‰è€ƒè™‘+åŠæ—©é¿å…ã€‚")]),_._v(" "),t("h4",{attrs:{id:"_3-2-å­˜å‚¨å±‚é¢"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-å­˜å‚¨å±‚é¢"}},[_._v("#")]),_._v(" 3.2 å­˜å‚¨å±‚é¢")]),_._v(" "),t("p",[t("code",[_._v("å†·çƒ­æ•°æ®åˆ†ç¦»å­˜å‚¨")]),_._v(" ï¼Œçƒ­æ•°æ®ï¼ˆæ¯”å¦‚æœ€è¿‘3å¤©æˆ–è€…ä¸€å‘¨çš„æ•°æ®ï¼‰ï¼Œå…¶ä½™ä¸ºå†·æ•°æ®ã€‚å¯¹äºå†·æ•°æ®ä¸ä¼šå†å†™å…¥æ–°æ•°æ®ï¼Œå¯ä»¥è€ƒè™‘å®šæœŸforce_mergeåŠ shrinkå‹ç¼©æ“ä½œï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´å’Œæ£€ç´¢æ•ˆç‡ã€‚")]),_._v(" "),t("h4",{attrs:{id:"_3-3-éƒ¨ç½²å±‚é¢"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-éƒ¨ç½²å±‚é¢"}},[_._v("#")]),_._v(" 3.3 éƒ¨ç½²å±‚é¢")]),_._v(" "),t("p",[_._v("ä¸€æ—¦ä¹‹å‰æ²¡æœ‰è§„åˆ’ï¼Œè¿™é‡Œå°±å±äºåº”æ€¥ç­–ç•¥ã€‚ç»“åˆESè‡ªèº«çš„æ”¯æŒåŠ¨æ€æ‰©å±•çš„ç‰¹ç‚¹ï¼ŒåŠ¨æ€æ–°å¢æœºå™¨çš„æ–¹å¼å¯ä»¥ç¼“è§£é›†ç¾¤å‹åŠ›ï¼Œæ³¨æ„ï¼šå¦‚æœä¹‹å‰ä¸»èŠ‚ç‚¹ç­‰"),t("code",[_._v("è§„åˆ’åˆç†")]),_._v(" ï¼Œä¸éœ€è¦é‡å¯é›†ç¾¤ä¹Ÿèƒ½å®ŒæˆåŠ¨æ€æ–°å¢çš„ã€‚")]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-æ€ä¹ˆä¿è¯-elasticsearch-çš„é«˜å¯ç”¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-æ€ä¹ˆä¿è¯-elasticsearch-çš„é«˜å¯ç”¨"}},[_._v("#")]),_._v(" ğŸ¯ æ€ä¹ˆä¿è¯ Elasticsearch çš„é«˜å¯ç”¨ï¼Ÿ")]),_._v(" "),t("p",[_._v("Elasticsearch çš„èŠ‚ç‚¹å¯ä»¥åˆ†æˆå¾ˆå¤šç§è§’è‰²ï¼Œå¹¶ä¸”ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥æ‰®æ¼”å¤šç§è§’è‰²ã€‚è¿™é‡Œæˆ‘åˆ—ä¸¾å‡ ç§ä¸»è¦çš„ã€‚")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("å€™é€‰ä¸»èŠ‚ç‚¹ï¼ˆMaster-eligible Node)ï¼šå¯ä»¥è¢«é€‰ä¸¾ä¸ºä¸»èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚ä¸»èŠ‚ç‚¹ä¸»è¦è´Ÿè´£é›†ç¾¤æœ¬èº«çš„ç®¡ç†ï¼Œæ¯”å¦‚è¯´åˆ›å»ºç´¢å¼•ã€‚ç±»ä¼¼çš„è¿˜æœ‰ä»…æŠ•ç¥¨èŠ‚ç‚¹ï¼ˆVoting-only Nodeï¼‰ï¼Œè¿™ç±»èŠ‚ç‚¹åªå‚ä¸ä¸»ä»é€‰ä¸¾ï¼Œä½†æ˜¯è‡ªèº«å¹¶ä¸ä¼šè¢«é€‰ä¸¾ä¸ºä¸»èŠ‚ç‚¹ã€‚")])]),_._v(" "),t("li",[t("p",[_._v("åè°ƒèŠ‚ç‚¹ï¼ˆCoordinating Nodeï¼‰ï¼šåè°ƒèŠ‚ç‚¹è´Ÿè´£åè°ƒè¯·æ±‚çš„å¤„ç†è¿‡ç¨‹ã€‚ä¸€ä¸ªæŸ¥è¯¢è¯·æ±‚ä¼šè¢«å‘é€åˆ°åè°ƒèŠ‚ç‚¹ä¸Šï¼Œåè°ƒèŠ‚ç‚¹ç¡®å®šæ•°æ®èŠ‚ç‚¹ï¼Œç„¶åè®©æ•°æ®èŠ‚ç‚¹æ‰§è¡ŒæŸ¥è¯¢ï¼Œæœ€ååè°ƒèŠ‚ç‚¹åˆå¹¶æ•°æ®èŠ‚ç‚¹è¿”å›çš„ç»“æœé›†ã€‚å¤§å¤šæ•°èŠ‚ç‚¹éƒ½ä¼šå…¼ä»»è¿™ä¸ªè§’è‰²ã€‚")])]),_._v(" "),t("li",[t("p",[_._v("æ•°æ®èŠ‚ç‚¹ï¼ˆData Nodeï¼‰ï¼šå­˜å‚¨æ•°æ®çš„èŠ‚ç‚¹ã€‚å½“åè°ƒèŠ‚ç‚¹å‘æ¥æŸ¥è¯¢è¯·æ±‚çš„æ—¶å€™ï¼Œä¹Ÿä¼šæ‰§è¡ŒæŸ¥è¯¢å¹¶ä¸”æŠŠç»“æœè¿”å›ç»™åè°ƒèŠ‚ç‚¹ã€‚ç±»ä¼¼çš„è¿˜æœ‰çƒ­æ•°æ®èŠ‚ç‚¹ï¼ˆHot Data Nodeï¼‰ã€æš–æ•°æ®èŠ‚ç‚¹ï¼ˆWarm Data Nodeï¼‰ã€å†·æ•°æ®èŠ‚ç‚¹ï¼ˆCold Data Nodeï¼‰ï¼Œä½ ä»åå­—å°±å¯ä»¥çœ‹å‡ºæ¥ï¼Œå®ƒä»¬åªæ˜¯ç”¨äºå­˜å‚¨ä¸åŒçƒ­åº¦çš„æ•°æ®ã€‚")])])]),_._v(" "),t("p",[t("strong",[_._v("å†™å…¥æ•°æ®")])]),_._v(" "),t("ol",[t("li",[_._v("æ–‡æ¡£é¦–å…ˆè¢«å†™å…¥åˆ° Buffer é‡Œé¢ï¼Œè¿™ä¸ªæ˜¯ Elasticsearch è‡ªå·±çš„ Bufferã€‚")]),_._v(" "),t("li",[_._v("å®šæ—¶åˆ·æ–°åˆ° Page Cache é‡Œé¢ã€‚è¿™ä¸ªè¿‡ç¨‹å«åš refreshï¼Œé»˜è®¤æ˜¯ 1 ç§’é’Ÿæ‰§è¡Œä¸€æ¬¡ã€‚")]),_._v(" "),t("li",[_._v("åˆ·æ–°åˆ°ç£ç›˜ä¸­ï¼Œè¿™æ—¶å€™è¿˜ä¼šåŒæ­¥è®°å½•ä¸€ä¸ª Commit Pointã€‚")])]),_._v(" "),t("p",[t("img",{attrs:{src:"https://i-blog.csdnimg.cn/blog_migrate/065a9dbf0202218c0bf71a2528607612.png",alt:"ES æ˜¯å¦‚ä½•å†™å…¥ä¸€æ¡æ•°æ®çš„ï¼Ÿ_eså†™å…¥æ•°æ®-CSDNåšå®¢"}})]),_._v(" "),t("p",[_._v("åœ¨å†™å…¥åˆ° Page Cache ä¹‹åä¼šäº§ç”Ÿå¾ˆå¤šæ®µï¼ˆSegmentï¼‰ï¼Œä¸€ä¸ªæ®µé‡Œé¢åŒ…å«äº†å¤šä¸ªæ–‡æ¡£ã€‚æ–‡æ¡£åªæœ‰å†™åˆ°äº†è¿™é‡Œä¹‹åæ‰å¯ä»¥è¢«æœç´¢åˆ°ï¼Œå› æ­¤ä»æ”¯æŒæœç´¢çš„è§’åº¦æ¥è¯´ï¼ŒElasticsearch æ˜¯è¿‘å®æ—¶çš„ã€‚")]),_._v(" "),t("p",[_._v("ä¸æ–­å†™å…¥ä¼šä¸æ–­äº§ç”Ÿæ®µï¼Œè€Œæ¯ä¸€ä¸ªæ®µéƒ½è¦æ¶ˆè€— CPUã€å†…å­˜å’Œæ–‡ä»¶å¥æŸ„ï¼Œæ‰€ä»¥éœ€è¦è€ƒè™‘åˆå¹¶ã€‚")]),_._v(" "),t("p",[_._v("ä½†æ˜¯ä½ ä¹Ÿæ³¨æ„åˆ°äº†ï¼Œè¿™äº›æ®µæœ¬èº«è¿˜åœ¨æ”¯æŒæœç´¢ï¼Œå› æ­¤åœ¨åˆå¹¶æ®µçš„æ—¶å€™ï¼Œä¸èƒ½å¯¹å·²æœ‰çš„æŸ¥è¯¢äº§ç”Ÿå½±å“ã€‚")]),_._v(" "),t("p",[_._v("æ‰€ä»¥åˆæœ‰äº†åˆå¹¶æ®µçš„è¿‡ç¨‹ï¼Œå¤§æ¦‚æ˜¯")]),_._v(" "),t("ol",[t("li",[_._v("å·²æœ‰çš„æ®µä¸åŠ¨ã€‚")]),_._v(" "),t("li",[_._v("åˆ›å»ºä¸€ä¸ªæ–°çš„æ®µï¼ŒæŠŠå·²æœ‰æ®µçš„æ•°æ®å†™è¿‡å»ï¼Œæ ‡è®°ä¸ºåˆ é™¤çš„æ–‡æ¡£å°±ä¸ä¼šå†™åˆ°æ®µé‡Œé¢ã€‚")]),_._v(" "),t("li",[_._v("å‘ŠçŸ¥æŸ¥è¯¢ä½¿ç”¨æ–°çš„æ®µã€‚")]),_._v(" "),t("li",[_._v("ç­‰ä½¿ç”¨è€çš„æ®µçš„æŸ¥è¯¢éƒ½ç»“æŸäº†ï¼Œç›´æ¥åˆ æ‰è€çš„æ®µã€‚")])]),_._v(" "),t("p",[_._v("é‚£ä¹ˆæŸ¥è¯¢æ€ä¹ˆçŸ¥é“åº”è¯¥ä½¿ç”¨åˆå¹¶æ®µäº†å‘¢ï¼Ÿè¿™éƒ½ä¾èµ–äºä¸€ä¸ªç»Ÿä¸€çš„æœºåˆ¶ï¼Œå°±æ˜¯ Commit Pointã€‚ä½ å¯ä»¥ç†è§£æˆï¼Œå®ƒé‡Œé¢è®°å½•äº†å“ªäº›æ®µæ˜¯å¯ç”¨çš„ã€‚æ‰€ä»¥å½“åˆå¹¶æ®µä¹‹åï¼Œäº§ç”Ÿä¸€ä¸ªæ–°çš„ CommitPointï¼Œé‡Œé¢æœ‰åˆå¹¶åçš„æ®µï¼Œä½†æ˜¯æ²¡æœ‰è¢«åˆå¹¶çš„æ®µï¼Œå°±ç›¸å½“äºå‘ŠçŸ¥äº†æŸ¥è¯¢ä½¿ç”¨æ–°çš„æ®µã€‚")]),_._v(" "),t("p",[t("strong",[_._v("Translog")])]),_._v(" "),t("p",[_._v("å®é™…ä¸Šï¼ŒElasticsearch åœ¨å†™å…¥çš„æ—¶å€™ï¼Œè¿˜è¦å†™å…¥ä¸€ä¸ªä¸œè¥¿ï¼Œä¹Ÿå°±æ˜¯ Translogã€‚ç›´è§‚æ¥è¯´ï¼Œä½ å¯ä»¥æŠŠè¿™ä¸ªçœ‹æˆæ˜¯ MySQL é‡Œå’Œ redo log å·®ä¸å¤šçš„ä¸œè¥¿ã€‚ä¹Ÿå°±æ˜¯å¦‚æœå®•æœºäº†ï¼ŒElasticsearchå¯ä»¥ç”¨ Translog æ¥æ¢å¤æ•°æ®ã€‚")]),_._v(" "),t("blockquote",[t("p",[_._v("MySQL å†™å…¥çš„æ—¶å€™ï¼Œå…¶å®åªæ˜¯ä¿®æ”¹äº†å†…å­˜é‡Œçš„å€¼ï¼Œç„¶åè®°å½•äº†æ—¥å¿—ï¼Œä¹Ÿå°±æ˜¯ binlogã€redo log å’Œ undo logã€‚")]),_._v(" "),t("p",[_._v("Elasticsearchå†™å…¥çš„æ—¶å€™ï¼Œä¹Ÿæ˜¯å†™åˆ°äº† Buffer é‡Œï¼Œç„¶åè®°å½•äº† Translogã€‚ä¸åŒçš„æ˜¯ï¼ŒTranslog æ˜¯å›ºå®šé—´éš”åˆ·æ–°åˆ°ç£ç›˜ä¸Šçš„ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ 5 ç§’ã€‚")])]),_._v(" "),t("p",[_._v("Elasticsearch é«˜å¯ç”¨çš„æ ¸å¿ƒæ˜¯åˆ†ç‰‡ï¼Œå¹¶ä¸”æ¯ä¸ªåˆ†ç‰‡éƒ½æœ‰ä¸»ä»ä¹‹åˆ†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸‡ä¸€ä¸»åˆ†ç‰‡å´©æºƒäº†ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ä»åˆ†ç‰‡ï¼Œä»è€Œä¿è¯äº†æœ€åŸºæœ¬çš„å¯ç”¨æ€§ã€‚")]),_._v(" "),t("p",[_._v("è€Œä¸” Elasticsearch åœ¨å†™å…¥æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œä¸ºäº†ä¿è¯é«˜æ€§èƒ½ï¼Œéƒ½æ˜¯å†™åˆ°è‡ªå·±çš„ Buffer é‡Œé¢ï¼Œåé¢å†åˆ·æ–°åˆ°ç£ç›˜ä¸Šã€‚æ‰€ä»¥ä¸ºäº†é™ä½æ•°æ®ä¸¢å¤±çš„é£é™©ï¼ŒElasticsearch è¿˜é¢å¤–å†™äº†ä¸€ä¸ª Translogï¼Œå®ƒå°±ç±»ä¼¼äº MySQL é‡Œçš„ redo logã€‚åé¢ Elasticsearch å´©æºƒä¹‹åï¼Œå¯ä»¥åˆ©ç”¨ Translog æ¥æ¢å¤æ•°æ®ã€‚")]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-elasticsearchåœ¨éƒ¨ç½²æ—¶-å¯¹linuxçš„è®¾ç½®æœ‰å“ªäº›ä¼˜åŒ–æ–¹æ³•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-elasticsearchåœ¨éƒ¨ç½²æ—¶-å¯¹linuxçš„è®¾ç½®æœ‰å“ªäº›ä¼˜åŒ–æ–¹æ³•"}},[_._v("#")]),_._v(" ğŸ¯ Elasticsearchåœ¨éƒ¨ç½²æ—¶ï¼Œå¯¹Linuxçš„è®¾ç½®æœ‰å“ªäº›ä¼˜åŒ–æ–¹æ³•")]),_._v(" "),t("p",[t("code",[_._v("é¢è¯•å®˜")]),_._v(" ï¼šæƒ³äº†è§£å¯¹ESé›†ç¾¤çš„è¿ç»´èƒ½åŠ›ã€‚")]),_._v(" "),t("p",[t("code",[_._v("è§£ç­”")]),_._v(" ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("å…³é—­ç¼“å­˜swap;")]),_._v(" "),t("li",[_._v("å †å†…å­˜è®¾ç½®ä¸ºï¼šMinï¼ˆèŠ‚ç‚¹å†…å­˜/2, 32GBï¼‰;")]),_._v(" "),t("li",[_._v("è®¾ç½®æœ€å¤§æ–‡ä»¶å¥æŸ„æ•°ï¼›")]),_._v(" "),t("li",[_._v("çº¿ç¨‹æ± +é˜Ÿåˆ—å¤§å°æ ¹æ®ä¸šåŠ¡éœ€è¦åšè°ƒæ•´ï¼›")]),_._v(" "),t("li",[_._v("ç£ç›˜å­˜å‚¨raidæ–¹å¼â€”â€”å­˜å‚¨æœ‰æ¡ä»¶ä½¿ç”¨RAID10ï¼Œå¢åŠ å•èŠ‚ç‚¹æ€§èƒ½ä»¥åŠé¿å…å•èŠ‚ç‚¹å­˜å‚¨æ•…éšœã€‚")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-lucenceå†…éƒ¨ç»“æ„æ˜¯ä»€ä¹ˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-lucenceå†…éƒ¨ç»“æ„æ˜¯ä»€ä¹ˆ"}},[_._v("#")]),_._v(" ğŸ¯ lucenceå†…éƒ¨ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿ")]),_._v(" "),t("p",[t("code",[_._v("é¢è¯•å®˜")]),_._v(" ï¼šæƒ³äº†è§£ä½ çš„çŸ¥è¯†é¢çš„å¹¿åº¦å’Œæ·±åº¦ã€‚")]),_._v(" "),t("p",[t("code",[_._v("è§£ç­”")]),_._v(" ï¼š")]),_._v(" "),t("p",[t("img",{attrs:{src:"https://img-blog.csdnimg.cn/20190119231637780.png",alt:""}})]),_._v(" "),t("p",[_._v("Luceneæ˜¯æœ‰ç´¢å¼•å’Œæœç´¢çš„ä¸¤ä¸ªè¿‡ç¨‹ï¼ŒåŒ…å«ç´¢å¼•åˆ›å»ºï¼Œç´¢å¼•ï¼Œæœç´¢ä¸‰ä¸ªè¦ç‚¹ã€‚å¯ä»¥åŸºäºè¿™ä¸ªè„‰ç»œå±•å¼€ä¸€äº›ã€‚")]),_._v(" "),t("h2",{attrs:{id:"ğŸ”§-äº”ã€é«˜çº§ç‰¹æ€§-è¿›é˜¶"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”§-äº”ã€é«˜çº§ç‰¹æ€§-è¿›é˜¶"}},[_._v("#")]),_._v(" ğŸ”§ äº”ã€é«˜çº§ç‰¹æ€§ï¼ˆè¿›é˜¶ï¼‰")]),_._v(" "),t("blockquote",[t("p",[t("strong",[_._v("æ ¸å¿ƒæ€æƒ³")]),_._v("ï¼šæŒæ¡ESçš„é«˜çº§ç‰¹æ€§å¦‚èšåˆåˆ†æã€è·¯ç”±æœºåˆ¶ã€æ‰¹é‡æ“ä½œã€è„šæœ¬æŸ¥è¯¢ç­‰ï¼Œä½“ç°å¯¹ESæ·±å±‚åŸç†çš„ç†è§£ã€‚")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("è·¯ç”±æœºåˆ¶")]),_._v("ï¼š"),t("a",{attrs:{href:"#%E4%BB%80%E4%B9%88%E6%98%AF-routing%E5%A6%82%E4%BD%95%E5%BD%B1%E5%93%8D%E6%9F%A5%E8%AF%A2%E5%92%8C%E5%86%99%E5%85%A5"}},[_._v("RoutingåŸç†")]),_._v(" | "),t("a",{attrs:{href:"#es-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E9%AB%98%E5%8F%AF%E7%94%A8"}},[_._v("é«˜å¯ç”¨å®ç°")])]),_._v(" "),t("li",[t("strong",[_._v("æ‰¹é‡æ“ä½œ")]),_._v("ï¼š"),t("a",{attrs:{href:"#es-%E7%9A%84%E6%89%B9%E9%87%8F%E6%93%8D%E4%BD%9Cbulk-api%E6%80%8E%E4%B9%88%E7%94%A8%E4%B8%BA%E4%BB%80%E4%B9%88%E6%AF%94%E9%80%90%E6%9D%A1%E5%86%99%E5%85%A5%E5%BF%AB"}},[_._v("Bulk API")]),_._v(" | "),t("a",{attrs:{href:"#es-%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%88%86%E9%A1%B5%E6%B7%B1%E5%88%86%E9%A1%B5%E6%9C%89%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98%E5%A6%82%E4%BD%95%E4%BC%98%E5%8C%96"}},[_._v("åˆ†é¡µæœºåˆ¶")])]),_._v(" "),t("li",[t("strong",[_._v("èšåˆåˆ†æ")]),_._v("ï¼š"),t("a",{attrs:{href:"#es-%E7%9A%84%E8%81%9A%E5%90%88aggregation%E6%98%AF%E4%BB%80%E4%B9%88%E5%B8%B8%E8%A7%81%E8%81%9A%E5%90%88%E7%B1%BB%E5%9E%8B"}},[_._v("èšåˆç±»å‹")]),_._v(" | "),t("a",{attrs:{href:"#%E4%BB%80%E4%B9%88%E6%98%AF-parent-child-%E5%85%B3%E7%B3%BB%E5%92%8C-nested-%E7%B1%BB%E5%9E%8B"}},[_._v("æ•°æ®å…³è”")])]),_._v(" "),t("li",[t("strong",[_._v("è„šæœ¬æŸ¥è¯¢")]),_._v("ï¼š"),t("a",{attrs:{href:"#es-%E7%9A%84%E8%84%9A%E6%9C%AC%E6%9F%A5%E8%AF%A2painless-script%E6%98%AF%E4%BB%80%E4%B9%88"}},[_._v("Painlessè„šæœ¬")])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-ä»€ä¹ˆæ˜¯-routing-å¦‚ä½•å½±å“æŸ¥è¯¢å’Œå†™å…¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-ä»€ä¹ˆæ˜¯-routing-å¦‚ä½•å½±å“æŸ¥è¯¢å’Œå†™å…¥"}},[_._v("#")]),_._v(" ğŸ¯ ä»€ä¹ˆæ˜¯ Routingï¼Ÿå¦‚ä½•å½±å“æŸ¥è¯¢å’Œå†™å…¥ï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[t("strong",[_._v("Routing å®šä¹‰")]),_._v("ï¼šRouting æ˜¯æ–‡æ¡£åˆ°åˆ†ç‰‡çš„è·¯ç”±æœºåˆ¶ï¼Œå†³å®šæ–‡æ¡£å†™åœ¨å“ªä¸ªåˆ†ç‰‡ä¸Šã€‚")]),_._v(" "),t("p",[t("strong",[_._v("å†™å…¥å½±å“")]),_._v("ï¼šå†™å…¥æ—¶é€šè¿‡ "),t("code",[_._v("hash(routing) % åˆ†ç‰‡æ•°")]),_._v(" å†³å®šç›®æ ‡åˆ†ç‰‡ï¼Œé»˜è®¤ routing å€¼æ˜¯ "),t("code",[_._v("_id")]),_._v("ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰ã€‚")]),_._v(" "),t("p",[t("strong",[_._v("æŸ¥è¯¢å½±å“")]),_._v("ï¼šå¦‚æœä¸æŒ‡å®š routingï¼Œéœ€è¦åœ¨æ‰€æœ‰åˆ†ç‰‡ä¸Š scatter & gather æŸ¥è¯¢ï¼›å¦‚æœæŒ‡å®š routingï¼Œå¯ä»¥ç›´æ¥è·¯ç”±åˆ°ç›®æ ‡åˆ†ç‰‡ï¼Œæ€§èƒ½æ›´é«˜ã€‚")]),_._v(" "),t("p",[t("strong",[_._v("åº”ç”¨åœºæ™¯")]),_._v("ï¼šå¤šç§Ÿæˆ·ã€ç”¨æˆ·æ•°æ®ã€è®¢å•ç­‰éœ€è¦æŒ‰é€»è¾‘åˆ†ç»„çš„åœºæ™¯ã€‚")])]),_._v(" "),t("p",[_._v("Routingï¼ˆè·¯ç”±ï¼‰æ˜¯ "),t("strong",[_._v("å†³å®šæ–‡æ¡£åº”è¯¥å­˜å‚¨åˆ°å“ªä¸ªåˆ†ç‰‡ï¼ˆShardï¼‰")]),_._v(" çš„æœºåˆ¶ã€‚")]),_._v(" "),t("ul",[t("li",[_._v("åœ¨ ES ä¸­ï¼Œä¸€ä¸ªç´¢å¼•ä¼šè¢«åˆ†æˆå¤šä¸ªä¸»åˆ†ç‰‡ï¼ˆPrimary Shardï¼‰ã€‚")]),_._v(" "),t("li",[_._v("å½“ä½ å†™å…¥ä¸€ä¸ªæ–‡æ¡£æ—¶ï¼ŒES å¿…é¡»å†³å®šå®ƒè½åœ¨å“ªä¸ªä¸»åˆ†ç‰‡ã€‚")]),_._v(" "),t("li",[_._v("Routing çš„ä½œç”¨å°±æ˜¯åšè¿™ä¸ªæ˜ å°„ã€‚")])]),_._v(" "),t("p",[_._v("é»˜è®¤æƒ…å†µä¸‹ï¼š")]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v("shard = hash(_routing) % number_of_primary_shards\n")])])]),t("p",[_._v("å…¶ä¸­ï¼š")]),_._v(" "),t("ul",[t("li",[t("code",[_._v("_routing")]),_._v(" é»˜è®¤å€¼æ˜¯æ–‡æ¡£çš„ "),t("code",[_._v("_id")]),_._v("ï¼›")]),_._v(" "),t("li",[_._v("ä¹Ÿå¯ä»¥æ˜¾å¼æŒ‡å®š "),t("code",[_._v("_routing")]),_._v(" å­—æ®µï¼Œå½±å“æ–‡æ¡£çš„åˆ†ç‰‡å½’å±ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("Routing åœ¨ å†™å…¥ æ—¶çš„å½±å“")])]),_._v(" "),t("ol",[t("li",[t("p",[t("strong",[_._v("å†³å®šåˆ†ç‰‡ä½ç½®")])]),_._v(" "),t("ul",[t("li",[_._v("å½“å†™å…¥æ–‡æ¡£æ—¶ï¼ŒES æ ¹æ® "),t("code",[_._v("_routing")]),_._v(" å€¼ï¼ˆé»˜è®¤ "),t("code",[_._v("_id")]),_._v("ï¼‰è®¡ç®—å‡ºç›®æ ‡åˆ†ç‰‡ã€‚")]),_._v(" "),t("li",[_._v("æ–‡æ¡£åªä¼šè¢«å†™å…¥åˆ°ä¸€ä¸ªä¸»åˆ†ç‰‡ï¼ˆä»¥åŠå®ƒçš„å‰¯æœ¬åˆ†ç‰‡ï¼‰ã€‚")])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("è‡ªå®šä¹‰ routing")])]),_._v(" "),t("ul",[t("li",[_._v("å¯ä»¥åœ¨å†™å…¥æ—¶æŒ‡å®šä¸€ä¸ª routing å€¼ï¼Œæ¯”å¦‚ç”¨æˆ· IDã€‚")]),_._v(" "),t("li",[_._v("æ‰€æœ‰ç›¸åŒ routing å€¼çš„æ–‡æ¡£ä¼šè½åˆ°åŒä¸€ä¸ªåˆ†ç‰‡é‡Œã€‚")]),_._v(" "),t("li",[_._v("å¥½å¤„ï¼šæŸ¥è¯¢æ—¶é¿å…è·¨åˆ†ç‰‡ scatter/gatherï¼Œæ€§èƒ½æ›´é«˜ã€‚")])]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[_._v("PUT /orders/_doc/"),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("1")]),_._v("?routing=user123\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"order_id"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"user"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"user123"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"amount"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("100")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])])])]),_._v(" "),t("p",[_._v("â€‹\tè¿™æ¡è®¢å•æ–‡æ¡£ä¼šæ ¹æ® "),t("code",[_._v('"user123"')]),_._v(" çš„ hash å€¼ï¼Œè½åˆ°æŸä¸ªå›ºå®šåˆ†ç‰‡ä¸Šã€‚")]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("Routing åœ¨ æŸ¥è¯¢ æ—¶çš„å½±å“")])]),_._v(" "),t("ol",[t("li",[t("p",[t("strong",[_._v("é»˜è®¤æƒ…å†µ")])]),_._v(" "),t("ul",[t("li",[_._v("å¦‚æœä¸æŒ‡å®š routingï¼ŒæŸ¥è¯¢ä¼šå¹¿æ’­åˆ°ç´¢å¼•çš„æ‰€æœ‰åˆ†ç‰‡ï¼Œå†åˆå¹¶ç»“æœã€‚")]),_._v(" "),t("li",[_._v("è¿™ç§ "),t("strong",[_._v("scatter & gather")]),_._v(" æŸ¥è¯¢åœ¨åˆ†ç‰‡å¾ˆå¤šæ—¶æ€§èƒ½ä¼šä¸‹é™ã€‚")])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("æŒ‡å®š routing")])]),_._v(" "),t("ul",[t("li",[_._v("å¦‚æœä½ çŸ¥é“æ–‡æ¡£çš„ routing å€¼ï¼Œå¯ä»¥åœ¨æŸ¥è¯¢æ—¶åŠ ä¸Š "),t("code",[_._v("routing")]),_._v(" å‚æ•°ã€‚")]),_._v(" "),t("li",[_._v("ES å°±åªä¼šå»é‚£ä¸ªåˆ†ç‰‡æŸ¥ï¼Œå¤§å¤§å‡å°‘åˆ†ç‰‡é—´çš„æŸ¥è¯¢å¼€é”€ã€‚")])]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[_._v("GET /orders/_search?routing=user123\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"query"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"term"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"user"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"user123"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])])])]),_._v(" "),t("p",[_._v("â€‹\tè¿™é‡Œçš„æŸ¥è¯¢åªä¼šåœ¨å­˜æ”¾ "),t("code",[_._v("user123")]),_._v(" æ–‡æ¡£çš„åˆ†ç‰‡ä¸Šæ‰§è¡Œï¼Œè€Œä¸æ˜¯å…¨ç´¢å¼•æœç´¢ã€‚")]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("æ³¨æ„ç‚¹")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("ç´¢å¼•æ—¶ routing å€¼å¿…é¡»å’ŒæŸ¥è¯¢æ—¶ä¸€è‡´")]),_._v("ï¼š\nå¦‚æœå†™å…¥æ—¶ç”¨äº† routingï¼ŒæŸ¥è¯¢æ—¶ä¹Ÿå¿…é¡»å¸¦ä¸Šç›¸åŒçš„ routingï¼Œå¦åˆ™æŸ¥ä¸åˆ°ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("åˆ†ç‰‡æ•°å›ºå®š")]),_._v("ï¼š\nrouting æ˜¯åŸºäºåˆ†ç‰‡æ•°å–æ¨¡è®¡ç®—çš„ï¼Œå› æ­¤åˆ†ç‰‡æ•°ä¸€æ—¦ç¡®å®šå°±ä¸èƒ½æ›´æ”¹ï¼Œå¦åˆ™è·¯ç”±ä¼šå¤±æ•ˆã€‚")]),_._v(" "),t("li",[t("strong",[_._v("é€‚åˆåœºæ™¯")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("ç”µå•†è®¢å•ï¼šç”¨ç”¨æˆ· ID åš routingï¼Œå¯ä»¥æŠŠä¸€ä¸ªç”¨æˆ·çš„æ‰€æœ‰è®¢å•æ”¾åœ¨åŒä¸€ä¸ªåˆ†ç‰‡é‡Œã€‚")]),_._v(" "),t("li",[_._v("å¤šç§Ÿæˆ·ç³»ç»Ÿï¼šç”¨ç§Ÿæˆ· ID åš routingï¼ŒæŠŠä¸åŒç§Ÿæˆ·æ•°æ®éš”ç¦»ã€‚")])])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-es-å¦‚ä½•å®ç°é«˜å¯ç”¨"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-å¦‚ä½•å®ç°é«˜å¯ç”¨"}},[_._v("#")]),_._v(" ğŸ¯ ES å¦‚ä½•å®ç°é«˜å¯ç”¨ï¼Ÿ")]),_._v(" "),t("blockquote",[t("ul",[t("li",[t("strong",[_._v("ES é«˜å¯ç”¨ä¾èµ–åˆ†ç‰‡å’Œå‰¯æœ¬æœºåˆ¶")]),_._v("ï¼Œä¸»åˆ†ç‰‡è´Ÿè´£å†™å…¥ï¼Œå‰¯æœ¬åˆ†ç‰‡ä¿è¯æ•°æ®å†—ä½™å’Œè¯»æ‰©å±•ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("Master èŠ‚ç‚¹")]),_._v("è´Ÿè´£é›†ç¾¤ç®¡ç†ï¼Œé€šè¿‡é€‰ä¸»æœºåˆ¶ä¿è¯ç¨³å®šè¿è¡Œã€‚")]),_._v(" "),t("li",[t("strong",[_._v("è‡ªåŠ¨æ•…éšœè½¬ç§»")]),_._v("ï¼šä¸»åˆ†ç‰‡å®•æœºæ—¶ï¼Œå‰¯æœ¬åˆ†ç‰‡è‡ªåŠ¨æå‡ä¸ºä¸»åˆ†ç‰‡ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ç”Ÿäº§å®è·µ")]),_._v("ï¼šå¤šèŠ‚ç‚¹éƒ¨ç½²ï¼ˆè‡³å°‘ 3 ä¸ª Masterï¼‰ï¼Œæ¯ä¸ªä¸»åˆ†ç‰‡è‡³å°‘ 1 ä¸ªå‰¯æœ¬ï¼Œé…åˆè·¨é›†ç¾¤å¤åˆ¶/å¿«ç…§å®ç°å®¹ç¾ã€‚")])])]),_._v(" "),t("p",[_._v("Elasticsearchï¼ˆESï¼‰çš„é«˜å¯ç”¨æ€§ä¸»è¦ä½“ç°åœ¨ "),t("strong",[_._v("é›†ç¾¤å±‚é¢")]),_._v("ï¼Œé€šè¿‡åˆ†ç‰‡ã€å‰¯æœ¬ã€å‰¯æœ¬è‡ªåŠ¨åˆ‡æ¢ã€é›†ç¾¤é€‰ä¸»ç­‰æœºåˆ¶æ¥ä¿è¯åœ¨èŠ‚ç‚¹æ•…éšœæ—¶ç³»ç»Ÿä»èƒ½æä¾›æœåŠ¡ã€‚")]),_._v(" "),t("p",[t("strong",[_._v("1ã€æ ¸å¿ƒæœºåˆ¶")])]),_._v(" "),t("p",[t("strong",[_._v("åˆ†ç‰‡ï¼ˆShardï¼‰")])]),_._v(" "),t("ul",[t("li",[_._v("æ¯ä¸ªç´¢å¼•çš„æ•°æ®è¢«æ‹†åˆ†ä¸ºå¤šä¸ª "),t("strong",[_._v("ä¸»åˆ†ç‰‡ï¼ˆPrimary Shardï¼‰")]),_._v("ã€‚")]),_._v(" "),t("li",[_._v("åˆ†ç‰‡åˆ†å¸ƒåœ¨ä¸åŒèŠ‚ç‚¹ä¸Šï¼Œé¿å…å•èŠ‚ç‚¹æˆä¸ºç“¶é¢ˆã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("å‰¯æœ¬ï¼ˆReplicaï¼‰")])]),_._v(" "),t("ul",[t("li",[_._v("æ¯ä¸ªä¸»åˆ†ç‰‡å¯ä»¥é…ç½®å¤šä¸ªå‰¯æœ¬åˆ†ç‰‡ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ä½œç”¨")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("å®¹é”™ï¼šå½“ä¸»åˆ†ç‰‡æ‰€åœ¨èŠ‚ç‚¹å®•æœºæ—¶ï¼Œå‰¯æœ¬å¯ä»¥å‡çº§ä¸ºä¸»åˆ†ç‰‡ï¼›")]),_._v(" "),t("li",[_._v("è¯»æ‰©å±•ï¼šæŸ¥è¯¢å¯ä»¥åœ¨å‰¯æœ¬åˆ†ç‰‡ä¸Šæ‰§è¡Œï¼Œæé«˜å¹¶å‘æŸ¥è¯¢èƒ½åŠ›ã€‚")])])])]),_._v(" "),t("p",[t("strong",[_._v("è‡ªåŠ¨æ•…éšœè½¬ç§»")])]),_._v(" "),t("ul",[t("li",[_._v("å¦‚æœæŸä¸ªèŠ‚ç‚¹å®•æœºå¯¼è‡´ä¸»åˆ†ç‰‡ä¸å¯ç”¨ï¼ŒES ä¼šè‡ªåŠ¨ä»å‰¯æœ¬ä¸­é€‰ä¸€ä¸ªæå‡ä¸ºä¸»åˆ†ç‰‡ã€‚")]),_._v(" "),t("li",[_._v("ç¡®ä¿ç´¢å¼•å§‹ç»ˆä¿æŒè¯»å†™å¯ç”¨ã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("Master èŠ‚ç‚¹")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("Master èŠ‚ç‚¹")]),_._v("è´Ÿè´£ç»´æŠ¤é›†ç¾¤çŠ¶æ€ï¼ˆåˆ†ç‰‡åˆ†é…ã€èŠ‚ç‚¹ç®¡ç†ï¼‰ã€‚")]),_._v(" "),t("li",[_._v("é€šè¿‡ "),t("strong",[_._v("Zen Discovery")]),_._v(" æˆ–åŸºäº "),t("strong",[_._v("Raft")]),_._v("ï¼ˆ8.0 ä¹‹åå¼•å…¥ï¼‰é€‰ä¸»æœºåˆ¶ï¼Œä¿è¯é›†ç¾¤æœ‰ä¸€ä¸ªå¥åº·çš„ Masterã€‚")]),_._v(" "),t("li",[_._v("å»ºè®®éƒ¨ç½² "),t("strong",[_._v("3 ä¸ªæˆ–ä»¥ä¸Š Master èŠ‚ç‚¹")]),_._v("ï¼Œé¿å…è„‘è£‚ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("2ã€é«˜å¯ç”¨çš„å®ç°æ‰‹æ®µ")])]),_._v(" "),t("ol",[t("li",[t("p",[t("strong",[_._v("å¤šèŠ‚ç‚¹éƒ¨ç½²")])]),_._v(" "),t("ul",[t("li",[_._v("è‡³å°‘ 3 ä¸ªèŠ‚ç‚¹ï¼š1 ä¸ª Master + 2 ä¸ª Dataã€‚")]),_._v(" "),t("li",[_._v("ç”Ÿäº§ç¯å¢ƒæ¨èï¼š3 ä¸ª Masterï¼ˆä»…åšé›†ç¾¤ç®¡ç†ï¼‰+ å¤šä¸ª Data èŠ‚ç‚¹ï¼ˆå­˜å‚¨å’ŒæŸ¥è¯¢ï¼‰ã€‚")])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("å‰¯æœ¬æœºåˆ¶")])]),_._v(" "),t("ul",[t("li",[_._v("æ¯ä¸ªä¸»åˆ†ç‰‡è‡³å°‘é…ç½® 1 ä¸ªå‰¯æœ¬ï¼Œä¿è¯èŠ‚ç‚¹æ•…éšœæ—¶æ•°æ®ä¸ä¸¢å¤±ã€‚")]),_._v(" "),t("li",[_._v("ä¸»åˆ†ç‰‡å’Œå‰¯æœ¬åˆ†ç‰‡ä¸ä¼šåˆ†é…åœ¨åŒä¸€èŠ‚ç‚¹ã€‚")])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("åˆ†ç‰‡é‡å¹³è¡¡")])]),_._v(" "),t("ul",[t("li",[_._v("èŠ‚ç‚¹æ–°å¢/å®•æœºæ—¶ï¼ŒES ä¼šè‡ªåŠ¨å°†åˆ†ç‰‡é‡æ–°åˆ†é…ï¼ˆShards Reallocationï¼‰ï¼Œä¿è¯è´Ÿè½½å‡è¡¡ã€‚")])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("å†™å…¥ç¡®è®¤æœºåˆ¶")])]),_._v(" "),t("ul",[t("li",[_._v("ES åœ¨å†™å…¥æ—¶ä¼šç­‰å¾…ä¸»åˆ†ç‰‡å’Œå‰¯æœ¬åˆ†ç‰‡éƒ½ç¡®è®¤æˆåŠŸï¼ˆå¯é…ç½® "),t("code",[_._v("acks=all")]),_._v("ï¼‰ï¼Œä¿è¯æ•°æ®å®‰å…¨ã€‚")])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("è·¨æœºæˆ¿/è·¨é›†ç¾¤å®¹ç¾")])]),_._v(" "),t("ul",[t("li",[_._v("ä½¿ç”¨ "),t("strong",[_._v("è·¨é›†ç¾¤å¤åˆ¶ï¼ˆCCR, Cross-Cluster Replicationï¼‰")]),_._v(" å°†ç´¢å¼•å®æ—¶åŒæ­¥åˆ°å¦ä¸€ä¸ªé›†ç¾¤ï¼Œä¿è¯å¼‚åœ°å®¹ç¾ã€‚")]),_._v(" "),t("li",[_._v("æˆ–è€…ä½¿ç”¨ "),t("strong",[_._v("å¿«ç…§ï¼ˆSnapshot & Restoreï¼‰")]),_._v(" å°†ç´¢å¼•æ•°æ®å®šæœŸå¤‡ä»½åˆ°è¿œç¨‹å­˜å‚¨ï¼ˆå¦‚ S3ã€HDFSï¼‰ã€‚")])])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-es-çš„æ‰¹é‡æ“ä½œ-bulk-api-æ€ä¹ˆç”¨-ä¸ºä»€ä¹ˆæ¯”é€æ¡å†™å…¥å¿«"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-çš„æ‰¹é‡æ“ä½œ-bulk-api-æ€ä¹ˆç”¨-ä¸ºä»€ä¹ˆæ¯”é€æ¡å†™å…¥å¿«"}},[_._v("#")]),_._v(" ğŸ¯ ES çš„æ‰¹é‡æ“ä½œï¼ˆBulk APIï¼‰æ€ä¹ˆç”¨ï¼Ÿä¸ºä»€ä¹ˆæ¯”é€æ¡å†™å…¥å¿«ï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[t("strong",[_._v("Bulk API æ˜¯æ‰¹é‡å†™å…¥æ¥å£")]),_._v("ï¼Œé€šè¿‡åœ¨ä¸€æ¬¡è¯·æ±‚ä¸­æäº¤å¤šæ¡å†™æ“ä½œï¼Œå‡å°‘äº†ç½‘ç»œäº¤äº’å’Œåˆ†ç‰‡è·¯ç”±å¼€é”€ã€‚")]),_._v(" "),t("p",[t("strong",[_._v("æ€§èƒ½æå‡çš„åŸå› ")]),_._v("ï¼š")]),_._v(" "),t("ol",[t("li",[_._v("å‡å°‘ç½‘ç»œè¯·æ±‚æ¬¡æ•°ï¼›")]),_._v(" "),t("li",[_._v("æŒ‰åˆ†ç‰‡åˆ†ç»„æ‰¹é‡å†™å…¥ï¼Œé™ä½è·¯ç”±è®¡ç®—å¼€é”€ï¼›")]),_._v(" "),t("li",[_._v("æ‰¹é‡å†™å…¥ç£ç›˜ï¼Œå‡å°‘ fsync æ¬¡æ•°ã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("å®è·µå»ºè®®")]),_._v("ï¼šæ§åˆ¶è¯·æ±‚å¤§å°ï¼ˆ5~15MBï¼‰ã€åˆ†æ‰¹å¤„ç†ã€ä½¿ç”¨ BulkProcessor è‡ªåŠ¨ç®¡ç†æ‰¹é‡è¯·æ±‚ï¼Œå¹¶å¤„ç†é”™è¯¯é‡è¯•ã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("ä»€ä¹ˆæ˜¯ Bulk APIï¼Ÿ")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("Bulk API")]),_._v(" æ˜¯ Elasticsearch æä¾›çš„ "),t("strong",[_._v("æ‰¹é‡å†™å…¥/æ›´æ–°/åˆ é™¤æ–‡æ¡£")]),_._v(" çš„æ¥å£ã€‚")]),_._v(" "),t("li",[_._v("å¯ä»¥åœ¨ä¸€ä¸ªè¯·æ±‚ä¸­åŒæ—¶æ‰§è¡Œå¤šæ¡å†™æ“ä½œï¼Œè€Œä¸æ˜¯é€æ¡å‘è¯·æ±‚ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("Bulk API çš„è¯·æ±‚æ ¼å¼")])]),_._v(" "),t("p",[_._v("Bulk è¯·æ±‚æ˜¯ "),t("strong",[_._v("NDJSONï¼ˆæ¢è¡Œåˆ†éš” JSONï¼‰")]),_._v(" æ ¼å¼ï¼Œç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š")]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("åŠ¨ä½œè¡Œ")]),_._v("ï¼šæŒ‡å®šæ“ä½œç±»å‹ï¼ˆindexã€createã€updateã€deleteï¼‰ã€ç›®æ ‡ç´¢å¼•ã€æ–‡æ¡£ "),t("code",[_._v("_id")]),_._v(" ç­‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("æ•°æ®è¡Œ")]),_._v("ï¼šå®é™…çš„æ–‡æ¡£å†…å®¹ï¼ˆä»…åœ¨ index/create/update æ—¶éœ€è¦ï¼‰ã€‚")])]),_._v(" "),t("p",[_._v("ç¤ºä¾‹ï¼š")]),_._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[_._v("POST /my_index/_bulk\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"index"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"_id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"1"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"title"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"Elasticsearch å…¥é—¨"')]),_._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"author"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"Tom"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"index"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"_id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"2"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"title"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"Elasticsearch è¿›é˜¶"')]),_._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"author"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"Jerry"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"delete"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"_id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"3"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])]),t("p",[t("strong",[_._v("ä¸ºä»€ä¹ˆ Bulk API æ¯”é€æ¡å†™å…¥å¿«ï¼Ÿ")])]),_._v(" "),t("p",[_._v("ï¼ˆ1ï¼‰å‡å°‘ç½‘ç»œå¼€é”€")]),_._v(" "),t("ul",[t("li",[_._v("é€æ¡å†™å…¥ï¼šæ¯ä¸ªæ–‡æ¡£ä¸€æ¬¡ HTTP è¯·æ±‚ï¼Œç½‘ç»œå¼€é”€å¤§ã€‚")]),_._v(" "),t("li",[_._v("æ‰¹é‡å†™å…¥ï¼šå¤šä¸ªæ“ä½œåˆå¹¶ä¸ºä¸€æ¬¡è¯·æ±‚ï¼Œ"),t("strong",[_._v("é™ä½ TCP/HTTP æ¡æ‰‹å’Œåºåˆ—åŒ–æˆæœ¬")]),_._v("ã€‚")])]),_._v(" "),t("p",[_._v("ï¼ˆ2ï¼‰ä¼˜åŒ–åˆ†ç‰‡è·¯ç”±")]),_._v(" "),t("ul",[t("li",[_._v("æ¯æ¬¡å†™å…¥æ—¶ï¼ŒES éƒ½è¦é€šè¿‡ "),t("code",[_._v("hash(_routing) % åˆ†ç‰‡æ•°")]),_._v(" å®šä½åˆ†ç‰‡ã€‚")]),_._v(" "),t("li",[_._v("Bulk API ä¼šå…ˆè§£ææ‰€æœ‰æ–‡æ¡£çš„ç›®æ ‡åˆ†ç‰‡ï¼Œç„¶åæŒ‰åˆ†ç‰‡åˆ†ç»„æ‰¹é‡å‘é€ç»™å¯¹åº”èŠ‚ç‚¹ï¼Œ"),t("strong",[_._v("é¿å…é¢‘ç¹çš„åˆ†ç‰‡è·¯ç”±å¼€é”€")]),_._v("ã€‚")])]),_._v(" "),t("p",[_._v("ï¼ˆ3ï¼‰å¹¶è¡Œå†™å…¥ä¼˜åŒ–")]),_._v(" "),t("ul",[t("li",[_._v("åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šï¼ŒBulk æ“ä½œä¼šå°†æ•°æ®æ‰¹é‡å†™å…¥ "),t("strong",[_._v("å†…å­˜ buffer â†’ translog â†’ segment")]),_._v("ï¼Œå‡å°‘ç£ç›˜ IOã€‚")]),_._v(" "),t("li",[_._v("ç›¸æ¯”é€æ¡å†™å…¥ï¼Œç£ç›˜ fsync æ¬¡æ•°æ›´å°‘ï¼Œ"),t("strong",[_._v("å†™å…¥æ•ˆç‡æ˜¾è‘—æå‡")]),_._v("ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("ä½¿ç”¨ Bulk çš„æœ€ä½³å®è·µ")])]),_._v(" "),t("ol",[t("li",[t("p",[t("strong",[_._v("æ§åˆ¶å•æ¬¡è¯·æ±‚å¤§å°")])]),_._v(" "),t("ul",[t("li",[_._v("å®˜æ–¹å»ºè®®ï¼šæ¯æ¬¡ bulk è¯·æ±‚å¤§å°æ§åˆ¶åœ¨ "),t("strong",[_._v("5~15 MB")]),_._v("ï¼Œé¿å…è¯·æ±‚è¿‡å¤§å¯¼è‡´ OOM æˆ– GC å‹åŠ›ã€‚")]),_._v(" "),t("li",[_._v("æ‰¹é‡æ¡æ•°ï¼šé€šå¸¸ 1000~5000 æ¡ä¸€æ‰¹ï¼Œå…·ä½“å–å†³äºæ–‡æ¡£å¤§å°ã€‚")])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("ç»“åˆæ‰¹å¤„ç†å·¥å…·")])]),_._v(" "),t("ul",[t("li",[_._v("Logstashã€Beatsã€ES-Hadoop ç­‰å·¥å…·éƒ½æ”¯æŒ Bulk å†™å…¥ã€‚")]),_._v(" "),t("li",[_._v("Java å®¢æˆ·ç«¯æœ‰ "),t("code",[_._v("BulkProcessor")]),_._v("ï¼Œå¯è‡ªåŠ¨æ‰¹é‡èšåˆè¯·æ±‚ã€‚")])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("é”™è¯¯å¤„ç†")])]),_._v(" "),t("ul",[t("li",[_._v("Bulk æ˜¯â€œéƒ¨åˆ†æˆåŠŸâ€çš„ï¼šéƒ¨åˆ†æ–‡æ¡£å¯èƒ½å†™å…¥å¤±è´¥ï¼Œéœ€è¦æ£€æŸ¥è¿”å›ç»“æœä¸­çš„ "),t("code",[_._v("errors")]),_._v(" å­—æ®µå¹¶é‡è¯•ã€‚")])])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-es-å¦‚ä½•å®ç°åˆ†é¡µ-æ·±åˆ†é¡µæœ‰ä»€ä¹ˆé—®é¢˜-å¦‚ä½•ä¼˜åŒ–-scrollã€search-after"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-å¦‚ä½•å®ç°åˆ†é¡µ-æ·±åˆ†é¡µæœ‰ä»€ä¹ˆé—®é¢˜-å¦‚ä½•ä¼˜åŒ–-scrollã€search-after"}},[_._v("#")]),_._v(" ğŸ¯ ES å¦‚ä½•å®ç°åˆ†é¡µï¼Ÿæ·±åˆ†é¡µæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿå¦‚ä½•ä¼˜åŒ–ï¼Ÿï¼ˆscrollã€search_afterï¼‰")]),_._v(" "),t("blockquote",[t("ul",[t("li",[_._v("ES åˆ†é¡µé€šè¿‡ "),t("code",[_._v("from + size")]),_._v(" å®ç°ï¼Œä½†æ·±åˆ†é¡µä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› ä¸º ES å¿…é¡»æ‰«æå¹¶æ’åºå¤§é‡æ–‡æ¡£ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ä¼˜åŒ–æ–¹æ¡ˆ")]),_._v("ï¼š\n"),t("ol",[t("li",[t("strong",[_._v("Scroll API")]),_._v(" â€”â€” é€‚åˆå…¨é‡æ•°æ®å¯¼å‡ºï¼Œä¸é€‚åˆå®æ—¶åˆ†é¡µã€‚")]),_._v(" "),t("li",[t("strong",[_._v("search_after")]),_._v(" â€”â€” åŸºäºæ¸¸æ ‡çš„æ–¹å¼ï¼Œé€‚åˆå®æ—¶æ— é™æ»šåŠ¨ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("PIT + search_after")]),_._v(" â€”â€” æ–°ç‰ˆæœ¬ä¸­æ¨èçš„åˆ†é¡µæ–¹å¼ï¼Œæ—¢é«˜æ•ˆåˆä¿è¯ä¸€è‡´æ€§ã€‚")])])]),_._v(" "),t("li",[_._v("æœ€ä½³å®è·µï¼šé¿å…æ·±åˆ†é¡µï¼Œæ›´å¤šä½¿ç”¨â€œæ»šåŠ¨åŠ è½½â€è€Œä¸æ˜¯â€œè·³é¡µâ€ã€‚")])])]),_._v(" "),t("p",[t("strong",[_._v("ES å¦‚ä½•å®ç°åˆ†é¡µï¼Ÿ")])]),_._v(" "),t("p",[_._v("Elasticsearch é»˜è®¤æä¾›ç±»ä¼¼ SQL çš„åˆ†é¡µè¯­æ³•ï¼š")]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[_._v("GET /my_index/_search\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"from"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"size"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("10")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])]),t("ul",[t("li",[t("code",[_._v("from")]),_._v("ï¼šè·³è¿‡çš„æ–‡æ¡£æ•°ï¼ˆåç§»é‡ï¼‰ã€‚")]),_._v(" "),t("li",[t("code",[_._v("size")]),_._v("ï¼šè¿”å›çš„æ–‡æ¡£æ•°ã€‚")]),_._v(" "),t("li",[_._v("ä¾‹å­ï¼š"),t("code",[_._v("from=0, size=10")]),_._v(" è¡¨ç¤ºè¿”å›å‰ 10 æ¡ï¼›"),t("code",[_._v("from=100, size=10")]),_._v(" è¡¨ç¤ºè¿”å›ç¬¬ 101~110 æ¡ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("æ·±åˆ†é¡µé—®é¢˜")])]),_._v(" "),t("p",[_._v("å½“ä½¿ç”¨è¾ƒå¤§ "),t("code",[_._v("from")]),_._v(" å€¼æ—¶ï¼ˆä¾‹å¦‚ "),t("code",[_._v("from=100000")]),_._v("ï¼‰ï¼Œä¼šå¸¦æ¥æ€§èƒ½é—®é¢˜ï¼š")]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("æ•°æ®æ‰«æå¼€é”€å¤§")]),_._v("ï¼šES éœ€è¦å…ˆæ”¶é›† "),t("code",[_._v("from + size")]),_._v(" æ¡æ–‡æ¡£ï¼Œå†ä¸¢å¼ƒå‰ "),t("code",[_._v("from")]),_._v(" æ¡ã€‚\n"),t("ul",[t("li",[_._v("å‡è®¾ "),t("code",[_._v("from=100000, size=10")]),_._v("ï¼Œå®é™…ä¸Š ES ä¼šæ‹‰å– "),t("strong",[_._v("100010 æ¡")]),_._v("ï¼Œå†åªè¿”å›æœ€å 10 æ¡ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("å†…å­˜ä¸ CPU æ¶ˆè€—é«˜")]),_._v("ï¼šæ‰€æœ‰å€™é€‰æ–‡æ¡£æ’åºåå†ä¸¢å¼ƒï¼Œè€—è´¹å¤§é‡å †å†…å­˜ï¼ˆä¼˜å…ˆé˜Ÿåˆ—ç»´æŠ¤ topNï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("å“åº”å»¶è¿Ÿå¤§")]),_._v("ï¼šæ·±åˆ†é¡µè¯·æ±‚å¯èƒ½å¯¼è‡´æŸ¥è¯¢éå¸¸æ…¢ï¼Œç”šè‡³å¼•å‘é›†ç¾¤æ€§èƒ½ä¸‹é™ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("æ·±åˆ†é¡µä¼˜åŒ–æ–¹æ¡ˆ")])]),_._v(" "),t("p",[_._v("ï¼ˆ1ï¼‰Scroll API â€”â€” å¤§æ•°æ®é‡å…¨é‡éå†")]),_._v(" "),t("ul",[t("li",[t("p",[t("strong",[_._v("é€‚ç”¨åœºæ™¯")]),_._v("ï¼šå¯¼å‡ºã€æ•°æ®è¿ç§»ã€ç¦»çº¿è®¡ç®—ã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("åŸç†")]),_._v("ï¼šä¿æŒä¸€ä¸ªå¿«ç…§ä¸Šä¸‹æ–‡ï¼Œæ¸¸æ ‡å¼æ‰¹é‡æ‹‰å–æ•°æ®ã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("ç‰¹ç‚¹")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("é€‚åˆéå† "),t("strong",[_._v("å…¨éƒ¨æ•°æ®")]),_._v("ï¼Œä¸é€‚åˆç”¨æˆ·å®æ—¶åˆ†é¡µã€‚")]),_._v(" "),t("li",[_._v("å¿«ç…§ä¼šæ¶ˆè€—èµ„æºï¼Œé•¿æ—¶é—´ä¿æŒ scroll ä¸æ¨èã€‚")])])]),_._v(" "),t("li",[t("p",[_._v("ç¤ºä¾‹ï¼š")]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v('GET /my_index/_search?scroll=1m\n{\n  "size": 1000,\n  "query": { "match_all": {} }\n}\n')])])])])]),_._v(" "),t("p",[_._v("ï¼ˆ2ï¼‰search_after â€”â€” åŸºäºæ¸¸æ ‡çš„å®æ—¶åˆ†é¡µ")]),_._v(" "),t("ul",[t("li",[t("p",[t("strong",[_._v("é€‚ç”¨åœºæ™¯")]),_._v("ï¼šå®æ—¶åˆ†é¡µã€æ— é™æ»šåŠ¨ï¼ˆç±»ä¼¼å¾®åš/æœ‹å‹åœˆæµå¼ç¿»é¡µï¼‰ã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("åŸç†")]),_._v("ï¼šé€šè¿‡ä¸Šä¸€é¡µæœ€åä¸€æ¡æ–‡æ¡£çš„æ’åºå€¼ï¼Œä½œä¸ºä¸‹ä¸€é¡µçš„èµ·ç‚¹ã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("ç‰¹ç‚¹")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("é¿å… "),t("code",[_._v("from+size")]),_._v(" æ‰«æå¼€é”€ï¼Œä¸ä¼šä¸¢å¼ƒå‰é¢æ–‡æ¡£ã€‚")]),_._v(" "),t("li",[_._v("å¿…é¡»æœ‰ "),t("strong",[_._v("å”¯ä¸€ä¸”ç¨³å®šçš„æ’åºå­—æ®µ")]),_._v("ï¼ˆå¦‚ "),t("code",[_._v("æ—¶é—´æˆ³ + _id")]),_._v("ï¼‰ã€‚")])])]),_._v(" "),t("li",[t("p",[_._v("ç¤ºä¾‹ï¼š")]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v('GET /my_index/_search\n{\n  "size": 10,\n  "query": { "match_all": {} },\n  "sort": [\n    { "timestamp": "asc" },\n    { "_id": "asc" }\n  ],\n  "search_after": ["2025-08-14T12:00:00", "doc_123"]\n}\n')])])])])]),_._v(" "),t("p",[_._v("ï¼ˆ3ï¼‰å…¶ä»–ä¼˜åŒ–æ‰‹æ®µ")]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("é™åˆ¶æœ€å¤§ from")]),_._v("ï¼šé€šè¿‡ "),t("code",[_._v("index.max_result_window")]),_._v("ï¼ˆé»˜è®¤ 10000ï¼‰é™åˆ¶æ·±åˆ†é¡µè¯·æ±‚ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ä½¿ç”¨ Point in Timeï¼ˆPITï¼‰+ search_after")]),_._v("ï¼ˆES 7.10+ï¼‰ï¼š\n"),t("ul",[t("li",[_._v("PIT æä¾›ä¸€è‡´æ€§çš„å¿«ç…§ä¸Šä¸‹æ–‡ï¼Œé…åˆ "),t("code",[_._v("search_after")]),_._v(" å®ç°é«˜æ•ˆã€ç¨³å®šåˆ†é¡µã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("ä¸šåŠ¡å±‚ä¼˜åŒ–")]),_._v("ï¼š\n"),t("ul",[t("li",[t("strong",[_._v("æ¨èâ€œä¸‹æ‹‰åŠ è½½æ›´å¤šâ€è€Œä¸æ˜¯â€œè·³åˆ°ç¬¬ N é¡µâ€")]),_._v("ã€‚")]),_._v(" "),t("li",[_._v("ç¼“å­˜çƒ­ç‚¹é¡µæ•°æ®ï¼Œé¿å…é¢‘ç¹æŸ¥è¯¢æ·±åˆ†é¡µã€‚")])])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-es-çš„èšåˆ-aggregation-æ˜¯ä»€ä¹ˆ-å¸¸è§èšåˆç±»å‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-çš„èšåˆ-aggregation-æ˜¯ä»€ä¹ˆ-å¸¸è§èšåˆç±»å‹"}},[_._v("#")]),_._v(" ğŸ¯ ES çš„èšåˆï¼ˆAggregationï¼‰æ˜¯ä»€ä¹ˆï¼Ÿå¸¸è§èšåˆç±»å‹ï¼Ÿ")]),_._v(" "),t("blockquote",[t("ul",[t("li",[t("strong",[_._v("èšåˆæ˜¯ ES çš„æ•°æ®åˆ†æåŠŸèƒ½ï¼Œç±»ä¼¼ SQL çš„ GROUP BY/èšåˆå‡½æ•°ã€‚")])]),_._v(" "),t("li",[t("strong",[_._v("å¸¸è§ç±»å‹")]),_._v("ï¼š\n"),t("ol",[t("li",[t("strong",[_._v("Metric")]),_._v("ï¼šåº¦é‡ç»Ÿè®¡ï¼ˆavgã€sumã€minã€maxã€cardinalityï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("Bucket")]),_._v("ï¼šåˆ†æ¡¶åˆ†ç»„ï¼ˆtermsã€rangeã€histogramã€date_histogramï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("Pipeline")]),_._v("ï¼šåŸºäºèšåˆç»“æœå†è®¡ç®—ï¼ˆderivativeã€moving_avgã€cumulative_sumï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("Matrix")]),_._v("ï¼šå¤šå­—æ®µçŸ©é˜µè¿ç®—ï¼ˆmatrix_statsï¼‰ã€‚")])])]),_._v(" "),t("li",[_._v("å®é™…åº”ç”¨ï¼šæŠ¥è¡¨ç»Ÿè®¡ã€ç”¨æˆ·è¡Œä¸ºåˆ†æã€æ—¥å¿—åˆ†æç­‰ã€‚")])])]),_._v(" "),t("p",[t("strong",[_._v("ä»€ä¹ˆæ˜¯èšåˆï¼Ÿ")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("èšåˆï¼ˆAggregationï¼‰")]),_._v(" æ˜¯ Elasticsearch æä¾›çš„æ•°æ®åˆ†æåŠŸèƒ½ï¼Œç±»ä¼¼ SQL çš„ "),t("code",[_._v("GROUP BY")]),_._v("ã€"),t("code",[_._v("COUNT")]),_._v("ã€"),t("code",[_._v("SUM")]),_._v("ã€‚")]),_._v(" "),t("li",[_._v("èšåˆå¯ä»¥åœ¨æœç´¢çš„åŒæ—¶ï¼Œå¯¹ç»“æœè¿›è¡Œç»Ÿè®¡ã€åˆ†ç»„ã€è®¡ç®—ï¼Œç”¨äºå®ç°æ•°æ®åˆ†æå’ŒæŠ¥è¡¨ã€‚")]),_._v(" "),t("li",[_._v("æŸ¥è¯¢ç»“æœåŒ…å«ä¸¤éƒ¨åˆ†ï¼š\n"),t("ol",[t("li",[t("strong",[_._v("hits")]),_._v("ï¼šåŒ¹é…çš„æ–‡æ¡£ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("aggregations")]),_._v("ï¼šèšåˆåˆ†æç»“æœã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("èšåˆçš„åˆ†ç±»")])]),_._v(" "),t("p",[_._v("ES èšåˆä¸»è¦åˆ†ä¸ºå››å¤§ç±»ï¼š")]),_._v(" "),t("p",[_._v("ï¼ˆ1ï¼‰Metric Aggregations â€”â€” åº¦é‡èšåˆ")]),_._v(" "),t("p",[_._v("å¯¹å­—æ®µå€¼è¿›è¡Œæ•°å­¦è®¡ç®—ï¼Œå¸¸ç”¨äºæŒ‡æ ‡ç»Ÿè®¡ã€‚")]),_._v(" "),t("ul",[t("li",[t("code",[_._v("min")]),_._v(" / "),t("code",[_._v("max")]),_._v("ï¼šæœ€å°å€¼ã€æœ€å¤§å€¼")]),_._v(" "),t("li",[t("code",[_._v("sum")]),_._v("ï¼šæ±‚å’Œ")]),_._v(" "),t("li",[t("code",[_._v("avg")]),_._v("ï¼šå¹³å‡å€¼")]),_._v(" "),t("li",[t("code",[_._v("stats")]),_._v("ï¼šè¿”å› countã€minã€maxã€avgã€sum")]),_._v(" "),t("li",[t("code",[_._v("extended_stats")]),_._v("ï¼šæ¯” "),t("code",[_._v("stats")]),_._v(" æ›´å¤šï¼ŒåŒ…æ‹¬æ–¹å·®ã€æ ‡å‡†å·®ç­‰")]),_._v(" "),t("li",[t("code",[_._v("cardinality")]),_._v("ï¼šå»é‡è®¡æ•°ï¼ˆç±»ä¼¼ SQL "),t("code",[_._v("COUNT(DISTINCT)")]),_._v("ï¼‰")])]),_._v(" "),t("p",[_._v("ç¤ºä¾‹ï¼š")]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[_._v("GET /sales/_search\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"size"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"aggs"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"avg_price"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"avg"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"field"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"price"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])]),t("p",[_._v("ï¼ˆ2ï¼‰Bucket Aggregations â€”â€” æ¡¶èšåˆ")]),_._v(" "),t("p",[_._v("æŠŠæ–‡æ¡£åˆ†ç»„åˆ°ä¸åŒçš„â€œæ¡¶â€é‡Œï¼Œç±»ä¼¼ SQL çš„ "),t("code",[_._v("GROUP BY")]),_._v("ã€‚")]),_._v(" "),t("ul",[t("li",[t("code",[_._v("terms")]),_._v("ï¼šæŒ‰å­—æ®µå€¼åˆ†ç»„ï¼ˆç±»ä¼¼ "),t("code",[_._v("GROUP BY category")]),_._v("ï¼‰ã€‚")]),_._v(" "),t("li",[t("code",[_._v("range")]),_._v("ï¼šæŒ‰æ•°å€¼èŒƒå›´åˆ†ç»„ï¼ˆå¦‚ 0"),t("s",[_._v("100, 100")]),_._v("200ï¼‰ã€‚")]),_._v(" "),t("li",[t("code",[_._v("date_histogram")]),_._v("ï¼šæŒ‰æ—¶é—´åŒºé—´åˆ†ç»„ï¼ˆæŒ‰å¤©ã€æŒ‰æœˆç»Ÿè®¡ï¼‰ã€‚")]),_._v(" "),t("li",[t("code",[_._v("histogram")]),_._v("ï¼šæŒ‰æ•°å€¼èŒƒå›´åˆ†ç»„ï¼ˆå›ºå®šé—´éš”ï¼‰ã€‚")])]),_._v(" "),t("p",[_._v("ç¤ºä¾‹ï¼š")]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v('GET /sales/_search\n{\n  "size": 0,\n  "aggs": {\n    "sales_by_category": {\n      "terms": { "field": "category.keyword" }\n    }\n  }\n}\n')])])]),t("hr"),_._v(" "),t("p",[_._v("ï¼ˆ3ï¼‰Pipeline Aggregations â€”â€” ç®¡é“èšåˆ")]),_._v(" "),t("p",[_._v("åŸºäºå…¶ä»–èšåˆç»“æœå†æ¬¡è®¡ç®—ï¼Œç±»ä¼¼ SQL çš„çª—å£å‡½æ•°ã€‚")]),_._v(" "),t("ul",[t("li",[t("code",[_._v("derivative")]),_._v("ï¼šæ±‚å¯¼æ•°ï¼ˆè¶‹åŠ¿å˜åŒ–ï¼‰ã€‚")]),_._v(" "),t("li",[t("code",[_._v("moving_avg")]),_._v("ï¼šç§»åŠ¨å¹³å‡ã€‚")]),_._v(" "),t("li",[t("code",[_._v("cumulative_sum")]),_._v("ï¼šç´¯è®¡å’Œã€‚")]),_._v(" "),t("li",[t("code",[_._v("bucket_script")]),_._v("ï¼šå¯¹å¤šä¸ªèšåˆç»“æœè¿›è¡Œè®¡ç®—ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[_._v("ï¼ˆ4ï¼‰Matrix Aggregations â€”â€” çŸ©é˜µèšåˆ")]),_._v(" "),t("p",[_._v("å¯¹å¤šä¸ªå­—æ®µåšçŸ©é˜µè¿ç®—ï¼Œå¸¸ç”¨äºç›¸å…³æ€§åˆ†æã€‚")]),_._v(" "),t("ul",[t("li",[t("code",[_._v("matrix_stats")]),_._v("ï¼šå¤šä¸ªå­—æ®µçš„åæ–¹å·®ã€ç›¸å…³ç³»æ•°ç­‰ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("å¸¸è§çš„èšåˆç±»å‹æ€»ç»“è¡¨")])]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("èšåˆç±»å‹")]),_._v(" "),t("th",[_._v("ç¤ºä¾‹")]),_._v(" "),t("th",[_._v("ç±»ä¼¼ SQL")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[t("code",[_._v("avg")]),_._v(" / "),t("code",[_._v("sum")]),_._v(" / "),t("code",[_._v("min")]),_._v(" / "),t("code",[_._v("max")])]),_._v(" "),t("td",[_._v("å¹³å‡å€¼ã€æ±‚å’Œã€æœ€å¤§æœ€å°")]),_._v(" "),t("td",[t("code",[_._v("AVG(price)")])])]),_._v(" "),t("tr",[t("td",[t("code",[_._v("terms")])]),_._v(" "),t("td",[_._v("æŒ‰å­—æ®µåˆ†ç»„")]),_._v(" "),t("td",[t("code",[_._v("GROUP BY category")])])]),_._v(" "),t("tr",[t("td",[t("code",[_._v("date_histogram")])]),_._v(" "),t("td",[_._v("æŒ‰æ—¶é—´åˆ†ç»„")]),_._v(" "),t("td",[t("code",[_._v("GROUP BY DATE(created_at)")])])]),_._v(" "),t("tr",[t("td",[t("code",[_._v("range")])]),_._v(" "),t("td",[_._v("æŒ‰åŒºé—´åˆ†ç»„")]),_._v(" "),t("td",[t("code",[_._v("CASE WHEN price BETWEEN 0 AND 100 ...")])])]),_._v(" "),t("tr",[t("td",[t("code",[_._v("cardinality")])]),_._v(" "),t("td",[_._v("å»é‡è®¡æ•°")]),_._v(" "),t("td",[t("code",[_._v("COUNT(DISTINCT user_id)")])])]),_._v(" "),t("tr",[t("td",[t("code",[_._v("cumulative_sum")])]),_._v(" "),t("td",[_._v("ç´¯è®¡å€¼")]),_._v(" "),t("td",[t("code",[_._v("SUM() OVER (ORDER BY ...)")])])])])]),_._v(" "),t("hr"),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-ä»€ä¹ˆæ˜¯-parent-child-å…³ç³»å’Œ-nested-ç±»å‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-ä»€ä¹ˆæ˜¯-parent-child-å…³ç³»å’Œ-nested-ç±»å‹"}},[_._v("#")]),_._v(" ğŸ¯ ä»€ä¹ˆæ˜¯ parent-child å…³ç³»å’Œ nested ç±»å‹ï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[t("strong",[_._v("Nested ç±»å‹")]),_._v("ï¼šç”¨äºå¤„ç†å¯¹è±¡æ•°ç»„ï¼Œé¿å…æ‰å¹³åŒ–å¼•å‘çš„é”™è¯¯åŒ¹é…ï¼›ä½†æ›´æ–°å¼€é”€å¤§ã€‚")]),_._v(" "),t("p",[t("strong",[_._v("Parent-Child å…³ç³»")]),_._v("ï¼šç”¨äºçˆ¶å­æ–‡æ¡£å»ºæ¨¡ï¼Œå­æ–‡æ¡£å¯ç‹¬ç«‹å­˜å‚¨å’Œæ›´æ–°ï¼›ä½†æŸ¥è¯¢æ€§èƒ½å·®ä¸€äº›ã€‚")]),_._v(" "),t("p",[t("strong",[_._v("é€‰æ‹©ç­–ç•¥")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("å¦‚æœæ˜¯å¯¹è±¡æ•°ç»„å†…éƒ¨å­—æ®µåŒ¹é… â†’ ç”¨ "),t("code",[_._v("nested")]),_._v("ã€‚")]),_._v(" "),t("li",[_._v("å¦‚æœæ˜¯çˆ¶å­æ¨¡å‹ä¸”å­æ–‡æ¡£éœ€ç‹¬ç«‹æ›´æ–° â†’ ç”¨ "),t("code",[_._v("parent-child")]),_._v("ã€‚")])])]),_._v(" "),t("ol",[t("li",[_._v("Parent-Child å…³ç³»")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("æ¦‚å¿µ")]),_._v("ï¼šç±»ä¼¼å…³ç³»å‹æ•°æ®åº“çš„ä¸€å¯¹å¤šå…³ç³»ã€‚çˆ¶æ–‡æ¡£å’Œå­æ–‡æ¡£åˆ†åˆ«ç‹¬ç«‹å­˜å‚¨ï¼Œä½†é€šè¿‡ "),t("code",[_._v("join")]),_._v(" å­—æ®µå»ºç«‹å…³è”ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ç‰¹ç‚¹")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("å­æ–‡æ¡£å¯ä»¥å•ç‹¬å¢åˆ æ”¹ï¼Œä¸éœ€è¦ä¿®æ”¹çˆ¶æ–‡æ¡£ã€‚")]),_._v(" "),t("li",[_._v("æŸ¥è¯¢æ—¶å¯ä»¥ç”¨ "),t("code",[_._v("has_child")]),_._v("ã€"),t("code",[_._v("has_parent")]),_._v("ã€"),t("code",[_._v("parent_id")]),_._v(" æ¥åšçˆ¶å­å…³è”æŸ¥è¯¢ã€‚")]),_._v(" "),t("li",[_._v("å¿…é¡»æŒ‡å®š routingï¼Œè®©çˆ¶å­æ–‡æ¡£è½åœ¨åŒä¸€ä¸ªåˆ†ç‰‡ï¼Œå¦åˆ™æ— æ³•å…³è”ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("ä¼˜ç¼ºç‚¹")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("ä¼˜ç‚¹ï¼šå­æ–‡æ¡£ç‹¬ç«‹æ›´æ–°ï¼Œå­˜å‚¨çµæ´»ã€‚")]),_._v(" "),t("li",[_._v("ç¼ºç‚¹ï¼šæŸ¥è¯¢æ—¶éœ€è¦ç±»ä¼¼ join çš„æ“ä½œï¼Œæ€§èƒ½è¾ƒå·®ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("åº”ç”¨åœºæ™¯")]),_._v("ï¼šç”µå•†ï¼ˆå•†å“-è¯„è®ºï¼‰ã€è®ºå›ï¼ˆå¸–å­-å›å¤ï¼‰ã€å¤šç§Ÿæˆ·ç³»ç»Ÿï¼ˆç§Ÿæˆ·-ç”¨æˆ·ï¼‰ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[_._v("Nested ç±»å‹")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("æ¦‚å¿µ")]),_._v("ï¼šä¸€ç§ç‰¹æ®Šçš„å¯¹è±¡æ•°ç»„ç±»å‹ï¼Œç”¨æ¥é¿å… Elasticsearch é»˜è®¤â€œæ‰å¹³åŒ–â€å­˜å‚¨å¸¦æ¥çš„é”™è¯¯åŒ¹é…ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("é—®é¢˜èƒŒæ™¯")]),_._v("ï¼šæ™®é€šå¯¹è±¡æ•°ç»„åœ¨æŸ¥è¯¢æ—¶ä¼šè¢«æ‰“æ•£ï¼Œå¯èƒ½æŠŠä¸åŒå¯¹è±¡çš„å­—æ®µç»„åˆé”™è¯¯ï¼ˆå¦‚æŸ¥è¯¢ "),t("code",[_._v("name=Alice AND age=25")]),_._v("ï¼Œå¯èƒ½è¿”å› "),t("code",[_._v("name=Alice")]),_._v(" å’Œ "),t("code",[_._v("age=25")]),_._v(" æ¥è‡ªä¸åŒå¯¹è±¡ï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("è§£å†³æ–¹æ¡ˆ")]),_._v("ï¼šå®šä¹‰å­—æ®µä¸º "),t("code",[_._v("nested")]),_._v(" ç±»å‹ï¼ŒES ä¼šå°†æ•°ç»„é‡Œçš„æ¯ä¸ªå¯¹è±¡å­˜å‚¨ä¸ºä¸€ä¸ªâ€œéšè—æ–‡æ¡£â€ï¼Œä¿è¯å†…éƒ¨å­—æ®µçš„ç‹¬ç«‹æ€§ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ç‰¹ç‚¹")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("ä¼˜ç‚¹ï¼šæŸ¥è¯¢ç»“æœç²¾ç¡®ï¼Œé¿å…å­—æ®µé”™é…ã€‚")]),_._v(" "),t("li",[_._v("ç¼ºç‚¹ï¼šæ›´æ–°æ—¶éœ€è¦æ•´ä½“æ›¿æ¢æ•´ä¸ª nested å­—æ®µï¼Œæ€§èƒ½è¾ƒå·®ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("åº”ç”¨åœºæ™¯")]),_._v("ï¼šç”¨æˆ·å’Œåœ°å€åˆ—è¡¨ã€è®¢å•å’Œå•†å“é¡¹ç­‰å¯¹è±¡æ•°ç»„ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[_._v("Parent-Child vs Nested å¯¹æ¯”")])]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("ç‰¹æ€§")]),_._v(" "),t("th",[_._v("Parent-Child")]),_._v(" "),t("th",[_._v("Nested")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("å…³ç³»æ¨¡å‹")]),_._v(" "),t("td",[_._v("çˆ¶å­å…³ç³»ï¼ˆç±»ä¼¼æ•°æ®åº“ä¸€å¯¹å¤šï¼‰")]),_._v(" "),t("td",[_._v("å¯¹è±¡æ•°ç»„å†…éƒ¨ç‹¬ç«‹æ–‡æ¡£")])]),_._v(" "),t("tr",[t("td",[_._v("å­˜å‚¨æ–¹å¼")]),_._v(" "),t("td",[_._v("çˆ¶å­æ–‡æ¡£ç‹¬ç«‹å­˜å‚¨")]),_._v(" "),t("td",[_._v("æ¯ä¸ªåµŒå¥—å¯¹è±¡å˜æˆéšè—æ–‡æ¡£")])]),_._v(" "),t("tr",[t("td",[_._v("æ›´æ–°å¼€é”€")]),_._v(" "),t("td",[_._v("å­æ–‡æ¡£å¯ç‹¬ç«‹æ›´æ–°ï¼Œå¼€é”€è¾ƒä½")]),_._v(" "),t("td",[_._v("æ›´æ–°éœ€è¦æ•´ä½“é‡å»ºï¼Œå¼€é”€è¾ƒå¤§")])]),_._v(" "),t("tr",[t("td",[_._v("æŸ¥è¯¢æ€§èƒ½")]),_._v(" "),t("td",[_._v("join-like æŸ¥è¯¢ï¼Œæ€§èƒ½ä¸€èˆ¬")]),_._v(" "),t("td",[_._v("æŸ¥è¯¢æ¯”æ™®é€šå­—æ®µæ…¢ï¼Œä½†æ¯” parent-child å¿«")])]),_._v(" "),t("tr",[t("td",[_._v("é€‚ç”¨åœºæ™¯")]),_._v(" "),t("td",[_._v("å•†å“-è¯„è®ºã€å¸–å­-å›å¤ã€å¤šç§Ÿæˆ·å…³ç³»å»ºæ¨¡")]),_._v(" "),t("td",[_._v("åœ°å€åˆ—è¡¨ã€è®¢å•å•†å“æ•°ç»„ã€ç”¨æˆ·åå¥½ç­‰")])])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-es-çš„è„šæœ¬æŸ¥è¯¢-painless-script-æ˜¯ä»€ä¹ˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-çš„è„šæœ¬æŸ¥è¯¢-painless-script-æ˜¯ä»€ä¹ˆ"}},[_._v("#")]),_._v(" ğŸ¯ ES çš„è„šæœ¬æŸ¥è¯¢ï¼ˆPainless Scriptï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[t("strong",[_._v("Painless Script æ˜¯ ES å†…ç½®çš„å®‰å…¨é«˜æ•ˆè„šæœ¬è¯­è¨€ï¼Œç”¨æ¥åœ¨æŸ¥è¯¢ã€èšåˆã€æ‰“åˆ†è¿‡ç¨‹ä¸­åšåŠ¨æ€è®¡ç®—ã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("å¸¸è§ç”¨é€”")]),_._v("ï¼šè‡ªå®šä¹‰æ‰“åˆ†ï¼ˆscript_scoreï¼‰ã€åŠ¨æ€å­—æ®µï¼ˆscript_fieldsï¼‰ã€èšåˆè®¡ç®—ã€å¤æ‚è¿‡æ»¤ã€‚")]),_._v(" "),t("p",[t("strong",[_._v("è®¿é—®æ–¹å¼")]),_._v("ï¼š"),t("code",[_._v("doc")]),_._v("ï¼ˆæ¨èï¼‰ã€"),t("code",[_._v("_source")]),_._v("ï¼ˆæ€§èƒ½å·®ï¼‰ã€"),t("code",[_._v("params")]),_._v("ï¼ˆå¤–éƒ¨ä¼ å‚ï¼‰ã€‚")]),_._v(" "),t("p",[t("strong",[_._v("æ³¨æ„ç‚¹")]),_._v("ï¼šè„šæœ¬çµæ´»ä½†æ€§èƒ½è¾ƒå·®ï¼Œå»ºè®®åªåœ¨å¿…è¦æ—¶ä½¿ç”¨ï¼Œå¹¶ä¸”ç»“åˆå‚æ•°åŒ–ã€‚")])]),_._v(" "),t("ol",[t("li",[_._v("ä»€ä¹ˆæ˜¯ Painless Scriptï¼Ÿ")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("Painless")]),_._v(" æ˜¯ Elasticsearch é»˜è®¤çš„è„šæœ¬è¯­è¨€ï¼Œç”¨äºåœ¨æŸ¥è¯¢æˆ–èšåˆè¿‡ç¨‹ä¸­åšåŠ¨æ€è®¡ç®—ã€‚")]),_._v(" "),t("li",[_._v("ç±»ä¼¼ SQL ä¸­çš„è¡¨è¾¾å¼æˆ–å‡½æ•°ï¼Œä½†å®ƒæ˜¯åµŒå…¥åœ¨ ES æŸ¥è¯¢é‡Œçš„ã€‚")]),_._v(" "),t("li",[_._v("ç‰¹ç‚¹æ˜¯ï¼š"),t("strong",[_._v("å®‰å…¨ï¼ˆsandboxï¼‰ã€é«˜æ•ˆã€ç®€æ´")]),_._v("ï¼Œæ¯” Groovy ç­‰è„šæœ¬æ›´å¿«ï¼Œä¸”é»˜è®¤å¯ç”¨ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[t("p",[_._v("ä½¿ç”¨åœºæ™¯")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("åŠ¨æ€è®¡ç®—å­—æ®µ")]),_._v("\næ¯”å¦‚è®¡ç®—æŠ˜æ‰£ä»·ã€åŠ æƒåˆ†æ•°ï¼š")]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v('GET /products/_search\n{\n  "query": {\n    "script_score": {\n      "query": { "match_all": {} },\n      "script": {\n        "source": "doc[\'price\'].value * params.factor",\n        "params": { "factor": 0.8 }\n      }\n    }\n  }\n}\n')])])]),t("p",[_._v("â†’ åœ¨æœç´¢æ—¶åŠ¨æ€è®¡ç®—â€œæ‰“ 8 æŠ˜ä»·æ ¼â€ã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("å¤æ‚æ’åº")]),_._v("\næŒ‰å¤šä¸ªå­—æ®µåŠ¨æ€æ’åºï¼Œæ¯”å¦‚é”€é‡å’Œç‚¹å‡»ç‡åŠ æƒã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("è¿‡æ»¤æ¡ä»¶")]),_._v("\nå¯ä»¥å†™è‡ªå®šä¹‰é€»è¾‘ï¼Œæ¯”å¦‚æŸä¸ªèŒƒå›´æˆ–å¤æ‚ä¸šåŠ¡è§„åˆ™ã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("èšåˆè®¡ç®—")]),_._v("\nåœ¨ Aggregation é‡Œè¿›è¡Œå¤æ‚çš„ç»Ÿè®¡æˆ–è‡ªå®šä¹‰æŒ‡æ ‡ã€‚")])])]),_._v(" "),t("hr"),_._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[_._v("å¸¸è§çš„ Script ç±»å‹")])]),_._v(" "),t("ul",[t("li",[t("code",[_._v("script_score")]),_._v("ï¼šè‡ªå®šä¹‰æ‰“åˆ†ï¼Œç”¨äºæ’åºã€‚")]),_._v(" "),t("li",[t("code",[_._v("script_fields")]),_._v("ï¼šç”Ÿæˆæ–°çš„å­—æ®µè¾“å‡ºã€‚")]),_._v(" "),t("li",[t("code",[_._v("script")]),_._v(" inside "),t("code",[_._v("aggs")]),_._v("ï¼šèšåˆè®¡ç®—æ—¶åŠ¨æ€å¤„ç†å­—æ®µã€‚")]),_._v(" "),t("li",[t("code",[_._v("script")]),_._v(" inside "),t("code",[_._v("query")]),_._v("ï¼šè‡ªå®šä¹‰è¿‡æ»¤é€»è¾‘ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[_._v("Painless è„šæœ¬çš„è®¿é—®æ–¹å¼")])]),_._v(" "),t("ul",[t("li",[t("strong",[t("code",[_._v("doc['field'].value")])]),_._v("ï¼šæœ€å¸¸ç”¨ï¼Œè®¿é—®å€’æ’ç´¢å¼•é‡Œçš„å­—æ®µå€¼ï¼ˆé«˜æ•ˆï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[t("code",[_._v("_source['field']")])]),_._v("ï¼šè®¿é—®åŸå§‹æ–‡æ¡£ "),t("code",[_._v("_source")]),_._v(" å­—æ®µï¼ˆå¼€é”€è¾ƒå¤§ï¼Œä¸æ¨èé¢‘ç¹ç”¨ï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("params")]),_._v("ï¼šç”¨æˆ·ä¼ å…¥çš„å‚æ•°ï¼Œé¿å…ç¡¬ç¼–ç ï¼Œæå‡å¯è¯»æ€§å’Œæ€§èƒ½ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("ol",{attrs:{start:"5"}},[t("li",[_._v("ä¼˜ç¼ºç‚¹")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("ä¼˜ç‚¹")]),_._v("ï¼šçµæ´»ï¼Œèƒ½å®ç° SQL æ— æ³•è¡¨è¾¾çš„å¤æ‚é€»è¾‘ã€‚")])]),_._v(" "),t("h2",{attrs:{id:"ğŸš¨-å…­ã€å¼‚å¸¸ä¸æ•…éšœå¤„ç†-è¿ç»´å¿…å¤‡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸš¨-å…­ã€å¼‚å¸¸ä¸æ•…éšœå¤„ç†-è¿ç»´å¿…å¤‡"}},[_._v("#")]),_._v(" ğŸš¨ å…­ã€å¼‚å¸¸ä¸æ•…éšœå¤„ç†ï¼ˆè¿ç»´å¿…å¤‡ï¼‰")]),_._v(" "),t("blockquote",[t("p",[t("strong",[_._v("æ ¸å¿ƒæ€æƒ³")]),_._v("ï¼šç”Ÿäº§ç¯å¢ƒä¸­çš„å¼‚å¸¸å¤„ç†èƒ½åŠ›æ˜¯é«˜çº§å·¥ç¨‹å¸ˆçš„æ ‡å¿—ï¼ŒåŒ…æ‹¬è„‘è£‚å¤„ç†ã€æ€§èƒ½æ’æŸ¥ã€èµ„æºä¼˜åŒ–ç­‰å…³é”®æŠ€èƒ½ã€‚")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("é›†ç¾¤æ•…éšœ")]),_._v("ï¼š"),t("a",{attrs:{href:"#es-%E7%9A%84%E8%84%91%E8%A3%82%E9%97%AE%E9%A2%98%E6%98%AF%E4%BB%80%E4%B9%88%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3"}},[_._v("è„‘è£‚é—®é¢˜")]),_._v(" | "),t("a",{attrs:{href:"#%E5%A6%82%E6%9E%9C-es-%E6%9F%A5%E8%AF%A2%E5%BE%88%E6%85%A2%E4%BD%A0%E4%BC%9A%E6%80%8E%E4%B9%88%E6%8E%92%E6%9F%A5"}},[_._v("æŸ¥è¯¢æ…¢æ’æŸ¥")])]),_._v(" "),t("li",[t("strong",[_._v("èµ„æºä¼˜åŒ–")]),_._v("ï¼š"),t("a",{attrs:{href:"#es-%E8%8A%82%E7%82%B9%E5%86%85%E5%AD%98%E4%BD%BF%E7%94%A8%E8%BF%87%E9%AB%98%E5%A6%82%E4%BD%95%E4%BC%98%E5%8C%96"}},[_._v("å†…å­˜ä¼˜åŒ–")]),_._v(" | "),t("a",{attrs:{href:"#es-%E6%95%B0%E6%8D%AE%E4%B8%8D%E5%9D%87%E8%A1%A1%E5%8F%AF%E8%83%BD%E6%98%AF%E4%BB%80%E4%B9%88%E5%8E%9F%E5%9B%A0"}},[_._v("æ•°æ®ä¸å‡è¡¡")])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-es-çš„-è„‘è£‚-é—®é¢˜æ˜¯ä»€ä¹ˆ-å¦‚ä½•è§£å†³"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-çš„-è„‘è£‚-é—®é¢˜æ˜¯ä»€ä¹ˆ-å¦‚ä½•è§£å†³"}},[_._v("#")]),_._v(" ğŸ¯ ES çš„â€œè„‘è£‚â€é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[_._v("è„‘è£‚æ˜¯æŒ‡ Elasticsearch é›†ç¾¤ç”±äºç½‘ç»œåˆ†åŒºæˆ–é…ç½®ä¸å½“ï¼Œå‡ºç°å¤šä¸ªä¸»èŠ‚ç‚¹å¹¶å­˜ï¼Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚")]),_._v(" "),t("p",[_._v("åœ¨ 7.x ä»¥å‰ï¼Œéœ€è¦æ‰‹åŠ¨è®¾ç½® "),t("code",[_._v("discovery.zen.minimum_master_nodes = (N/2)+1")]),_._v(" æ¥é¿å…ã€‚")]),_._v(" "),t("p",[_._v("åœ¨ 7.x ä»¥åï¼ŒES å†…ç½®äº†åŸºäºå¤šæ•°æ´¾çš„é€‰ä¸¾æœºåˆ¶ï¼Œæ¨èè‡³å°‘éƒ¨ç½² 3 ä¸ª master èŠ‚ç‚¹æ¥ä¿è¯é«˜å¯ç”¨ã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("1. ä»€ä¹ˆæ˜¯â€œè„‘è£‚â€é—®é¢˜ï¼Ÿ")])]),_._v(" "),t("p",[_._v("â€œè„‘è£‚â€ï¼ˆSplit-Brainï¼‰æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„ç»å…¸é—®é¢˜ï¼Œåœ¨ Elasticsearch ä¸­ä¸»è¦å‡ºç°åœ¨ "),t("strong",[_._v("é›†ç¾¤ä¸»èŠ‚ç‚¹é€‰ä¸¾")]),_._v(" æ—¶ã€‚")]),_._v(" "),t("ul",[t("li",[_._v("åœ¨ ES é›†ç¾¤é‡Œï¼Œ"),t("strong",[_._v("ä¸»èŠ‚ç‚¹ï¼ˆMaster Nodeï¼‰")]),_._v(" è´Ÿè´£ç»´æŠ¤é›†ç¾¤çš„å…ƒæ•°æ®å’Œåˆ†ç‰‡åˆ†é…ã€‚")]),_._v(" "),t("li",[_._v("å¦‚æœç”±äºç½‘ç»œæŠ–åŠ¨ã€èŠ‚ç‚¹å®•æœºç­‰åŸå› ï¼Œå¯¼è‡´é›†ç¾¤å†…çš„èŠ‚ç‚¹äº’ç›¸å¤±è”ï¼Œå¯èƒ½å‡ºç° "),t("strong",[_._v("å¤šä¸ªèŠ‚ç‚¹éƒ½è®¤ä¸ºè‡ªå·±æ˜¯ä¸»èŠ‚ç‚¹")]),_._v(" çš„æƒ…å†µã€‚")]),_._v(" "),t("li",[_._v("ç»“æœï¼š\n"),t("ul",[t("li",[_._v("é›†ç¾¤å‡ºç°å¤šä¸ªâ€œä¸»èŠ‚ç‚¹â€ï¼Œåˆ†ç‰‡åˆ†é…æ··ä¹±ï¼›")]),_._v(" "),t("li",[_._v("æ•°æ®å¯èƒ½è¢«å†™å…¥ä¸åŒçš„åˆ†æ”¯ï¼Œå¯¼è‡´ "),t("strong",[_._v("æ•°æ®ä¸¢å¤±æˆ–ä¸ä¸€è‡´")]),_._v("ã€‚")])])])]),_._v(" "),t("p",[_._v("è¿™å°±æ˜¯è„‘è£‚ã€‚")]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("2. è„‘è£‚å‡ºç°çš„åŸå› ")])]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("ç½‘ç»œåˆ†åŒº")]),_._v("ï¼ˆæœ€å¸¸è§ï¼‰\nä¸»èŠ‚ç‚¹ä¸éƒ¨åˆ†èŠ‚ç‚¹å¤±è”ï¼Œåˆ†åŒºé‡Œçš„èŠ‚ç‚¹é‡æ–°é€‰ä¸¾å‡ºä¸€ä¸ªâ€œä¸»â€ï¼Œå°±å¯¼è‡´ä¸¤ä¸ªä¸»å¹¶å­˜ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("æœ€å°ä¸»èŠ‚ç‚¹æ•°ï¼ˆminimum_master_nodesï¼‰é…ç½®ä¸å½“ï¼ˆ7.x å‰ï¼‰")]),_._v("\næ²¡æœ‰ä¸¥æ ¼æ§åˆ¶ä¸»èŠ‚ç‚¹é€‰ä¸¾çš„æ³•å®šäººæ•°ï¼ˆquorumï¼‰ï¼Œå¯¼è‡´å°éƒ¨åˆ†èŠ‚ç‚¹ä¹Ÿèƒ½é€‰å‡ºä¸»ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("é›†ç¾¤è§„æ¨¡å°")]),_._v("\nå¦‚æœåªæœ‰ 1 ä¸ªæˆ– 2 ä¸ª master-eligible èŠ‚ç‚¹ï¼Œç½‘ç»œæ³¢åŠ¨å¾ˆå®¹æ˜“å¯¼è‡´è¯¯é€‰ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("3. è§£å†³åŠæ³•")])]),_._v(" "),t("p",[_._v("ï¼ˆ1ï¼‰7.x ä»¥å‰ï¼ˆZen Discoveryï¼‰")]),_._v(" "),t("ul",[t("li",[t("p",[t("strong",[_._v("å…³é”®å‚æ•°")]),_._v("ï¼š"),t("code",[_._v("discovery.zen.minimum_master_nodes")])])]),_._v(" "),t("li",[t("p",[_._v("é…ç½®è§„åˆ™ï¼š")]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v("minimum_master_nodes = (master_eligible_nodes / 2) + 1\n")])])]),t("p",[_._v("ä¿è¯è¶…è¿‡åŠæ•°çš„èŠ‚ç‚¹æ‰èƒ½é€‰å‡ºä¸»èŠ‚ç‚¹ï¼Œé¿å…å°åˆ†åŒºè‡ªç«‹ä¸ºç‹ã€‚")])]),_._v(" "),t("li",[t("p",[_._v("ä¸¾ä¾‹ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("å¦‚æœæœ‰ 3 ä¸ª master-eligible èŠ‚ç‚¹ â†’ "),t("code",[_._v("minimum_master_nodes = 2")]),_._v("ã€‚")]),_._v(" "),t("li",[_._v("å¦‚æœæœ‰ 5 ä¸ª master-eligible èŠ‚ç‚¹ â†’ "),t("code",[_._v("minimum_master_nodes = 3")]),_._v("ã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[_._v("ï¼ˆ2ï¼‰7.x ä¹‹åï¼ˆåŸºäº Zen2 é€‰ä¸¾ï¼‰")]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("å¼•å…¥åŸºäº Raft æ€æƒ³çš„é€‰ä¸¾æœºåˆ¶")]),_._v("ï¼šè‡ªåŠ¨ä¿è¯å¤šæ•°æ´¾é€‰ä¸»ï¼Œä¸å†éœ€è¦æ‰‹åŠ¨é…ç½® "),t("code",[_._v("minimum_master_nodes")]),_._v("ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("èŠ‚ç‚¹è§’è‰²åˆ†ç¦»")]),_._v("ï¼šæ¨èéƒ¨ç½² "),t("strong",[_._v("3 ä¸ªä¸“ç”¨ master èŠ‚ç‚¹")]),_._v("ï¼Œä¿è¯é€‰ä¸¾ç¨³å®šã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ç¨³å®šç½‘ç»œ")]),_._v("ï¼šå°½é‡é¿å…è·¨æœºæˆ¿éƒ¨ç½² master èŠ‚ç‚¹ï¼Œå¦åˆ™å®¹æ˜“å› ç½‘ç»œå»¶è¿Ÿå¯¼è‡´è„‘è£‚ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("4. æœ€ä½³å®è·µ")])]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("è‡³å°‘ 3 ä¸ª master-eligible èŠ‚ç‚¹")]),_._v("ï¼ˆå¥‡æ•°ä¸ªæœ€å¥½ï¼‰ï¼Œé¿å…é€‰ä¸¾åƒµå±€ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ä¸»èŠ‚ç‚¹å’Œæ•°æ®èŠ‚ç‚¹åˆ†ç¦»")]),_._v("ï¼šç”Ÿäº§ç¯å¢ƒé‡Œå»ºè®®æŠŠ master èŠ‚ç‚¹å’Œ data èŠ‚ç‚¹åˆ†å¼€éƒ¨ç½²ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ç½‘ç»œå¯é æ€§")]),_._v("ï¼šé¿å… master èŠ‚ç‚¹è·¨æœºæˆ¿ï¼Œæˆ–è€…ä½¿ç”¨ä¸“ç”¨ç½‘ç»œã€‚")]),_._v(" "),t("li",[t("strong",[_._v("å‡çº§ ES ç‰ˆæœ¬")]),_._v("ï¼š7.x+ è‡ªåŠ¨é¿å…è„‘è£‚é—®é¢˜ï¼Œä¸å†ä¾èµ–æ‰‹åŠ¨é…ç½®ã€‚")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-å¦‚æœ-es-æŸ¥è¯¢å¾ˆæ…¢-ä½ ä¼šæ€ä¹ˆæ’æŸ¥"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å¦‚æœ-es-æŸ¥è¯¢å¾ˆæ…¢-ä½ ä¼šæ€ä¹ˆæ’æŸ¥"}},[_._v("#")]),_._v(" ğŸ¯ å¦‚æœ ES æŸ¥è¯¢å¾ˆæ…¢ï¼Œä½ ä¼šæ€ä¹ˆæ’æŸ¥ï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[_._v("å…ˆæ£€æŸ¥æŸ¥è¯¢è¯­å¥æ˜¯å¦åˆç†ï¼Œæ¯”å¦‚æ˜¯å¦èµ°å€’æ’ç´¢å¼•ï¼Œæ˜¯å¦ç”¨äº†ä½æ•ˆçš„é€šé…ç¬¦æˆ–è„šæœ¬ï¼›")]),_._v(" "),t("p",[_._v("ç„¶åçœ‹ç´¢å¼•å’Œåˆ†ç‰‡è®¾è®¡ï¼Œæ˜¯å¦åˆ†ç‰‡è¿‡å¤§æˆ–è¿‡å¤šï¼Œå­—æ®µç±»å‹æ˜¯å¦åˆé€‚ï¼›")]),_._v(" "),t("p",[_._v("å†çœ‹é›†ç¾¤å±‚é¢ï¼ŒCPU/å†…å­˜/GC/ç£ç›˜/ç½‘ç»œæ˜¯å¦å­˜åœ¨ç“¶é¢ˆï¼›")]),_._v(" "),t("p",[_._v("ä½¿ç”¨ Profile APIã€Slowlogã€Hot Threads ç­‰å·¥å…·å®šä½æ…¢æŸ¥è¯¢çš„å…·ä½“åŸå› ï¼›")]),_._v(" "),t("p",[_._v("é’ˆå¯¹é—®é¢˜ä¼˜åŒ–ï¼Œæ¯”å¦‚æ”¹æŸ¥è¯¢è¯­å¥ã€è°ƒæ•´æ˜ å°„ã€å†·çƒ­åˆ†ç¦»ã€å¢åŠ èŠ‚ç‚¹æˆ–è°ƒæ•´ç¡¬ä»¶ã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("1. æŸ¥è¯¢è¯­å¥æœ¬èº«çš„é—®é¢˜")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("æ˜¯å¦èµ°å€’æ’ç´¢å¼•")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("ç”¨ "),t("code",[_._v("term")]),_._v("/"),t("code",[_._v("match")]),_._v(" è¿™ç§èƒ½åˆ©ç”¨å€’æ’ç´¢å¼•çš„æŸ¥è¯¢ã€‚")]),_._v(" "),t("li",[_._v("é¿å… "),t("code",[_._v("wildcard")]),_._v("ï¼ˆå°¤å…¶æ˜¯å‰ç¼€æ¨¡ç³Š "),t("code",[_._v("*abc")]),_._v("ï¼‰ã€"),t("code",[_._v("regexp")]),_._v("ã€"),t("code",[_._v("script")]),_._v(" è¿™ç±»å¼€é”€å¤§çš„æŸ¥è¯¢ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("å­—æ®µç±»å‹æ˜¯å¦åˆé€‚")]),_._v("ï¼š\n"),t("ul",[t("li",[t("code",[_._v("text")]),_._v(" å­—æ®µç”¨æ¥åˆ†è¯ï¼Œæ¨¡ç³ŠæŸ¥è¯¢æ•ˆç‡é«˜ï¼›")]),_._v(" "),t("li",[t("code",[_._v("keyword")]),_._v(" å­—æ®µç”¨äºç²¾ç¡®åŒ¹é…ï¼›")]),_._v(" "),t("li",[_._v("ç±»å‹é”™äº†ä¼šå¯¼è‡´æŸ¥è¯¢å…¨è¡¨æ‰«æã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("æ’åºå­—æ®µæ˜¯å¦æœ‰ doc_values")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("åªæœ‰ keywordã€æ•°å€¼ã€æ—¥æœŸç­‰å­—æ®µé»˜è®¤æœ‰ "),t("code",[_._v("doc_values")]),_._v("ï¼Œå¯ä»¥é«˜æ•ˆæ’åºã€‚")]),_._v(" "),t("li",[_._v("å¦‚æœåœ¨ "),t("code",[_._v("text")]),_._v(" ä¸Šæ’åºï¼Œä¼šéå¸¸æ…¢ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("èšåˆæ˜¯å¦åˆç†")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("åœ¨é«˜åŸºæ•°å­—æ®µï¼ˆå¦‚ user_idï¼‰ä¸Šåš terms èšåˆï¼Œä¼šå¾ˆè€—å†…å­˜å’Œ CPUã€‚")]),_._v(" "),t("li",[_._v("å¯ä»¥è€ƒè™‘ç”¨ "),t("code",[_._v("composite aggregation")]),_._v(" åˆ†é¡µèšåˆï¼Œæˆ–è€…é¢„èšåˆã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("2. æ•°æ®é‡å’Œç´¢å¼•è®¾è®¡é—®é¢˜")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("åˆ†ç‰‡æ•°é‡æ˜¯å¦åˆç†")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("åˆ†ç‰‡è¿‡å¤šï¼šæŸ¥è¯¢éœ€è¦è·¨å¤ªå¤šåˆ†ç‰‡ï¼Œåè°ƒå¼€é”€å¤§ã€‚")]),_._v(" "),t("li",[_._v("åˆ†ç‰‡è¿‡å°‘ï¼šå•ä¸ªåˆ†ç‰‡æ•°æ®é‡è¿‡å¤§ï¼ŒæŸ¥è¯¢å‹åŠ›é›†ä¸­ã€‚")]),_._v(" "),t("li",[_._v("ä¸€èˆ¬å»ºè®®å•åˆ†ç‰‡å¤§å°æ§åˆ¶åœ¨ 10GB ~ 50GBã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("å†·çƒ­æ•°æ®åˆ†ç¦»")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("çƒ­æ•°æ®æ”¾åœ¨æ€§èƒ½å¥½çš„èŠ‚ç‚¹ï¼Œå†·æ•°æ®èµ° archive æˆ– ILMï¼ˆIndex Lifecycle Managementï¼‰ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("æ˜¯å¦å­˜åœ¨ Nested æˆ– Parent-Child ç»“æ„")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("è¿™ç±»ç»“æ„æŸ¥è¯¢å¼€é”€å¤§ï¼Œå¯èƒ½éœ€è¦æ‰å¹³åŒ–å»ºæ¨¡ã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("3. é›†ç¾¤å’Œç¡¬ä»¶èµ„æºé—®é¢˜")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("CPU / å†…å­˜æ˜¯å¦æ‰“æ»¡")]),_._v("ï¼šæŸ¥è¯¢ä¼šè¢«é˜»å¡ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("JVM é…ç½®æ˜¯å¦åˆç†")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("å †å†…å­˜ä¸è¦è¶…è¿‡ç‰©ç†å†…å­˜çš„ 50%ï¼Œä¸”æœ€å¤§ 32GBï¼›")]),_._v(" "),t("li",[_._v("GC é¢‘ç¹ä¼šå¯¼è‡´å»¶è¿Ÿã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("ç£ç›˜ I/O å’Œå­˜å‚¨ç±»å‹")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("SSD æ¯” HDD æŸ¥è¯¢å¿«å¾ˆå¤šã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("ç½‘ç»œå»¶è¿Ÿ")]),_._v("ï¼šèŠ‚ç‚¹é—´é€šä¿¡æ…¢ä¹Ÿä¼šæ‹–æ…¢æŸ¥è¯¢ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("4. æ’æŸ¥å·¥å…·ä¸æ‰‹æ®µ")])]),_._v(" "),t("ul",[t("li",[t("p",[t("strong",[_._v("Profile API")])]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v('GET /index/_search\n{\n  "profile": true,\n  "query": { "match": { "title": "elasticsearch" } }\n}\n')])])]),t("p",[_._v("â†’ å¯ä»¥çœ‹åˆ°æŸ¥è¯¢çš„æ‰§è¡Œè¿‡ç¨‹ã€è€—æ—¶åœ¨å“ªä¸ªé˜¶æ®µã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("Explain API")])]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v('GET /index/_explain/1\n{\n  "query": { "match": { "title": "es" } }\n}\n')])])]),t("p",[_._v("â†’ åˆ†ææ–‡æ¡£ä¸ºä»€ä¹ˆèƒ½åŒ¹é…ï¼Œè°ƒè¯•æŸ¥è¯¢é€»è¾‘ã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("Hot Threads API")])]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v("GET /_nodes/hot_threads\n")])])]),t("p",[_._v("â†’ æŸ¥çœ‹ CPU/çº¿ç¨‹å ç”¨ï¼Œæ’æŸ¥æ˜¯å¦å¡åœ¨æŸ¥è¯¢æˆ– GCã€‚")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("æ…¢æŸ¥è¯¢æ—¥å¿—ï¼ˆSlowlogï¼‰")])]),_._v(" "),t("ul",[t("li",[_._v("ES å¯ä»¥é…ç½®æŸ¥è¯¢æ…¢æ—¥å¿—å’Œç´¢å¼•æ…¢æ—¥å¿—ï¼Œå¸®åŠ©å®šä½å…·ä½“çš„æ…¢æŸ¥è¯¢è¯­å¥ã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("5. ä¼˜åŒ–æ‰‹æ®µ")])]),_._v(" "),t("ul",[t("li",[_._v("è¯­å¥ä¼˜åŒ–ï¼šç”¨ "),t("code",[_._v("term")]),_._v(" / "),t("code",[_._v("match")]),_._v(" æ›¿æ¢é€šé…ç¬¦ï¼Œæå‰è¿‡æ»¤èŒƒå›´æ¡ä»¶ã€‚")]),_._v(" "),t("li",[_._v("æ•°æ®å»ºæ¨¡ï¼šå†·çƒ­åˆ†ç¦»ï¼Œå¿…è¦æ—¶åšæ•°æ®å†—ä½™ï¼Œæ¢ç»“æ„ã€‚")]),_._v(" "),t("li",[_._v("ç¡¬ä»¶ä¼˜åŒ–ï¼šæ¢ SSDï¼Œå¢åŠ èŠ‚ç‚¹ï¼Œåˆ†ç‰‡è°ƒæ•´ã€‚")]),_._v(" "),t("li",[_._v("æŸ¥è¯¢å±‚ä¼˜åŒ–ï¼šç¼“å­˜ç»“æœï¼ˆquery cacheï¼‰ã€é¢„èšåˆæ•°æ®ã€å‡å°‘è¿”å›å­—æ®µ "),t("code",[_._v("_source")]),_._v("ã€‚")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-es-èŠ‚ç‚¹å†…å­˜ä½¿ç”¨è¿‡é«˜-å¦‚ä½•ä¼˜åŒ–"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-èŠ‚ç‚¹å†…å­˜ä½¿ç”¨è¿‡é«˜-å¦‚ä½•ä¼˜åŒ–"}},[_._v("#")]),_._v(" ğŸ¯ ES èŠ‚ç‚¹å†…å­˜ä½¿ç”¨è¿‡é«˜ï¼Œå¦‚ä½•ä¼˜åŒ–ï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[_._v("Elasticsearch å†…å­˜ä½¿ç”¨è¿‡é«˜é€šå¸¸æœ‰ JVM å †é…ç½®ä¸åˆç†ã€fielddata å ç”¨è¿‡å¤§ã€åˆ†ç‰‡è®¾è®¡ä¸åˆç†ã€æŸ¥è¯¢èšåˆè¿‡é‡ç­‰åŸå› ã€‚ä¼˜åŒ–æ€è·¯æ˜¯ä» "),t("strong",[_._v("JVM è°ƒæ•´ã€ç´¢å¼•è®¾è®¡ã€æŸ¥è¯¢ä¹ æƒ¯ã€é›†ç¾¤æ¶æ„")]),_._v(" å››ä¸ªæ–¹å‘å…¥æ‰‹ï¼Œæ¯”å¦‚åˆç†é…ç½®å †å†…å­˜ã€é¿å…åœ¨ text å­—æ®µä¸Šèšåˆã€ä½¿ç”¨ keyword + doc_valuesã€é™åˆ¶ fielddataã€å†·çƒ­åˆ†ç¦»å’Œåˆç†åˆ†ç‰‡ã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("1. ES å†…å­˜ä¸ºä»€ä¹ˆå®¹æ˜“å ç”¨è¿‡é«˜ï¼Ÿ")])]),_._v(" "),t("p",[_._v("ES æ˜¯åŸºäº Lucene çš„æœç´¢å¼•æ“ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª "),t("strong",[_._v("è®¡ç®— + å­˜å‚¨æ··åˆè´Ÿè½½")]),_._v(" çš„ç³»ç»Ÿï¼Œå†…å­˜æ¶ˆè€—æ¥è‡ªå‡ ä¸ªæ–¹é¢ï¼š")]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("JVM å †å†…å­˜")]),_._v(" "),t("ul",[t("li",[_._v("ç”¨äºå­˜å‚¨å€’æ’ç´¢å¼•ç¼“å­˜ã€fielddataã€èšåˆæ•°æ®ã€è¿‡æ»¤å™¨ç¼“å­˜ç­‰ã€‚")]),_._v(" "),t("li",[_._v("å¦‚æœå †åˆ†é…ä¸åˆç†ï¼Œå®¹æ˜“ OOM æˆ–é¢‘ç¹ GCã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("JVM å †å¤–å†…å­˜ï¼ˆOff-heapï¼‰")]),_._v(" "),t("ul",[t("li",[_._v("Lucene ä½¿ç”¨ "),t("code",[_._v("mmap")]),_._v(" å°†å€’æ’ç´¢å¼•æ–‡ä»¶æ˜ å°„åˆ°å†…å­˜ï¼Œä¾èµ–æ“ä½œç³»ç»Ÿçš„ "),t("strong",[_._v("Page Cache")]),_._v("ã€‚")]),_._v(" "),t("li",[_._v("èšåˆã€æ’åºæ—¶ä¹Ÿä¼šå ç”¨å¤§é‡å †å¤–å†…å­˜ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("ç¼“å­˜ç›¸å…³")]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("Fielddata Cache")]),_._v("ï¼ˆèšåˆã€æ’åºæ—¶åŠ è½½çš„å­—æ®µæ•°æ®ï¼Œå®¹æ˜“çˆ†å†…å­˜ï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("Query Cache")]),_._v("ã€"),t("strong",[_._v("Request Cache")]),_._v("ï¼ˆç¼“å­˜æŸ¥è¯¢ç»“æœï¼‰ã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("2. ä¼˜åŒ–æ€è·¯")])]),_._v(" "),t("p",[_._v("ä» "),t("strong",[_._v("é…ç½®ã€ç´¢å¼•è®¾è®¡ã€æŸ¥è¯¢ä¹ æƒ¯ã€é›†ç¾¤æ¶æ„")]),_._v(" å››ä¸ªæ–¹é¢ä¼˜åŒ–ã€‚")]),_._v(" "),t("hr"),_._v(" "),t("p",[_._v("ï¼ˆ1ï¼‰JVM é…ç½®ä¼˜åŒ–")]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("å †å†…å­˜è®¾ç½®")]),_._v(" "),t("ul",[t("li",[_._v("æ¨èè®¾ç½®ä¸ºç‰©ç†å†…å­˜çš„ "),t("strong",[_._v("50% å·¦å³")]),_._v("ï¼Œä½†ä¸è¦è¶…è¿‡ "),t("strong",[_._v("32GB")]),_._v("ï¼ˆè¶…è¿‡åä¼šç¦ç”¨å‹ç¼©æŒ‡é’ˆï¼Œåè€Œæ•ˆç‡ä½ï¼‰ã€‚")]),_._v(" "),t("li",[_._v("æ¯”å¦‚ 64GB å†…å­˜çš„æœºå™¨ â†’ JVM å † 30GB å·¦å³å³å¯ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("é¿å…é¢‘ç¹ GC")]),_._v(" "),t("ul",[t("li",[_._v("è§‚å¯Ÿ "),t("code",[_._v("/_nodes/stats/jvm")]),_._v("ï¼Œå¦‚æœ Old GC æ—¶é—´è¿‡é•¿ â†’ å†…å­˜ä¸è¶³æˆ–å†…å­˜æ³„æ¼ã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[_._v("ï¼ˆ2ï¼‰ç´¢å¼•å’Œå­—æ®µè®¾è®¡ä¼˜åŒ–")]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("ç¦ç”¨ä¸å¿…è¦çš„ "),t("code",[_._v("_source")]),_._v("ã€"),t("code",[_._v("_all")]),_._v(" å­—æ®µ")]),_._v("ï¼šå‡å°‘å­˜å‚¨å’Œå†…å­˜å ç”¨ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("åˆç†é€‰æ‹©å­—æ®µç±»å‹")]),_._v(" "),t("ul",[t("li",[_._v("ç”¨ "),t("code",[_._v("keyword")]),_._v(" å­˜å‚¨ç²¾ç¡®å€¼ï¼›")]),_._v(" "),t("li",[_._v("é¿å…åœ¨é«˜åŸºæ•°å­—æ®µä¸Šä½¿ç”¨ "),t("code",[_._v("fielddata")]),_._v("ï¼Œå¯ä»¥é¢„å…ˆå»º "),t("code",[_._v("keyword")]),_._v(" å­—æ®µï¼Œå¯ç”¨ "),t("code",[_._v("doc_values")]),_._v("ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("æ§åˆ¶ mapping çš„å­—æ®µæ•°é‡")]),_._v(" "),t("ul",[t("li",[_._v("åŠ¨æ€ mapping å¯èƒ½ç”Ÿæˆæˆåƒä¸Šä¸‡ä¸ªå­—æ®µï¼Œå¯¼è‡´å†…å­˜æš´æ¶¨ã€‚")]),_._v(" "),t("li",[_._v("ç¦ç”¨ dynamic æˆ–è€…ä¸¥æ ¼æ§åˆ¶ã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[_._v("ï¼ˆ3ï¼‰æŸ¥è¯¢ä¸èšåˆä¼˜åŒ–")]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("é¿å…åœ¨ "),t("code",[_._v("text")]),_._v(" å­—æ®µä¸Šæ’åº/èšåˆ")]),_._v(" "),t("ul",[t("li",[_._v("å› ä¸ºä¼šè§¦å‘ fielddata åŠ è½½ï¼Œå ç”¨å¤§é‡å†…å­˜ã€‚")]),_._v(" "),t("li",[_._v("æ›¿ä»£æ–¹æ¡ˆï¼šç”¨ "),t("code",[_._v("keyword")]),_._v(" å­—æ®µæˆ–å¼€å¯ "),t("code",[_._v("doc_values")]),_._v("ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("é™åˆ¶èšåˆè§„æ¨¡")]),_._v(" "),t("ul",[t("li",[t("code",[_._v("terms")]),_._v(" èšåˆåœ¨é«˜åŸºæ•°å­—æ®µä¸Šä¼šçˆ†å†…å­˜ï¼Œè€ƒè™‘ "),t("code",[_._v("composite aggregation")]),_._v(" åˆ†é¡µèšåˆã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("å‡å°‘è¿”å›ç»“æœé›†å¤§å°")]),_._v(" "),t("ul",[t("li",[_._v("æŸ¥è¯¢æ—¶æŒ‡å®š "),t("code",[_._v("_source")]),_._v(" çš„å­—æ®µï¼Œè€Œä¸æ˜¯ç›´æ¥è¿”å›å…¨æ–‡æ¡£ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("å–„ç”¨ Scroll / search_after")]),_._v(" "),t("ul",[t("li",[_._v("é¿å…æ·±åˆ†é¡µå¸¦æ¥çš„å†…å­˜å’Œ CPU æ¶ˆè€—ã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[_._v("ï¼ˆ4ï¼‰é›†ç¾¤å’Œæ¶æ„å±‚é¢")]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("å†·çƒ­åˆ†ç¦»")]),_._v(" "),t("ul",[t("li",[_._v("çƒ­æ•°æ®æ”¾åœ¨å†…å­˜å’Œ SSD èµ„æºå¥½çš„èŠ‚ç‚¹ï¼›")]),_._v(" "),t("li",[_._v("å†·æ•°æ®ç”¨ä½æˆæœ¬èŠ‚ç‚¹å­˜å‚¨ï¼Œå‡å°‘å¯¹å†…å­˜çš„äº‰ç”¨ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("å¢åŠ èŠ‚ç‚¹ / åˆç†åˆ†ç‰‡")]),_._v(" "),t("ul",[t("li",[_._v("åˆ†ç‰‡è¿‡å¤§ï¼šå†…å­˜å‹åŠ›é›†ä¸­ï¼›")]),_._v(" "),t("li",[_._v("åˆ†ç‰‡è¿‡å¤šï¼šç®¡ç†å¼€é”€å¤§ã€‚å»ºè®®å•åˆ†ç‰‡ 10~50GBã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("ç›‘æ§ç¼“å­˜ä½¿ç”¨æƒ…å†µ")]),_._v(" "),t("ul",[t("li",[t("code",[_._v("GET /_nodes/stats/indices/fielddata?human")]),_._v(" æŸ¥çœ‹ fielddata å ç”¨ï¼›")]),_._v(" "),t("li",[_._v("å¯ä»¥é€šè¿‡ "),t("code",[_._v("indices.breaker.fielddata.limit")]),_._v(" é™åˆ¶ fielddata å ç”¨ï¼Œé¿å… OOMã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("3. æœ€ä½³å®è·µæ€»ç»“")])]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("JVM å †ä¸è¦è¶…è¿‡ 32GB")]),_._v("ï¼Œè®¾ç½®ä¸ºç‰©ç†å†…å­˜ä¸€åŠå·¦å³ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("é¿å…åœ¨ text å­—æ®µä¸Šåšèšåˆ/æ’åº")]),_._v("ï¼Œä½¿ç”¨ keyword + doc_valuesã€‚")]),_._v(" "),t("li",[t("strong",[_._v("æ§åˆ¶ fielddata å†…å­˜ä½¿ç”¨")]),_._v("ï¼Œå¿…è¦æ—¶å¯ç”¨é™åˆ¶ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("åˆ†ç‰‡è®¾è®¡åˆç†")]),_._v("ï¼Œé¿å…å•åˆ†ç‰‡è¿‡å¤§æˆ–è¿‡å¤šã€‚")]),_._v(" "),t("li",[t("strong",[_._v("å†·çƒ­æ•°æ®åˆ†ç¦»")]),_._v("ï¼Œå‡å°‘å¯¹çƒ­èŠ‚ç‚¹å†…å­˜çš„äº‰ç”¨ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("æŸ¥è¯¢ä¼˜åŒ–")]),_._v("ï¼šå‡å°‘è¿”å›å­—æ®µï¼Œé¿å…æ·±åˆ†é¡µï¼Œæ§åˆ¶èšåˆè§„æ¨¡ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ç›‘æ§ + æ…¢æŸ¥è¯¢æ—¥å¿—")]),_._v("ï¼šç»“åˆ "),t("code",[_._v("_nodes/stats")]),_._v("ã€Slowlog å®šä½é—®é¢˜ã€‚")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-es-æ•°æ®ä¸å‡è¡¡-å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› "}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-es-æ•°æ®ä¸å‡è¡¡-å¯èƒ½æ˜¯ä»€ä¹ˆåŸå› "}},[_._v("#")]),_._v(" ğŸ¯ ES æ•°æ®ä¸å‡è¡¡ï¼Œå¯èƒ½æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[_._v("ES æ•°æ®ä¸å‡è¡¡é€šå¸¸ç”± "),t("strong",[_._v("åˆ†ç‰‡åˆ†é…ç­–ç•¥ä¸åˆç†ï¼ˆåˆ†ç‰‡æ•°ã€routing key çƒ­ç‚¹ï¼‰ã€èŠ‚ç‚¹ç£ç›˜/è§’è‰²é™åˆ¶ã€ç´¢å¼•ç”Ÿå‘½å‘¨æœŸç­–ç•¥ã€é›†ç¾¤æ‰©å®¹è®¾è®¡é—®é¢˜")]),_._v(" ç­‰åŸå› å¯¼è‡´ã€‚è§£å†³æ–¹æ³•åŒ…æ‹¬ "),t("strong",[_._v("åˆç†è§„åˆ’åˆ†ç‰‡æ•°é‡ã€ä¼˜åŒ– routing ç­–ç•¥ã€è°ƒæ•´ç£ç›˜æ°´ä½çº¿ã€å¯ç”¨ rebalanceã€å†·çƒ­åˆ†ç¦»ä¼˜åŒ–")]),_._v(" ç­‰ã€‚å¦‚æœä¸šåŠ¡æ•°æ®åˆ†å¸ƒä¸å‡ï¼Œé‡ç‚¹è¦æ£€æŸ¥æ˜¯å¦ä½¿ç”¨äº†è‡ªå®šä¹‰ routing å¯¼è‡´â€œçƒ­ç‚¹åˆ†ç‰‡â€ã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("1. ES æ•°æ®ä¸å‡è¡¡çš„ç°è±¡")])]),_._v(" "),t("ul",[t("li",[_._v("æŸäº›èŠ‚ç‚¹ç£ç›˜ã€CPUã€å†…å­˜è´Ÿè½½æ˜æ˜¾æ›´é«˜ã€‚")]),_._v(" "),t("li",[_._v("åˆ†ç‰‡åˆ†é…åˆ°æŸäº›èŠ‚ç‚¹è¿‡å¤šï¼Œè€Œå…¶ä»–èŠ‚ç‚¹å¾ˆç©ºé—²ã€‚")]),_._v(" "),t("li",[_._v("æŸ¥è¯¢è·¯ç”±å¤§éƒ¨åˆ†é›†ä¸­åˆ°æŸäº›èŠ‚ç‚¹ï¼Œå¯¼è‡´â€œçƒ­ç‚¹â€é—®é¢˜ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("2. å¯èƒ½åŸå› ")])]),_._v(" "),t("p",[_._v("ï¼ˆ1ï¼‰åˆ†ç‰‡åˆ†é…ç­–ç•¥é—®é¢˜")]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("åˆ†ç‰‡æ•°é‡è®¾è®¡ä¸åˆç†")]),_._v(" "),t("ul",[t("li",[_._v("å•ä¸ªç´¢å¼•åˆ†ç‰‡æ•°å¤ªå°‘ â†’ æ— æ³•å‡åŒ€åˆ†é…åˆ°æ‰€æœ‰èŠ‚ç‚¹ã€‚")]),_._v(" "),t("li",[_._v("åˆ†ç‰‡æ•°å¤ªå¤š â†’ éƒ¨åˆ†èŠ‚ç‚¹åˆ†é…è¿‡å¤šåˆ†ç‰‡ï¼Œè´Ÿè½½ä¸å‡ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("è·¯ç”±ï¼ˆRoutingï¼‰å¯¼è‡´æ•°æ®å€¾æ–œ")]),_._v(" "),t("ul",[t("li",[_._v("ES é»˜è®¤ç”¨ "),t("code",[_._v("_id")]),_._v(" hash è·¯ç”±åˆ°åˆ†ç‰‡ï¼Œä½†å¦‚æœæŒ‡å®šäº†è‡ªå®šä¹‰ routing key ä¸”åˆ†å¸ƒä¸å‡ï¼Œä¼šå¯¼è‡´éƒ¨åˆ†åˆ†ç‰‡æ•°æ®é‡è¿‡å¤§ï¼Œå½¢æˆâ€œçƒ­ç‚¹åˆ†ç‰‡â€ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("åˆ†ç‰‡å†å¹³è¡¡æœªè§¦å‘")]),_._v(" "),t("ul",[t("li",[_._v("ES æœ‰ "),t("code",[_._v("cluster.routing.allocation.*")]),_._v(" é…ç½®æ§åˆ¶åˆ†ç‰‡åˆ†é…ï¼Œå¦‚æœå‚æ•°è®¾ç½®ä¸åˆç†ï¼Œå¯èƒ½é˜»æ­¢åˆ†ç‰‡è¿ç§»ã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[_._v("ï¼ˆ2ï¼‰ç¡¬ä»¶æˆ–èŠ‚ç‚¹é—®é¢˜")]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("ç£ç›˜æ°´ä½çº¿")]),_._v(" "),t("ul",[t("li",[_._v("ES é»˜è®¤æœ‰ç£ç›˜æ°´ä½çº¿ï¼ˆ85%ã€90%ï¼‰ï¼Œè¶…è¿‡é˜ˆå€¼çš„èŠ‚ç‚¹ä¸ä¼šå†åˆ†é…åˆ†ç‰‡ï¼Œå¯¼è‡´æ•°æ®å †ç§¯åˆ°å°‘æ•°èŠ‚ç‚¹ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("èŠ‚ç‚¹è§’è‰²é…ç½®ä¸å‡")]),_._v(" "),t("ul",[t("li",[_._v("æŸäº›èŠ‚ç‚¹æ˜¯ "),t("strong",[_._v("data node")]),_._v("ï¼Œè€Œæœ‰äº›èŠ‚ç‚¹ä¸æ˜¯ï¼Œåˆ†ç‰‡åªèƒ½åˆ†é…åˆ° data node ä¸Šï¼Œå¯èƒ½å¯¼è‡´åˆ†å¸ƒä¸å‡ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("æœºå™¨é…ç½®ä¸ä¸€è‡´")]),_._v(" "),t("ul",[t("li",[_._v("éƒ¨åˆ†èŠ‚ç‚¹ CPUã€å†…å­˜æˆ–ç£ç›˜å°ï¼ŒES é»˜è®¤ä¸ä¼šå‡è¡¡è€ƒè™‘æ€§èƒ½ â†’ æ•°æ®é›†ä¸­åˆ°é«˜é…èŠ‚ç‚¹ã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[_._v("ï¼ˆ3ï¼‰é›†ç¾¤æ“ä½œå¯¼è‡´")]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("æ‰‹åŠ¨åˆ†é…åˆ†ç‰‡")]),_._v(" "),t("ul",[t("li",[_._v("è¿ç»´æ‰‹åŠ¨åˆ†é…è¿‡åˆ†ç‰‡ï¼Œæ‰“ç ´äº†è‡ªåŠ¨å‡è¡¡ç­–ç•¥ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("ç´¢å¼•ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ˆILMï¼‰")]),_._v(" "),t("ul",[t("li",[_._v("çƒ­-æ¸©-å†·æ¶æ„é‡Œï¼Œç´¢å¼•ä¼šè¿ç§»åˆ°ä¸åŒèŠ‚ç‚¹ï¼ˆæ¯”å¦‚å†·èŠ‚ç‚¹å­˜å‚¨æ›´å¤šå†å²æ•°æ®ï¼‰ï¼Œå¯¼è‡´å†·çƒ­ä¸å‡è¡¡ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("å¤šç´¢å¼•å¤§å°å·®å¼‚è¿‡å¤§")]),_._v(" "),t("ul",[t("li",[_._v("æŸäº›ç´¢å¼•æ•°æ®é‡æå¤§ï¼Œå ç”¨äº†å¤§éƒ¨åˆ†èŠ‚ç‚¹ç©ºé—´ï¼Œå¯¼è‡´ä¸å‡è¡¡ã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[t("p",[_._v("è§£å†³æ–¹æ¡ˆ")])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("æ£€æŸ¥åˆ†ç‰‡è®¾è®¡")])]),_._v(" "),t("ul",[t("li",[_._v("ä¿è¯åˆ†ç‰‡æ•°é‡åˆç†ï¼Œä¸€èˆ¬å•åˆ†ç‰‡ 10~50GBã€‚")]),_._v(" "),t("li",[_._v("é¿å…ç´¢å¼•åˆ†ç‰‡æ•°è¿‡å°‘æˆ–è¿‡å¤šã€‚")])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("ä¼˜åŒ– Routing ç­–ç•¥")])]),_._v(" "),t("ul",[t("li",[_._v("å¦‚æœç”¨è‡ªå®šä¹‰ routingï¼Œç¡®ä¿ key åˆ†å¸ƒå‡åŒ€ã€‚")]),_._v(" "),t("li",[_._v("å¯ä»¥ä½¿ç”¨ "),t("code",[_._v("shard=custom")]),_._v(" é…åˆ "),t("strong",[_._v("hash ç®—æ³•")]),_._v("ï¼Œé¿å…çƒ­ç‚¹ã€‚")])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("åˆ†ç‰‡é‡æ–°åˆ†é…ï¼ˆRebalanceï¼‰")])]),_._v(" "),t("ul",[t("li",[t("p",[_._v("æŸ¥çœ‹åˆ†ç‰‡åˆ†å¸ƒï¼š")]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v("GET /_cat/shards?v\n")])])])]),_._v(" "),t("li",[t("p",[_._v("æ‰‹åŠ¨ç§»åŠ¨åˆ†ç‰‡ï¼š")]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v('POST /_cluster/reroute\n{\n  "commands": [\n    {\n      "move": {\n        "index": "my_index",\n        "shard": 0,\n        "from_node": "node1",\n        "to_node": "node2"\n      }\n    }\n  ]\n}\n')])])])])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("æ£€æŸ¥ç£ç›˜æ°´ä½é…ç½®")])]),_._v(" "),t("ul",[t("li",[t("p",[_._v("è°ƒæ•´ç£ç›˜é˜ˆå€¼ï¼š")]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v("cluster.routing.allocation.disk.watermark.low: 70%\ncluster.routing.allocation.disk.watermark.high: 85%\ncluster.routing.allocation.disk.watermark.flood_stage: 95%\n")])])])])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("å†·çƒ­åˆ†ç¦»è®¾è®¡åˆç†åŒ–")])]),_._v(" "),t("ul",[t("li",[_._v("çƒ­èŠ‚ç‚¹åªå­˜å‚¨æ´»è·ƒæ•°æ®ï¼›å†·èŠ‚ç‚¹æ‰¿æ‹…æ›´å¤šå†å²ç´¢å¼•ï¼Œä½†é¿å…è¿‡åº¦é›†ä¸­ã€‚")])])]),_._v(" "),t("li",[t("p",[t("strong",[_._v("å¢åŠ èŠ‚ç‚¹æˆ–æ‰©å®¹ç´¢å¼•")])]),_._v(" "),t("ul",[t("li",[_._v("å¦‚æœæ•°æ®é‡æŒç»­å¢é•¿ï¼Œå¯èƒ½éœ€è¦æ–°å¢ data node æˆ–è€…è°ƒæ•´åˆ†ç‰‡æ•°ã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("h2",{attrs:{id:"ğŸ’¼-ä¸ƒã€å®æˆ˜åœºæ™¯é¢˜-é¡¹ç›®ç»éªŒ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ’¼-ä¸ƒã€å®æˆ˜åœºæ™¯é¢˜-é¡¹ç›®ç»éªŒ"}},[_._v("#")]),_._v(" ğŸ’¼ ä¸ƒã€å®æˆ˜åœºæ™¯é¢˜ï¼ˆé¡¹ç›®ç»éªŒï¼‰")]),_._v(" "),t("blockquote",[t("p",[t("strong",[_._v("æ ¸å¿ƒæ€æƒ³")]),_._v("ï¼šå®æˆ˜åœºæ™¯é¢˜è€ƒå¯Ÿçš„æ˜¯ä½ çš„é¡¹ç›®ç»éªŒå’Œè§£å†³å®é™…é—®é¢˜çš„èƒ½åŠ›ï¼Œæ˜¯é¢è¯•å®˜åˆ¤æ–­ä½ æŠ€æœ¯æ°´å¹³çš„é‡è¦ä¾æ®ã€‚")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("é¡¹ç›®åœºæ™¯")]),_._v("ï¼š"),t("a",{attrs:{href:"#%E4%BD%A0%E5%9C%A8%E9%A1%B9%E7%9B%AE%E9%87%8C%E6%98%AF%E6%80%8E%E4%B9%88%E7%94%A8-elasticsearch-%E7%9A%84%E5%9C%BA%E6%99%AF%E6%98%AF%E4%BB%80%E4%B9%88"}},[_._v("é¡¹ç›®å®è·µç»éªŒ")]),_._v(" | "),t("a",{attrs:{href:"#elasticsearch%E4%BA%86%E8%A7%A3%E5%A4%9A%E5%B0%91%E8%AF%B4%E8%AF%B4%E4%BD%A0%E4%BB%AC%E5%85%AC%E5%8F%B8es%E7%9A%84%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84"}},[_._v("é›†ç¾¤æ¶æ„è®¾è®¡")])]),_._v(" "),t("li",[t("strong",[_._v("ç´¢å¼•è®¾è®¡")]),_._v("ï¼š"),t("a",{attrs:{href:"#%E5%A6%82%E6%9E%9C%E5%AD%98%E5%82%A8%E6%97%A5%E5%BF%97%E6%95%B0%E6%8D%AE%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E7%B4%A2%E5%BC%95"}},[_._v("æ—¥å¿—ç´¢å¼•è®¾è®¡")]),_._v(" | "),t("a",{attrs:{href:"#%E5%A6%82%E6%9E%9C%E8%A6%81%E5%88%A0%E9%99%A4%E8%BF%87%E6%9C%9F%E6%95%B0%E6%8D%AE%E6%80%8E%E4%B9%88%E5%81%9A"}},[_._v("æ•°æ®æ¸…ç†ç­–ç•¥")])]),_._v(" "),t("li",[t("strong",[_._v("æ•°æ®å¤„ç†")]),_._v("ï¼š"),t("a",{attrs:{href:"#%E5%A6%82%E4%BD%95%E5%9C%A8-es-%E4%B8%AD%E5%AE%9E%E7%8E%B0%E7%B1%BB%E4%BC%BC-sql-%E7%9A%84-join-%E6%93%8D%E4%BD%9C"}},[_._v("SQL Joinå®ç°")]),_._v(" | "),t("a",{attrs:{href:"#elasticsearch-%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86%E6%95%B0%E6%8D%AE%E7%9A%84%E5%88%A0%E9%99%A4%E6%93%8D%E4%BD%9C"}},[_._v("åˆ é™¤æ“ä½œåŸç†")])]),_._v(" "),t("li",[t("strong",[_._v("æŠ€æœ¯é€‰å‹")]),_._v("ï¼š"),t("a",{attrs:{href:"#elasticsearch-%E5%92%8C-%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%8C%BA%E5%88%AB"}},[_._v("ä¸å…¶ä»–æŠ€æœ¯å¯¹æ¯”åˆ†æ")]),_._v(" | "),t("a",{attrs:{href:"#elasticsearch-%E7%9A%84%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"}},[_._v("åº”ç”¨åœºæ™¯åˆ†æ")])])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-ä½ åœ¨é¡¹ç›®é‡Œæ˜¯æ€ä¹ˆç”¨-elasticsearch-çš„-åœºæ™¯æ˜¯ä»€ä¹ˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-ä½ åœ¨é¡¹ç›®é‡Œæ˜¯æ€ä¹ˆç”¨-elasticsearch-çš„-åœºæ™¯æ˜¯ä»€ä¹ˆ"}},[_._v("#")]),_._v(" ğŸ¯ ä½ åœ¨é¡¹ç›®é‡Œæ˜¯æ€ä¹ˆç”¨ Elasticsearch çš„ï¼Ÿåœºæ™¯æ˜¯ä»€ä¹ˆï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[_._v("æˆ‘ä»¬åœ¨é¡¹ç›®é‡Œç”¨ Elasticsearch åš "),t("strong",[_._v("å•†å“æ£€ç´¢")]),_._v("ï¼Œè§„æ¨¡å¤§æ¦‚ "),t("strong",[_._v("10 äº¿å•†å“")]),_._v("ï¼Œåˆ†å±äº "),t("strong",[_._v("14 ä¸ªè¡Œä¸š")]),_._v("ã€‚ä¸ºäº†æå‡æ€§èƒ½ï¼Œæˆ‘ä»¬æŒ‰è¡Œä¸šå»ºç´¢å¼•ï¼Œé¿å…å•ç´¢å¼•è¿‡å¤§ã€‚\nåœ¨ Mapping ä¸Šï¼Œå•†å“æ ‡é¢˜å’Œæè¿°ç”¨ "),t("code",[_._v("text")]),_._v("+ä¸­æ–‡åˆ†è¯å™¨ï¼Œå“ç‰Œå’Œç±»ç›®ç”¨ "),t("code",[_._v("keyword")]),_._v("ï¼Œä»·æ ¼ã€é”€é‡ç”¨æ•°å€¼å‹ï¼Œæ”¯æŒèŒƒå›´è¿‡æ»¤å’Œæ’åºã€‚\næ•°æ®å†™å…¥é€šè¿‡ "),t("strong",[_._v("Kafka + Bulk API")]),_._v("ï¼Œæ”¯æŒå®æ—¶æ›´æ–°ï¼ŒåŒæ—¶æ§åˆ¶ "),t("code",[_._v("refresh_interval")]),_._v(" ä¼˜åŒ–å†™å…¥æ€§èƒ½ã€‚\næŸ¥è¯¢æ–¹é¢æ”¯æŒå…¨æ–‡æ£€ç´¢ã€æ¡ä»¶è¿‡æ»¤ã€èšåˆåˆ†æã€æ’åºï¼Œå…¸å‹åº”ç”¨å°±æ˜¯ç”µå•†çš„æœç´¢å’Œç­›é€‰é¢æ¿ã€‚\nåœ¨æ€§èƒ½ä¸Šï¼Œæˆ‘ä»¬åšäº†åˆ†ç‰‡è§„åˆ’ã€å†·çƒ­åˆ†ç¦»ã€ç¼“å­˜ä¼˜åŒ–ï¼Œæ·±åˆ†é¡µç”¨ "),t("code",[_._v("search_after")]),_._v(" æ›¿ä»£ "),t("code",[_._v("from+size")]),_._v("ã€‚\næ•´ä¸ªé›†ç¾¤æœ‰å¤šèŠ‚ç‚¹ï¼Œåˆ†ç‰‡+å‰¯æœ¬ä¿è¯äº†é«˜å¯ç”¨ï¼Œä¹Ÿèƒ½æ¨ªå‘æ‰©å±•ã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("1. èƒŒæ™¯ä¸ä¸šåŠ¡åœºæ™¯")])]),_._v(" "),t("p",[_._v("æˆ‘ä»¬é¡¹ç›®æœ‰ä¸€ä¸ª "),t("strong",[_._v("å•†å“åº“")]),_._v("ï¼Œè§„æ¨¡åœ¨ "),t("strong",[_._v("10 äº¿çº§åˆ«")]),_._v("ï¼Œè¦†ç›– "),t("strong",[_._v("14 ä¸ªè¡Œä¸š")]),_._v("ã€‚ä¸šåŠ¡ä¸Šéœ€è¦æ”¯æŒï¼š")]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("å¤šç»´åº¦æœç´¢")]),_._v("ï¼šæ¯”å¦‚æŒ‰å…³é”®å­—ã€ç±»ç›®ã€å“ç‰Œã€ä»·æ ¼åŒºé—´ã€å±æ€§ç­‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("è¿‡æ»¤ä¸æ’åº")]),_._v("ï¼šæ¯”å¦‚é”€é‡æ’åºã€ä»·æ ¼å‡é™åºã€ä¸Šæ¶æ—¶é—´ã€ä¸ªæ€§åŒ–æ¨èã€‚")]),_._v(" "),t("li",[t("strong",[_._v("èšåˆç»Ÿè®¡")]),_._v("ï¼šæ¯”å¦‚æŸä¸ªå“ç±»ä¸‹çš„å“ç‰Œåˆ†å¸ƒã€ä»·æ ¼åŒºé—´åˆ†å¸ƒã€‚")]),_._v(" "),t("li",[t("strong",[_._v("é«˜å¹¶å‘")]),_._v("ï¼šæœç´¢è¯·æ±‚é‡éå¸¸å¤§ï¼Œéœ€è¦ä¿è¯ "),t("strong",[_._v("ä½å»¶è¿Ÿï¼ˆ<200msï¼‰")]),_._v("ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("2. ä¸ºä»€ä¹ˆç”¨ Elasticsearch")])]),_._v(" "),t("ul",[t("li",[_._v("å…³ç³»å‹æ•°æ®åº“ï¼ˆMySQLï¼‰ä¸é€‚åˆåšå¤æ‚æœç´¢ + èšåˆï¼ŒæŸ¥è¯¢ä¼šéå¸¸æ…¢ã€‚")]),_._v(" "),t("li",[_._v("Elasticsearch æä¾› "),t("strong",[_._v("å€’æ’ç´¢å¼•ã€åˆ†å¸ƒå¼å­˜å‚¨ã€å…¨æ–‡æ£€ç´¢ã€å¤šç»´èšåˆ")]),_._v("ï¼Œå¤©ç„¶é€‚åˆå•†å“æœç´¢è¿™ç§åœºæ™¯ã€‚")]),_._v(" "),t("li",[_._v("å†…ç½®äº† "),t("strong",[_._v("é«˜å¯ç”¨ã€æ‰©å±•æ€§")]),_._v("ï¼Œèƒ½åº”å¯¹å¤§è§„æ¨¡æ•°æ®é‡ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("3. æ•°æ®å»ºæ¨¡ & ç´¢å¼•è®¾è®¡")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("ç´¢å¼•è®¾è®¡")]),_._v("ï¼šæŒ‰ "),t("strong",[_._v("è¡Œä¸šç»´åº¦")]),_._v("åˆ’åˆ†ç´¢å¼•ï¼ˆ14ä¸ª indexï¼‰ï¼Œé¿å…å•ç´¢å¼•è¿‡å¤§ï¼Œæå‡æŸ¥è¯¢æ€§èƒ½å’Œå¯æ‰©å±•æ€§ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("Mapping è®¾è®¡")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("å•†å“æ ‡é¢˜ã€æè¿° â†’ "),t("code",[_._v("text")]),_._v(" ç±»å‹ + ä¸­æ–‡åˆ†è¯å™¨ï¼ˆik_max_word / smartï¼‰ã€‚")]),_._v(" "),t("li",[_._v("å“ç‰Œã€ç±»ç›®ã€å±æ€§ï¼ˆæšä¸¾å‹å­—æ®µï¼‰ â†’ "),t("code",[_._v("keyword")]),_._v(" ç±»å‹ï¼Œæ”¯æŒèšåˆå’Œè¿‡æ»¤ã€‚")]),_._v(" "),t("li",[_._v("ä»·æ ¼ã€é”€é‡ã€è¯„åˆ† â†’ "),t("code",[_._v("integer")]),_._v(" / "),t("code",[_._v("float")]),_._v(" ç±»å‹ï¼Œæ”¯æŒèŒƒå›´æŸ¥è¯¢ä¸æ’åºã€‚")]),_._v(" "),t("li",[_._v("ä¸Šæ¶æ—¶é—´ â†’ "),t("code",[_._v("date")]),_._v(" ç±»å‹ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("Routing")]),_._v("ï¼šé»˜è®¤æŒ‰ "),t("code",[_._v("_id")]),_._v(" åˆ†é…ï¼Œä¹Ÿè€ƒè™‘è¿‡è¡Œä¸šå†…çš„äºŒçº§è·¯ç”±ï¼ˆå¦‚ç±»ç›®ï¼‰ï¼Œä»¥å‡å°‘è·¨åˆ†ç‰‡æŸ¥è¯¢ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("4. æ•°æ®å†™å…¥ & æ›´æ–°")])]),_._v(" "),t("ul",[t("li",[_._v("å•†å“æ•°æ®æºæ¥è‡ª "),t("strong",[_._v("æ•°æ®åº“ï¼ˆMySQLï¼‰+ æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆKafkaï¼‰")]),_._v("ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("å…¨é‡å¯¼å…¥")]),_._v("ï¼šä½¿ç”¨ "),t("strong",[_._v("æ‰¹é‡ Bulk API")]),_._v("ï¼Œå¹¶è¡Œåˆ†ç‰‡å†™å…¥ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("å¢é‡æ›´æ–°")]),_._v("ï¼šé€šè¿‡ Kafka æ¶ˆæ¯è§¦å‘æ›´æ–°ï¼ŒES æ¶ˆè´¹ç«¯æ‰¹é‡å†™å…¥ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("å†™å…¥ä¼˜åŒ–")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("ä½¿ç”¨ "),t("strong",[_._v("bulk æ‰¹é‡å†™å…¥")]),_._v("ï¼Œé¿å…å•æ¡å†™å…¥å¼€é”€ã€‚")]),_._v(" "),t("li",[_._v("æ§åˆ¶ "),t("strong",[_._v("refresh_interval")]),_._v("ï¼ˆæ¯”å¦‚ 30sï¼‰ï¼Œæ‰¹é‡åˆ·æ–°ï¼Œå‡å°‘ segment é¢‘ç¹ç”Ÿæˆã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("5. æŸ¥è¯¢åœºæ™¯")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("æœç´¢")]),_._v("ï¼š"),t("code",[_._v("match")]),_._v("ã€"),t("code",[_._v("multi_match")]),_._v(" æ”¯æŒå•†å“æ ‡é¢˜ + æè¿°æœç´¢ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("è¿‡æ»¤")]),_._v("ï¼šé€šè¿‡ "),t("code",[_._v("term")]),_._v("ã€"),t("code",[_._v("range")]),_._v(" ç²¾å‡†è¿‡æ»¤è¡Œä¸šã€ç±»ç›®ã€ä»·æ ¼åŒºé—´ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("èšåˆ")]),_._v("ï¼šç»Ÿè®¡æŸä¸ªå“ç±»ä¸‹çš„å“ç‰Œåˆ†å¸ƒã€ä»·æ ¼åŒºé—´åˆ†å¸ƒï¼ˆç”¨äºå•†å“ç­›é€‰é¢æ¿ï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("æ’åº")]),_._v("ï¼šç»¼åˆé”€é‡ã€ä»·æ ¼ã€æ—¶é—´ç­‰å­—æ®µï¼›éƒ¨åˆ†åœºæ™¯ç»“åˆ "),t("strong",[_._v("function_score")]),_._v(" åŠ¨æ€æ‰“åˆ†ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("6. æ€§èƒ½ä¼˜åŒ–")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("åˆ†ç‰‡è§„åˆ’")]),_._v("ï¼šå•ç´¢å¼• 10 äº¿æ•°æ®æ—¶ï¼Œåˆ†ç‰‡æ•°é‡æŒ‰ç£ç›˜ä¸æŸ¥è¯¢å¹¶å‘é‡è§„åˆ’ï¼Œä¿è¯å•åˆ†ç‰‡æ•°æ® <50GBã€‚")]),_._v(" "),t("li",[t("strong",[_._v("å†·çƒ­åˆ†ç¦»")]),_._v("ï¼šçƒ­èŠ‚ç‚¹å­˜å‚¨æœ€æ–°åœ¨å”®å•†å“ï¼Œå†·èŠ‚ç‚¹å­˜å‚¨å†å²ä¸‹æ¶æ•°æ®ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ç¼“å­˜")]),_._v("ï¼šåˆ©ç”¨ "),t("strong",[_._v("query cacheã€request cache")]),_._v("ï¼Œå¯¹äºé«˜é¢‘æŸ¥è¯¢åšç¼“å­˜ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("æ·±åˆ†é¡µä¼˜åŒ–")]),_._v("ï¼šé¿å… "),t("code",[_._v("from+size")]),_._v("ï¼Œç”¨ "),t("code",[_._v("search_after")]),_._v(" æˆ– "),t("code",[_._v("scroll")]),_._v("ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ç›‘æ§")]),_._v("ï¼šé€šè¿‡ Kibana + X-Pack ç›‘æ§æŸ¥è¯¢å»¶æ—¶ã€åˆ†ç‰‡åˆ†å¸ƒã€èŠ‚ç‚¹å¥åº·ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("7. é«˜å¯ç”¨ & æ‰©å±•")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("é›†ç¾¤æ¶æ„")]),_._v("ï¼šå¤šèŠ‚ç‚¹ï¼Œåˆ†ç‰‡+å‰¯æœ¬æœºåˆ¶ä¿è¯é«˜å¯ç”¨ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("å‰¯æœ¬åˆ†ç‰‡")]),_._v("ï¼š1 ä¸ªä¸»åˆ†ç‰‡ + 1 å‰¯æœ¬ï¼Œæ”¯æŒè¯»æ‰©å±•å’Œå®¹ç¾ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("æ‰©å±•æ€§")]),_._v("ï¼šæŒ‰è¡Œä¸šç‹¬ç«‹ç´¢å¼•ï¼Œå¯ä»¥æ¨ªå‘æ‰©å±•é›†ç¾¤ï¼Œå¢åŠ èŠ‚ç‚¹æ—¶åªéœ€é‡åˆ†é…åˆ†ç‰‡ã€‚")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-å¦‚æœå­˜å‚¨æ—¥å¿—æ•°æ®-å¦‚ä½•è®¾è®¡ç´¢å¼•-æŒ‰å¤©å»ºç´¢å¼•è¿˜æ˜¯æŒ‰æœˆå»ºç´¢å¼•-ä¸ºä»€ä¹ˆ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å¦‚æœå­˜å‚¨æ—¥å¿—æ•°æ®-å¦‚ä½•è®¾è®¡ç´¢å¼•-æŒ‰å¤©å»ºç´¢å¼•è¿˜æ˜¯æŒ‰æœˆå»ºç´¢å¼•-ä¸ºä»€ä¹ˆ"}},[_._v("#")]),_._v(" ğŸ¯ å¦‚æœå­˜å‚¨æ—¥å¿—æ•°æ®ï¼Œå¦‚ä½•è®¾è®¡ç´¢å¼•ï¼ŸæŒ‰å¤©å»ºç´¢å¼•è¿˜æ˜¯æŒ‰æœˆå»ºç´¢å¼•ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[_._v("åœ¨æ—¥å¿—åœºæ™¯ä¸‹ï¼Œé€šå¸¸ä¼šé‡‡ç”¨ "),t("strong",[_._v("æ—¶é—´åˆ†åŒºç´¢å¼•")]),_._v("ã€‚\nå¦‚æœæ—¥å¿—é‡å¤§ï¼Œæˆ‘ä¼š "),t("strong",[_._v("æŒ‰å¤©å»ºç´¢å¼•")]),_._v("ï¼Œè¿™æ ·æ¯ä¸ªç´¢å¼•çš„æ•°æ®é‡å¯æ§ï¼ŒæŸ¥è¯¢æ€§èƒ½é«˜ï¼Œåˆ é™¤æ—§æ•°æ®ä¹Ÿå¾ˆæ–¹ä¾¿ã€‚\nå¦‚æœæ—¥å¿—é‡æ¯”è¾ƒå°ï¼Œå¯ä»¥è€ƒè™‘ "),t("strong",[_._v("æŒ‰æœˆå»ºç´¢å¼•")]),_._v("ï¼Œé¿å…äº§ç”Ÿå¤ªå¤šå°ç´¢å¼•ã€‚\næˆ‘ä»¬ä¸€èˆ¬è¿˜ä¼šç»“åˆ "),t("strong",[_._v("ILM ç­–ç•¥")]),_._v("ï¼Œåœ¨çƒ­èŠ‚ç‚¹å­˜æ”¾è¿‘ 7 å¤©æ—¥å¿—ï¼Œå†·èŠ‚ç‚¹å­˜æ”¾å†å²æ—¥å¿—ï¼Œè¿‡æœŸæ•°æ®è‡ªåŠ¨åˆ é™¤ã€‚è¿™æ ·æ—¢èƒ½ä¿è¯æŸ¥è¯¢æ€§èƒ½ï¼Œä¹Ÿèƒ½èŠ‚çœå­˜å‚¨æˆæœ¬ã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("æ—¥å¿—æ•°æ®ç´¢å¼•è®¾è®¡æ€è·¯")])]),_._v(" "),t("p",[_._v("æ—¥å¿—æ•°æ®çš„ç‰¹ç‚¹ï¼š")]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("æ•°æ®é‡å¤§")]),_._v("ï¼ˆæ¯å¤©å¯èƒ½ä¸Šäº¿æ¡ç”šè‡³æ›´å¤šï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("åªå†™ä¸æ”¹")]),_._v("ï¼ˆæ—¥å¿—ä¸€æ—¦å†™å…¥åŸºæœ¬ä¸ä¼šæ›´æ–°ï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("æ—¶é—´åºåˆ—æ•°æ®")]),_._v("ï¼ˆæŸ¥è¯¢é€šå¸¸å¸¦æœ‰æ—¶é—´èŒƒå›´æ¡ä»¶ï¼Œæ¯”å¦‚è¿‘ 1 å°æ—¶ã€è¿‘ 1 å¤©ã€è¿‘ 1 å‘¨ï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("å†·çƒ­åˆ†ç¦»æ˜æ˜¾")]),_._v("ï¼ˆæ–°æ—¥å¿—æŸ¥å¾—å¤šï¼Œæ—§æ—¥å¿—æŸ¥å¾—å°‘ï¼‰ã€‚")])]),_._v(" "),t("p",[_._v("æ‰€ä»¥æ—¥å¿—åœºæ™¯ä¸‹ï¼Œ"),t("strong",[_._v("å¸¸ç”¨çš„æ–¹å¼æ˜¯æ—¶é—´åˆ†åŒºç´¢å¼•")]),_._v("ï¼š")]),_._v(" "),t("ul",[t("li",[t("code",[_._v("log-2025.08.19")]),_._v("ï¼ˆæŒ‰å¤©å»ºç´¢å¼•ï¼‰")]),_._v(" "),t("li",[t("code",[_._v("log-2025.08")]),_._v("ï¼ˆæŒ‰æœˆå»ºç´¢å¼•ï¼‰")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("æŒ‰å¤©å»ºç´¢å¼• vs æŒ‰æœˆå»ºç´¢å¼•")])]),_._v(" "),t("p",[t("strong",[_._v("æŒ‰å¤©å»ºç´¢å¼•")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("ä¼˜ç‚¹")]),_._v("ï¼š\n"),t("ol",[t("li",[_._v("å•ä¸ªç´¢å¼•æ•°æ®é‡å°ï¼ŒæŸ¥è¯¢æ€§èƒ½æ›´å¥½ã€‚")]),_._v(" "),t("li",[_._v("ç®¡ç†çµæ´»ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åˆ é™¤è¿‡æœŸæ•°æ®ï¼ˆæ¯”å¦‚ä¿ç•™ 30 å¤©æ—¥å¿—ï¼‰ã€‚")]),_._v(" "),t("li",[_._v("åˆ†ç‰‡åˆ†å¸ƒå‡è¡¡ï¼Œé¿å…è¶…å¤§ç´¢å¼•å¯¼è‡´åˆ†ç‰‡è¿‡å¤§ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("ç¼ºç‚¹")]),_._v("ï¼š\n"),t("ol",[t("li",[_._v("æ¯å¤©éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°ç´¢å¼•ï¼Œé›†ç¾¤é‡Œç´¢å¼•æ•°é‡ä¼šéå¸¸å¤šï¼ˆå‡ ç™¾ä¸Šåƒä¸ªï¼‰ã€‚")]),_._v(" "),t("li",[_._v("Elasticsearch æ¯ä¸ªç´¢å¼•éƒ½æœ‰å…ƒæ•°æ®å¼€é”€ï¼ˆé›†ç¾¤çŠ¶æ€å˜å¤§ï¼Œå†…å­˜å ç”¨ä¸Šå‡ï¼‰ã€‚")]),_._v(" "),t("li",[_._v("å¦‚æœæ—¥å¿—é‡ä¸å¤§ï¼ŒæŒ‰å¤©å»ºç´¢å¼•ä¼šå¯¼è‡´å¾ˆå¤šå°ç´¢å¼•ï¼Œèµ„æºåˆ©ç”¨ç‡ä¸é«˜ã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("æŒ‰æœˆå»ºç´¢å¼•")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("ä¼˜ç‚¹")]),_._v("ï¼š\n"),t("ol",[t("li",[_._v("ç´¢å¼•æ•°é‡å°‘ï¼Œé›†ç¾¤å…ƒæ•°æ®å‹åŠ›å°ã€‚")]),_._v(" "),t("li",[_._v("é€‚åˆæ—¥å¿—é‡å°çš„åœºæ™¯ï¼Œé¿å…å¤ªå¤šå°ç´¢å¼•ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("ç¼ºç‚¹")]),_._v("ï¼š\n"),t("ol",[t("li",[_._v("å•ä¸ªç´¢å¼•å¯èƒ½éå¸¸å¤§ï¼ˆå‡ åäº¿æ¡æ—¥å¿—ï¼‰ï¼Œåˆ†ç‰‡è¿‡å¤§å¯¼è‡´æŸ¥è¯¢æ…¢ã€è¿ç§»å›°éš¾ã€‚")]),_._v(" "),t("li",[_._v("åˆ é™¤æ—§æ•°æ®ä¸çµæ´»ï¼ˆåªèƒ½æ•´æœˆåˆ ï¼Œæ— æ³•åšåˆ°ç²¾ç¡®åˆ°å¤©ï¼‰ã€‚")]),_._v(" "),t("li",[_._v("æŸ¥è¯¢æ—¶å¿…é¡»æ‰«æå¾ˆå¤§çš„ç´¢å¼•ï¼Œæ€§èƒ½å·®ã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("æœ€ä½³å®è·µ")])]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("æ—¥å¿—é‡å¤§ï¼ˆ>åƒä¸‡/å¤©ï¼‰")]),_._v(" â†’ å»ºè®® "),t("strong",[_._v("æŒ‰å¤©å»ºç´¢å¼•")]),_._v("ï¼ˆ"),t("code",[_._v("log-YYYY.MM.dd")]),_._v("ï¼‰ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("æ—¥å¿—é‡è¾ƒå°ï¼ˆ<ç™¾ä¸‡/å¤©ï¼‰")]),_._v(" â†’ å¯ä»¥ "),t("strong",[_._v("æŒ‰æœˆå»ºç´¢å¼•")]),_._v("ï¼Œé¿å…è¿‡å¤šå°ç´¢å¼•ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("æ›´ä¼˜æ–¹æ¡ˆ")]),_._v("ï¼šä½¿ç”¨ "),t("strong",[_._v("Index Lifecycle Management (ILM)")]),_._v(" ç­–ç•¥\n"),t("ul",[t("li",[_._v("åœ¨çƒ­èŠ‚ç‚¹ä¿å­˜æœ€è¿‘ 7 å¤©ç´¢å¼•ï¼ˆé«˜æ€§èƒ½ SSDï¼‰ã€‚")]),_._v(" "),t("li",[_._v("å†·èŠ‚ç‚¹å­˜å‚¨å†å²æ—¥å¿—ï¼ˆæœºæ¢°ç›˜ï¼Œé™ä½æˆæœ¬ï¼‰ã€‚")]),_._v(" "),t("li",[_._v("è¶…è¿‡ 30 å¤©ç›´æ¥åˆ é™¤ç´¢å¼•ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("Rollup/åˆå¹¶ç´¢å¼•")]),_._v("ï¼šå¯¹äºé•¿æœŸä¿å­˜ä½†åªéœ€è¦ç»Ÿè®¡ç”¨é€”çš„æ—¥å¿—ï¼Œå¯ä»¥ç”¨ rollup jobï¼ŒæŠŠæ—§æ—¥å¿—å‹ç¼©ä¸ºæ±‡æ€»æ•°æ®ã€‚")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-å¦‚ä½•åœ¨-es-ä¸­å®ç°ç±»ä¼¼-sql-çš„-join-æ“ä½œ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å¦‚ä½•åœ¨-es-ä¸­å®ç°ç±»ä¼¼-sql-çš„-join-æ“ä½œ"}},[_._v("#")]),_._v(" ğŸ¯ å¦‚ä½•åœ¨ ES ä¸­å®ç°ç±»ä¼¼ SQL çš„ join æ“ä½œï¼Ÿ")]),_._v(" "),t("blockquote",[t("p",[_._v("Elasticsearch æœ¬èº«ä¸æ”¯æŒåƒ SQL é‚£æ ·çš„å¤æ‚ joinï¼Œå› ä¸ºæ•°æ®åˆ†å¸ƒåœ¨ä¸åŒåˆ†ç‰‡ä¸Šï¼Œæ€§èƒ½æˆæœ¬å¾ˆé«˜ã€‚\nå¸¸è§çš„æ›¿ä»£æ–¹å¼æœ‰ï¼š")]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("å†—ä½™å»ºæ¨¡")]),_._v("ï¼šæŠŠéœ€è¦ join çš„å­—æ®µç›´æ¥å†—ä½™åˆ°ä¸€ä¸ªæ–‡æ¡£é‡Œï¼Œæ€§èƒ½æœ€å¥½ï¼Œä¹Ÿæ˜¯æœ€æ¨èçš„ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("nested ç±»å‹")]),_._v("ï¼šé€‚åˆä¸€å¯¹å¤šçš„æ•°ç»„åœºæ™¯ï¼Œæ¯”å¦‚å•†å“çš„å¤šä¸ªå±æ€§æˆ–è¯„è®ºã€‚")]),_._v(" "),t("li",[t("strong",[_._v("parent-child å…³ç³»")]),_._v("ï¼šå¯ä»¥é¿å…å†—ä½™ï¼Œä½†æŸ¥è¯¢æ€§èƒ½ä¼šå·®ä¸€äº›ï¼Œåªé€‚åˆæ›´æ–°é¢‘ç¹ã€æ•°æ®é‡å¤§çš„åœºæ™¯ã€‚")]),_._v(" "),t("li",[_._v("è¿˜æœ‰ä¸€ç§æ–¹å¼æ˜¯åœ¨ "),t("strong",[_._v("åº”ç”¨å±‚åš join")]),_._v("ï¼Œç”±ä¸šåŠ¡ç³»ç»Ÿåšä¸¤æ¬¡æŸ¥è¯¢å†æ‹¼æ¥ç»“æœã€‚")])]),_._v(" "),t("p",[_._v("å®é™…é¡¹ç›®é‡Œï¼Œå¦‚æœæ—¥å¿—ã€å•†å“è¿™ç§åœºæ™¯ï¼Œæˆ‘ä¼šä¼˜å…ˆç”¨ "),t("strong",[_._v("æ‰å¹³åŒ–å»ºæ¨¡")]),_._v("ï¼Œä¿è¯æŸ¥è¯¢æ•ˆç‡ã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("1. ä¸ºä»€ä¹ˆ ES ä¸æ”¯æŒä¼ ç»Ÿçš„ joinï¼Ÿ")])]),_._v(" "),t("ul",[t("li",[_._v("ES æ˜¯ "),t("strong",[_._v("åˆ†å¸ƒå¼æ–‡æ¡£å­˜å‚¨")]),_._v("ï¼Œæ•°æ®è¢«åˆ†ç‰‡åˆ†æ•£å­˜å‚¨åœ¨ä¸åŒèŠ‚ç‚¹ä¸Šã€‚")]),_._v(" "),t("li",[_._v("SQL çš„ join éœ€è¦è·¨è¡¨åŒ¹é…æ•°æ®ï¼Œåœ¨ ES é‡Œä¼šå˜æˆè·¨ç´¢å¼•ã€è·¨åˆ†ç‰‡çš„å¤šæ¬¡ç½‘ç»œè¯·æ±‚ï¼Œæ€§èƒ½æå·®ã€‚")]),_._v(" "),t("li",[_._v("å› æ­¤ ES ä¸æ¨èåœ¨æŸ¥è¯¢é˜¶æ®µåš joinï¼Œè€Œæ˜¯é¼“åŠ± "),t("strong",[_._v("åœ¨å»ºæ¨¡é˜¶æ®µè®¾è®¡å¥½æ•°æ®ç»“æ„")]),_._v("ï¼Œé¿å… joinã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("2. æ›¿ä»£ join çš„å¸¸è§æ–¹å¼")])]),_._v(" "),t("p",[_._v("ï¼ˆ1ï¼‰"),t("strong",[_._v("æ•°æ®æ‰å¹³åŒ– / å†—ä½™ï¼ˆDenormalizationï¼‰")]),_._v(" ğŸ‘‰ æœ€æ¨è")]),_._v(" "),t("ul",[t("li",[_._v("æŠŠåŸæ¥éœ€è¦ join çš„æ•°æ®ï¼Œç›´æ¥å†—ä½™åˆ°ä¸€ä¸ªæ–‡æ¡£é‡Œã€‚")]),_._v(" "),t("li",[_._v("ä¾‹å¦‚ï¼šè®¢å•å’Œç”¨æˆ·ä¿¡æ¯\n"),t("ul",[t("li",[_._v("åœ¨ RDBMS é‡Œï¼š"),t("code",[_._v("order")]),_._v(" è¡¨ join "),t("code",[_._v("user")]),_._v(" è¡¨ã€‚")]),_._v(" "),t("li",[_._v("åœ¨ ES é‡Œï¼šæŠŠ "),t("code",[_._v("user_name")]),_._v("ã€"),t("code",[_._v("user_email")]),_._v(" å†—ä½™åˆ° "),t("code",[_._v("order")]),_._v(" æ–‡æ¡£ã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("ä¼˜ç‚¹")]),_._v("ï¼šæŸ¥è¯¢å¿«ï¼Œå¤©ç„¶é¿å… joinã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ç¼ºç‚¹")]),_._v("ï¼šæ•°æ®å†—ä½™è¾ƒå¤šï¼Œæ›´æ–°ç”¨æˆ·ä¿¡æ¯æ—¶è¦æ›´æ–°å¤šä»½æ•°æ®ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[_._v("ï¼ˆ2ï¼‰"),t("strong",[_._v("Nested ç±»å‹")]),_._v("ï¼ˆä¸€å¯¹å¤šï¼‰")]),_._v(" "),t("ul",[t("li",[_._v("é€‚åˆæ–‡æ¡£é‡ŒåµŒå¥—æ•°ç»„çš„åœºæ™¯ï¼Œæ¯”å¦‚å•†å“å’Œå•†å“è¯„è®ºã€‚")]),_._v(" "),t("li",[t("code",[_._v("nested")]),_._v(" å­—æ®µæ˜¯ç‹¬ç«‹çš„ Lucene æ–‡æ¡£ï¼Œä½†ä¸çˆ¶æ–‡æ¡£ç»‘å®šåœ¨ä¸€èµ·ã€‚")]),_._v(" "),t("li",[_._v("æŸ¥è¯¢æ—¶å¯ä»¥ä¿è¯åµŒå¥—å¯¹è±¡çš„ç‹¬ç«‹æ€§ï¼Œé¿å…â€œå­—æ®µäº¤å‰â€é—®é¢˜ã€‚")]),_._v(" "),t("li",[_._v("ç”¨æ³•ï¼š"),t("code",[_._v("nested query")]),_._v("ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("é€‚åˆåœºæ™¯")]),_._v("ï¼š\n"),t("ul",[t("li",[_._v("ä¸€ä¸ªå•†å“æœ‰å¤šä¸ªå±æ€§ï¼ˆkey-value å½¢å¼ï¼‰ã€‚")]),_._v(" "),t("li",[_._v("ä¸€ç¯‡æ–‡ç« æœ‰å¤šä¸ªè¯„è®ºã€‚")])])])]),_._v(" "),t("hr"),_._v(" "),t("p",[_._v("ï¼ˆ3ï¼‰"),t("strong",[_._v("Parent-Child å…³ç³»ï¼ˆjoin fieldï¼‰")])]),_._v(" "),t("ul",[t("li",[_._v("ç±»ä¼¼å…³ç³»å‹æ•°æ®åº“çš„â€œä¸€å¯¹å¤šâ€ã€‚")]),_._v(" "),t("li",[_._v("ä½¿ç”¨ "),t("code",[_._v("join")]),_._v(" ç±»å‹å­—æ®µå®šä¹‰ parent-child å…³ç³»ã€‚")]),_._v(" "),t("li",[_._v("ä¾‹å¦‚ï¼šä¸€ä¸ª "),t("code",[_._v("blog")]),_._v(" æ–‡æ¡£ï¼ˆparentï¼‰å’Œå¤šä¸ª "),t("code",[_._v("comment")]),_._v(" æ–‡æ¡£ï¼ˆchildï¼‰ã€‚")]),_._v(" "),t("li",[_._v("æŸ¥è¯¢æ—¶å¯ä»¥ï¼š\n"),t("ul",[t("li",[t("code",[_._v("has_child")]),_._v(" æŸ¥è¯¢ï¼šæ‰¾å‡ºæœ‰ç‰¹å®šè¯„è®ºçš„æ–‡ç« ã€‚")]),_._v(" "),t("li",[t("code",[_._v("has_parent")]),_._v(" æŸ¥è¯¢ï¼šæ‰¾å‡ºå±äºæŸç±»æ–‡ç« çš„è¯„è®ºã€‚")])])]),_._v(" "),t("li",[t("strong",[_._v("ä¼˜ç‚¹")]),_._v("ï¼šé¿å…æ•°æ®å†—ä½™ï¼Œæ›´æ–° child æ—¶ä¸éœ€è¦ä¿®æ”¹ parentã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ç¼ºç‚¹")]),_._v("ï¼šæŸ¥è¯¢æ€§èƒ½å·®ï¼Œjoin æ“ä½œæ¶ˆè€—å¤§ï¼›parent å’Œ child å¿…é¡»åœ¨åŒä¸€ä¸ª shardã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[_._v("ï¼ˆ4ï¼‰"),t("strong",[_._v("åº”ç”¨å±‚ Join")])]),_._v(" "),t("ul",[t("li",[_._v("åœ¨åº”ç”¨ç¨‹åºé‡Œè‡ªå·±æ‰§è¡Œä¸¤æ¬¡æŸ¥è¯¢ï¼Œç„¶ååœ¨å†…å­˜é‡Œåšå…³è”ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("é€‚åˆ")]),_._v("ï¼šæ•°æ®é‡ä¸å¤§ï¼Œä½†å¶å°”éœ€è¦ join çš„åœºæ™¯ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("ç¼ºç‚¹")]),_._v("ï¼šéœ€è¦ä¸¤æ¬¡æŸ¥è¯¢ï¼Œå¢åŠ åº”ç”¨å±‚é€»è¾‘ã€‚")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-elasticsearch-å¦‚ä½•å¤„ç†æ•°æ®çš„åˆ é™¤æ“ä½œ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-elasticsearch-å¦‚ä½•å¤„ç†æ•°æ®çš„åˆ é™¤æ“ä½œ"}},[_._v("#")]),_._v(" ğŸ¯ "),t("strong",[_._v("Elasticsearch å¦‚ä½•å¤„ç†æ•°æ®çš„åˆ é™¤æ“ä½œï¼Ÿ")])]),_._v(" "),t("p",[_._v("Elasticsearch ä½¿ç”¨çš„æ˜¯è½¯åˆ é™¤ï¼ˆsoft deleteï¼‰ï¼Œå³æ ‡è®°æ–‡æ¡£ä¸ºå·²åˆ é™¤ï¼Œè€Œä¸ç«‹å³åˆ é™¤æ–‡æ¡£ã€‚æœ€ç»ˆçš„åˆ é™¤æ“ä½œä¼šé€šè¿‡æ®µåˆå¹¶ï¼ˆsegment mergeï¼‰è¿›è¡Œæ¸…ç†ã€‚")]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-å¦‚æœè¦åˆ é™¤è¿‡æœŸæ•°æ®-æ€ä¹ˆåš-ilmã€rollover"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å¦‚æœè¦åˆ é™¤è¿‡æœŸæ•°æ®-æ€ä¹ˆåš-ilmã€rollover"}},[_._v("#")]),_._v(" ğŸ¯ å¦‚æœè¦åˆ é™¤è¿‡æœŸæ•°æ®ï¼Œæ€ä¹ˆåšï¼Ÿï¼ˆILMã€rolloverï¼‰")]),_._v(" "),t("blockquote",[t("p",[_._v("åœ¨ ES é‡Œåˆ é™¤è¿‡æœŸæ•°æ®æœ‰å‡ ç§æ–¹å¼ï¼š")]),_._v(" "),t("ul",[t("li",[_._v("æœ€ç®€å•çš„æ˜¯æ‰‹åŠ¨åˆ é™¤ç´¢å¼•ï¼Œæˆ–è€…è‡ªå·±å†™å®šæ—¶ä»»åŠ¡æ¯å¤©åˆ ã€‚")]),_._v(" "),t("li",[_._v("æ›´å¥½çš„æ–¹å¼æ˜¯ç»“åˆ "),t("strong",[_._v("æ—¶é—´åˆ†åŒºç´¢å¼•")]),_._v("ï¼Œæ¯å¤©ä¸€ä¸ªç´¢å¼•ï¼Œåˆ°æœŸç›´æ¥åˆ é™¤æ•´ä¸ªç´¢å¼•ï¼Œæ•ˆç‡å¾ˆé«˜ã€‚")]),_._v(" "),t("li",[_._v("åœ¨ç”Ÿäº§ç¯å¢ƒé‡Œé€šå¸¸ä¼šç”¨ "),t("strong",[_._v("ILM ç­–ç•¥")]),_._v("ï¼Œæ¯”å¦‚è®¾ç½®ç´¢å¼•æ¯å¤© rollover ä¸€ä¸ªæ–°ç´¢å¼•ï¼Œä¿ç•™ 30 å¤©åè‡ªåŠ¨åˆ é™¤ã€‚è¿™æ ·æ•´ä¸ªæµç¨‹å…¨è‡ªåŠ¨ï¼Œé¿å…äººå·¥å¹²é¢„ã€‚")])]),_._v(" "),t("p",[_._v("æˆ‘åœ¨é¡¹ç›®é‡Œä¼šæ¨è "),t("strong",[_._v("rollover + ILM")]),_._v("ï¼Œä¸€æ–¹é¢ä¿è¯å•ä¸ªç´¢å¼•ä¸ä¼šå¤ªå¤§ï¼Œå¦ä¸€æ–¹é¢å¯ä»¥è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ®ï¼Œåšåˆ°å†·çƒ­åˆ†ç¦»å’Œå­˜å‚¨èŠ‚çœã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("1. æ‰‹åŠ¨åˆ é™¤ç´¢å¼•")])]),_._v(" "),t("ul",[t("li",[_._v("æœ€ç®€å•ç²—æš´çš„æ–¹å¼ï¼Œç›´æ¥ "),t("code",[_._v("DELETE /index_name")]),_._v("ã€‚")]),_._v(" "),t("li",[_._v("ç¼ºç‚¹ï¼šéœ€è¦è‡ªå·±å†™å®šæ—¶ä»»åŠ¡ç®¡ç†ï¼Œäººå·¥æˆæœ¬é«˜ã€‚")]),_._v(" "),t("li",[_._v("é€‚åˆï¼šå°è§„æ¨¡æµ‹è¯•ç¯å¢ƒï¼Œä¸æ¨èç”Ÿäº§ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("2. æŒ‰æ—¶é—´åˆ†åŒºå»ºç´¢å¼• + å®šæœŸåˆ é™¤")])]),_._v(" "),t("ul",[t("li",[_._v("å¸¸è§åšæ³•æ˜¯æ—¥å¿—æŒ‰å¤©å»ºç´¢å¼•ï¼ˆ"),t("code",[_._v("logs-2025.08.19")]),_._v("ï¼‰ã€‚")]),_._v(" "),t("li",[_._v("è¿‡æœŸæ•°æ®ç›´æ¥åˆ é™¤æ•´ä¸ªç´¢å¼•ã€‚")]),_._v(" "),t("li",[_._v("ä¼˜ç‚¹ï¼šåˆ é™¤æ•ˆç‡é«˜ï¼ˆåˆ é™¤ç´¢å¼• = å…ƒæ•°æ®çº§åˆ«æ“ä½œï¼Œç§’çº§å®Œæˆï¼‰ã€‚")]),_._v(" "),t("li",[_._v("ç¼ºç‚¹ï¼šéœ€è¦é¢å¤–å†™å®šæ—¶ä»»åŠ¡ã€‚")])]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("3. ILMï¼ˆIndex Lifecycle Managementï¼‰ ğŸ‘‰ æ¨è")])]),_._v(" "),t("ul",[t("li",[_._v("ES æä¾›çš„è‡ªåŠ¨ç´¢å¼•ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚")]),_._v(" "),t("li",[_._v("å¯ä»¥å®šä¹‰ç´¢å¼•çš„ç”Ÿå‘½å‘¨æœŸç­–ç•¥ï¼š\n"),t("ul",[t("li",[t("strong",[_._v("Hot")]),_._v("ï¼šæ–°æ•°æ®å†™å…¥ï¼Œé«˜æ€§èƒ½å­˜å‚¨ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("Warm")]),_._v("ï¼šæ•°æ®è¾ƒæ—§ï¼Œè¿ç§»åˆ°ä½æ€§èƒ½èŠ‚ç‚¹ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("Cold")]),_._v("ï¼šæ›´æ—§çš„æ•°æ®ï¼Œåªè¯»ï¼Œæ”¾åœ¨å†·å­˜å‚¨ã€‚")]),_._v(" "),t("li",[t("strong",[_._v("Delete")]),_._v("ï¼šåˆ°æœŸåè‡ªåŠ¨åˆ é™¤ç´¢å¼•ã€‚")])])])]),_._v(" "),t("p",[t("strong",[_._v("ç¤ºä¾‹ç­–ç•¥")]),_._v("ï¼š")]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v('PUT _ilm/policy/logs_policy\n{\n  "policy": {\n    "phases": {\n      "hot": {\n        "actions": {\n          "rollover": {\n            "max_age": "1d",\n            "max_size": "50gb"\n          }\n        }\n      },\n      "delete": {\n        "min_age": "30d",\n        "actions": {\n          "delete": {}\n        }\n      }\n    }\n  }\n}\n')])])]),t("p",[_._v("ğŸ‘‰ è¡¨ç¤ºæ¯å¤© rollover æ–°ç´¢å¼•ï¼Œä¿ç•™ 30 å¤©åè‡ªåŠ¨åˆ é™¤ã€‚")]),_._v(" "),t("hr"),_._v(" "),t("p",[t("strong",[_._v("4. Rollover ç´¢å¼•")])]),_._v(" "),t("ul",[t("li",[_._v("é¿å…å•ä¸ªç´¢å¼•è¿‡å¤§ã€‚")]),_._v(" "),t("li",[_._v("ç´¢å¼•å‘½åé€šå¸¸å¸¦æœ‰ aliasï¼ˆåˆ«åï¼‰ã€‚")]),_._v(" "),t("li",[_._v("å½“æ»¡è¶³æ¡ä»¶ï¼ˆå¤§å°/æ–‡æ¡£æ•°/æ—¶é—´ï¼‰æ—¶ï¼Œè‡ªåŠ¨ rollover æ–°ç´¢å¼•ã€‚")]),_._v(" "),t("li",[_._v("ç»“åˆ ILM ä½¿ç”¨æ•ˆæœæœ€å¥½ï¼š\n"),t("ul",[t("li",[_._v("rollover è´Ÿè´£ã€Œåˆ‡æ¢æ–°ç´¢å¼•ã€ã€‚")]),_._v(" "),t("li",[_._v("ILM è´Ÿè´£ã€Œåˆ é™¤æ—§ç´¢å¼•ã€ã€‚")])])])]),_._v(" "),t("p",[t("strong",[_._v("ç¤ºä¾‹")]),_._v("ï¼š")]),_._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[_._v('POST /logs-write/_rollover\n{\n  "conditions": {\n    "max_age": "1d",\n    "max_size": "50gb"\n  }\n}\n')])])]),t("p",[_._v("ğŸ‘‰ å½“ç´¢å¼•è¾¾åˆ° 1 å¤©æˆ– 50GBï¼Œå°±ä¼šè‡ªåŠ¨åˆ›å»ºæ–°ç´¢å¼•ï¼Œå¹¶æŠŠå†™ alias åˆ‡æ¢åˆ°æ–°ç´¢å¼•ã€‚")]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-elasticsearch-å¦‚ä½•å®ç°æ•°æ®çš„é«˜å¯ç”¨æ€§"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-elasticsearch-å¦‚ä½•å®ç°æ•°æ®çš„é«˜å¯ç”¨æ€§"}},[_._v("#")]),_._v(" ğŸ¯ Elasticsearch å¦‚ä½•å®ç°æ•°æ®çš„é«˜å¯ç”¨æ€§ï¼Ÿ")]),_._v(" "),t("p",[_._v("é€šè¿‡å‰¯æœ¬ï¼ˆReplicaï¼‰æ¥å®ç°æ•°æ®çš„å†—ä½™å­˜å‚¨ï¼Œå‰¯æœ¬ä¸ä»…æä¾›å®¹é”™èƒ½åŠ›ï¼Œè¿˜å¯ä»¥ç”¨äºåˆ†æ‹…æŸ¥è¯¢è´Ÿè½½ã€‚")]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-å¦‚ä½•ä¼˜åŒ–-elasticsearch-çš„æŸ¥è¯¢æ€§èƒ½"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å¦‚ä½•ä¼˜åŒ–-elasticsearch-çš„æŸ¥è¯¢æ€§èƒ½"}},[_._v("#")]),_._v(" ğŸ¯ "),t("strong",[_._v("å¦‚ä½•ä¼˜åŒ– Elasticsearch çš„æŸ¥è¯¢æ€§èƒ½ï¼Ÿ")])]),_._v(" "),t("p",[_._v("ä¼˜åŒ–æŸ¥è¯¢å¯ä»¥é€šè¿‡åˆç†çš„ç´¢å¼•è®¾è®¡ã€ä½¿ç”¨è¿‡æ»¤å™¨ä»£æ›¿æŸ¥è¯¢ã€å‡å°‘ "),t("code",[_._v("wildcard")]),_._v(" å’Œ "),t("code",[_._v("regexp")]),_._v(" æŸ¥è¯¢çš„ä½¿ç”¨ç­‰æ–¹å¼å®ç°ã€‚")]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-å¦‚ä½•è®¾è®¡ä¸€ä¸ªé«˜æ•ˆçš„-elasticsearch-ç´¢å¼•"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å¦‚ä½•è®¾è®¡ä¸€ä¸ªé«˜æ•ˆçš„-elasticsearch-ç´¢å¼•"}},[_._v("#")]),_._v(" ğŸ¯ "),t("strong",[_._v("å¦‚ä½•è®¾è®¡ä¸€ä¸ªé«˜æ•ˆçš„ Elasticsearch ç´¢å¼•ï¼Ÿ")])]),_._v(" "),t("p",[_._v("è€ƒè™‘ç´¢å¼•çš„å­—æ®µç±»å‹ã€åˆ†æå™¨çš„é€‰æ‹©ã€æ˜¯å¦éœ€è¦æ’åºç­‰ã€‚é¿å…è¿‡å¤šçš„å­—æ®µã€é¿å…é«˜åŸºæ•°å­—æ®µã€åˆç†è®¾ç½®åˆ†ç‰‡å’Œå‰¯æœ¬æ•°ç­‰ã€‚")]),_._v(" "),t("h3",{attrs:{id:"ğŸ¯-elasticsearchäº†è§£å¤šå°‘-è¯´è¯´ä½ ä»¬å…¬å¸esçš„é›†ç¾¤æ¶æ„-ç´¢å¼•æ•°æ®å¤§å°-åˆ†ç‰‡æœ‰å¤šå°‘-ä»¥åŠä¸€äº›è°ƒä¼˜æ‰‹æ®µ"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-elasticsearchäº†è§£å¤šå°‘-è¯´è¯´ä½ ä»¬å…¬å¸esçš„é›†ç¾¤æ¶æ„-ç´¢å¼•æ•°æ®å¤§å°-åˆ†ç‰‡æœ‰å¤šå°‘-ä»¥åŠä¸€äº›è°ƒä¼˜æ‰‹æ®µ"}},[_._v("#")]),_._v(" ğŸ¯ Elasticsearchäº†è§£å¤šå°‘ï¼Œè¯´è¯´ä½ ä»¬å…¬å¸esçš„é›†ç¾¤æ¶æ„ï¼Œç´¢å¼•æ•°æ®å¤§å°ï¼Œåˆ†ç‰‡æœ‰å¤šå°‘ï¼Œä»¥åŠä¸€äº›è°ƒä¼˜æ‰‹æ®µ ï¼Ÿ")]),_._v(" "),t("p",[t("code",[_._v("é¢è¯•å®˜")]),_._v(" ï¼šæƒ³äº†è§£åº”è˜è€…ä¹‹å‰å…¬å¸æ¥è§¦çš„ESä½¿ç”¨åœºæ™¯ã€è§„æ¨¡ï¼Œæœ‰æ²¡æœ‰åšè¿‡æ¯”è¾ƒå¤§è§„æ¨¡çš„ç´¢å¼•è®¾è®¡ã€è§„åˆ’ã€è°ƒä¼˜ã€‚")]),_._v(" "),t("p",[t("code",[_._v("è§£ç­”")]),_._v(" ï¼šå¦‚å®ç»“åˆè‡ªå·±çš„å®è·µåœºæ™¯å›ç­”å³å¯ã€‚æ¯”å¦‚ï¼šESé›†ç¾¤æ¶æ„13ä¸ªèŠ‚ç‚¹ï¼Œç´¢å¼•æ ¹æ®é€šé“ä¸åŒå…±20+ç´¢å¼•ï¼Œæ ¹æ®æ—¥æœŸï¼Œæ¯æ—¥é€’å¢20+ï¼Œç´¢å¼•ï¼š10åˆ†ç‰‡ï¼Œæ¯æ—¥é€’å¢1äº¿+æ•°æ®ï¼Œæ¯ä¸ªé€šé“æ¯å¤©ç´¢å¼•å¤§å°æ§åˆ¶ï¼š150GBä¹‹å†…ã€‚")]),_._v(" "),t("p",[_._v("ä»…ç´¢å¼•å±‚é¢è°ƒä¼˜æ‰‹æ®µï¼š")]),_._v(" "),t("h4",{attrs:{id:"_1-1ã€è®¾è®¡é˜¶æ®µè°ƒä¼˜"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1ã€è®¾è®¡é˜¶æ®µè°ƒä¼˜"}},[_._v("#")]),_._v(" 1.1ã€è®¾è®¡é˜¶æ®µè°ƒä¼˜")]),_._v(" "),t("ul",[t("li",[_._v("æ ¹æ®ä¸šåŠ¡å¢é‡éœ€æ±‚ï¼Œé‡‡å–åŸºäºæ—¥æœŸæ¨¡æ¿åˆ›å»ºç´¢å¼•ï¼Œé€šè¿‡roll over APIæ»šåŠ¨ç´¢å¼•ï¼›")]),_._v(" "),t("li",[_._v("ä½¿ç”¨åˆ«åè¿›è¡Œç´¢å¼•ç®¡ç†ï¼›")]),_._v(" "),t("li",[_._v("æ¯å¤©å‡Œæ™¨å®šæ—¶å¯¹ç´¢å¼•åšforce_mergeæ“ä½œï¼Œä»¥é‡Šæ”¾ç©ºé—´ï¼›")]),_._v(" "),t("li",[_._v("é‡‡å–å†·çƒ­åˆ†ç¦»æœºåˆ¶ï¼Œçƒ­æ•°æ®å­˜å‚¨åˆ°SSDï¼Œæé«˜æ£€ç´¢æ•ˆç‡ï¼›å†·æ•°æ®å®šæœŸè¿›è¡Œshrinkæ“ä½œï¼Œä»¥ç¼©å‡å­˜å‚¨ï¼›")]),_._v(" "),t("li",[_._v("é‡‡å–curatorè¿›è¡Œç´¢å¼•çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼›")]),_._v(" "),t("li",[_._v("ä»…é’ˆå¯¹éœ€è¦åˆ†è¯çš„å­—æ®µï¼Œåˆç†çš„è®¾ç½®åˆ†è¯å™¨ï¼›")]),_._v(" "),t("li",[_._v("Mappingé˜¶æ®µå……åˆ†ç»“åˆå„ä¸ªå­—æ®µçš„å±æ€§ï¼Œæ˜¯å¦éœ€è¦æ£€ç´¢ã€æ˜¯å¦éœ€è¦å­˜å‚¨ç­‰ã€‚ â€¦â€¦..")])]),_._v(" "),t("h4",{attrs:{id:"_1-2ã€å†™å…¥è°ƒä¼˜"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2ã€å†™å…¥è°ƒä¼˜"}},[_._v("#")]),_._v(" 1.2ã€å†™å…¥è°ƒä¼˜")]),_._v(" "),t("ul",[t("li",[_._v("å†™å…¥å‰å‰¯æœ¬æ•°è®¾ç½®ä¸º0ï¼›")]),_._v(" "),t("li",[_._v("å†™å…¥å‰å…³é—­refresh_intervalè®¾ç½®ä¸º-1ï¼Œç¦ç”¨åˆ·æ–°æœºåˆ¶ï¼›")]),_._v(" "),t("li",[_._v("å†™å…¥è¿‡ç¨‹ä¸­ï¼šé‡‡å–bulkæ‰¹é‡å†™å…¥ï¼›")]),_._v(" "),t("li",[_._v("å†™å…¥åæ¢å¤å‰¯æœ¬æ•°å’Œåˆ·æ–°é—´éš”ï¼›")]),_._v(" "),t("li",[_._v("å°½é‡ä½¿ç”¨è‡ªåŠ¨ç”Ÿæˆçš„idã€‚")])]),_._v(" "),t("h4",{attrs:{id:"_1-3ã€æŸ¥è¯¢è°ƒä¼˜"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-3ã€æŸ¥è¯¢è°ƒä¼˜"}},[_._v("#")]),_._v(" 1.3ã€æŸ¥è¯¢è°ƒä¼˜")]),_._v(" "),t("ul",[t("li",[_._v("ç¦ç”¨wildcardï¼›")]),_._v(" "),t("li",[_._v("ç¦ç”¨æ‰¹é‡termsï¼ˆæˆç™¾ä¸Šåƒçš„åœºæ™¯ï¼‰ï¼›")]),_._v(" "),t("li",[_._v("å……åˆ†åˆ©ç”¨å€’æ’ç´¢å¼•æœºåˆ¶ï¼Œèƒ½keywordç±»å‹å°½é‡keywordï¼›")]),_._v(" "),t("li",[_._v("æ•°æ®é‡å¤§æ—¶å€™ï¼Œå¯ä»¥å…ˆåŸºäºæ—¶é—´æ•²å®šç´¢å¼•å†æ£€ç´¢ï¼›")]),_._v(" "),t("li",[_._v("è®¾ç½®åˆç†çš„è·¯ç”±æœºåˆ¶ã€‚")])]),_._v(" "),t("h4",{attrs:{id:"_1-4ã€å…¶ä»–è°ƒä¼˜"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-4ã€å…¶ä»–è°ƒä¼˜"}},[_._v("#")]),_._v(" 1.4ã€å…¶ä»–è°ƒä¼˜")]),_._v(" "),t("p",[_._v("éƒ¨ç½²è°ƒä¼˜ï¼Œä¸šåŠ¡è°ƒä¼˜ç­‰ã€‚")]),_._v(" "),t("p",[_._v("ä¸Šé¢çš„æåŠä¸€éƒ¨åˆ†ï¼Œé¢è¯•è€…å°±åŸºæœ¬å¯¹ä½ ä¹‹å‰çš„å®è·µæˆ–è€…è¿ç»´ç»éªŒæœ‰æ‰€è¯„ä¼°äº†ã€‚")]),_._v(" "),t("p",[t("strong",[_._v("æœç´¢å¼•æ“åŸç†")])]),_._v(" "),t("p",[_._v('ä¸€æ¬¡å®Œæ•´çš„æœç´¢ä»ç”¨æˆ·è¾“å…¥è¦æŸ¥è¯¢çš„å…³é”®è¯å¼€å§‹ï¼Œæ¯”å¦‚æƒ³æŸ¥æ‰¾ Lucene çš„ç›¸å…³å­¦ä¹ èµ„æ–™ï¼Œæˆ‘ä»¬éƒ½ä¼šåœ¨ Google æˆ–ç™¾åº¦ç­‰æœç´¢å¼•æ“ä¸­è¾“å…¥å…³é”®è¯ï¼Œæ¯”å¦‚è¾“å…¥"Lucene ï¼Œå…¨æ–‡æ£€ç´¢æ¡†æ¶"ï¼Œä¹‹åç³»ç»Ÿæ ¹æ®ç”¨æˆ·è¾“å…¥çš„å…³é”®è¯è¿”å›ç›¸å…³ä¿¡æ¯ã€‚ä¸€æ¬¡æ£€ç´¢å¤§è‡´å¯åˆ†ä¸ºå››æ­¥ï¼š')]),_._v(" "),t("p",[t("strong",[_._v("ç¬¬ä¸€æ­¥ï¼šæŸ¥è¯¢åˆ†æ")]),_._v('\næ­£å¸¸æƒ…å†µä¸‹ç”¨æˆ·è¾“å…¥æ­£ç¡®çš„æŸ¥è¯¢ï¼Œæ¯”å¦‚æœç´¢"é‡Œçº¦å¥¥è¿ä¼š"è¿™ä¸ªå…³é”®è¯ï¼Œç”¨æˆ·è¾“å…¥æ­£ç¡®å®Œæˆä¸€æ¬¡æœç´¢ï¼Œä½†æ˜¯æœç´¢é€šå¸¸éƒ½æ˜¯å…¨å¼€æ”¾çš„ï¼Œä»»ä½•çš„ç”¨æˆ·è¾“å…¥éƒ½æ˜¯æœ‰å¯èƒ½çš„ï¼Œå¾ˆå¤§ä¸€éƒ¨åˆ†è¿˜æ˜¯éå¸¸å£è¯­åŒ–å’Œä¸ªæ€§åŒ–çš„ï¼Œæœ‰æ—¶å€™è¿˜ä¼šå­˜åœ¨æ‹¼å†™é”™è¯¯ï¼Œç”¨æˆ·ä¸å°å¿ƒæŠŠ"æ·˜å®"æ‰“æˆ"æ¶›å®"ï¼Œè¿™æ—¶å€™éœ€è¦ç”¨è‡ªç„¶è¯­è¨€å¤„ç†æŠ€æœ¯æ¥åšæ‹¼å†™çº é”™ç­‰å¤„ç†ï¼Œä»¥æ­£ç¡®ç†è§£ç”¨æˆ·éœ€æ±‚ã€‚')]),_._v(" "),t("p",[t("strong",[_._v("ç¬¬äºŒæ­¥ï¼šåˆ†è¯æŠ€æœ¯")]),_._v('\nè¿™ä¸€æ­¥åˆ©ç”¨è‡ªç„¶è¯­è¨€å¤„ç†æŠ€æœ¯å°†ç”¨æˆ·è¾“å…¥çš„æŸ¥è¯¢è¯­å¥è¿›è¡Œåˆ†è¯ï¼Œå¦‚æ ‡å‡†åˆ†è¯ä¼šæŠŠ"luceneå…¨æ–‡æ£€ç´¢æ¡†æ¶"åˆ†æˆ lucene | å…¨ | æ–‡ï½œæ£€ï½œç´¢ï½œæ¡†ï½œæ¶ï½œï¼Œ IKåˆ†è¯ä¼šåˆ†æˆï¼š luceneï½œå…¨æ–‡ï½œæ£€ç´¢ï½œæ¡†æ¶ï½œ,è¿˜æœ‰ç®€å•åˆ†è¯ç­‰å¤šç§åˆ†è¯æ–¹æ³•ã€‚')]),_._v(" "),t("p",[t("strong",[_._v("ç¬¬ä¸‰æ­¥ï¼šå…³é”®è¯æ£€ç´¢")]),_._v('\næäº¤å…³é”®è¯ååœ¨å€’æ’ç´¢å¼•åº“ä¸­è¿›è¡ŒåŒ¹é…ï¼Œå€’æ’ç´¢å¼•å°±æ˜¯å…³é”®è¯å’Œæ–‡æ¡£ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼Œå°±åƒç»™æ–‡æ¡£è´´ä¸Šæ ‡ç­¾ã€‚æ¯”å¦‚åœ¨æ–‡æ¡£é›†ä¸­å«æœ‰ "lucene" å…³é”®è¯çš„æœ‰æ–‡æ¡£1 ã€æ–‡æ¡£ 6ã€æ–‡æ¡£9ï¼Œå«æœ‰ "å…¨æ–‡æ£€ç´¢" å…³é”®è¯çš„æœ‰æ–‡æ¡£1 ã€æ–‡æ¡£6 é‚£ä¹ˆåšä¸è¿ç®—ï¼ŒåŒæ—¶å«æœ‰ "lucene" å’Œ "å…¨æ–‡æ£€ç´¢" çš„æ–‡æ¡£å°±æ˜¯æ–‡æ¡£1å’Œæ–‡æ¡£6ï¼Œåœ¨å®é™…çš„æœç´¢ä¸­ä¼šæœ‰æ›´å¤æ‚çš„æ–‡æ¡£åŒ¹é…æ¨¡å‹ã€‚')]),_._v(" "),t("p",[t("strong",[_._v("ç¬¬å››æ­¥ï¼šæœç´¢æ’åº")]),_._v("\nå¯¹å¤šä¸ªç›¸å…³æ–‡æ¡£è¿›è¡Œç›¸å…³åº¦è®¡ç®—ã€æ’åºï¼Œè¿”å›ç»™ç”¨æˆ·æ£€ç´¢ç»“æœã€‚")]),_._v(" "),t("hr"),_._v(" "),t("h2",{attrs:{id:"ğŸ¯-esé¢è¯•å¤‡æˆ˜æŒ‡å—"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-esé¢è¯•å¤‡æˆ˜æŒ‡å—"}},[_._v("#")]),_._v(" ğŸ¯ ESé¢è¯•å¤‡æˆ˜æŒ‡å—")]),_._v(" "),t("h3",{attrs:{id:"ğŸ’¡-é«˜é¢‘è€ƒç‚¹top10"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ’¡-é«˜é¢‘è€ƒç‚¹top10"}},[_._v("#")]),_._v(" ğŸ’¡ é«˜é¢‘è€ƒç‚¹Top10")]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("ğŸ”¥ å€’æ’ç´¢å¼•åŸç†")]),_._v(" - å¿…è€ƒæ¦‚å¿µï¼Œè¦èƒ½ç”¨å¤§ç™½è¯è§£é‡Šæ¸…æ¥š")]),_._v(" "),t("li",[t("strong",[_._v("âš¡ åˆ†ç‰‡å’Œå‰¯æœ¬æœºåˆ¶")]),_._v(" - é«˜å¯ç”¨æ¶æ„çš„æ ¸å¿ƒï¼Œè¦ç†è§£åˆ†ç‰‡å¦‚ä½•æå‡æ€§èƒ½")]),_._v(" "),t("li",[t("strong",[_._v("ğŸ“Š å†™å…¥å’ŒæŸ¥è¯¢æµç¨‹")]),_._v(" - ä½“ç°å¯¹ESå†…éƒ¨æœºåˆ¶çš„æŒæ¡ç¨‹åº¦")]),_._v(" "),t("li",[t("strong",[_._v("ğŸš¨ è„‘è£‚é—®é¢˜")]),_._v(" - åˆ†å¸ƒå¼ç³»ç»Ÿç»å…¸é—®é¢˜ï¼Œè§£å†³æ€è·¯è¦æ¸…æ™°")]),_._v(" "),t("li",[t("strong",[_._v("âš™ï¸ refresh/flush/merge")]),_._v(" - è¿‘å®æ—¶æœç´¢çš„åº•å±‚åŸç†")]),_._v(" "),t("li",[t("strong",[_._v("ğŸ” æ·±åˆ†é¡µä¼˜åŒ–")]),_._v(" - scroll vs search_afterçš„é€‰æ‹©ç­–ç•¥")]),_._v(" "),t("li",[t("strong",[_._v("ğŸ’¾ æ€§èƒ½è°ƒä¼˜")]),_._v(" - å†™å…¥å’ŒæŸ¥è¯¢ä¸¤æ–¹é¢çš„ä¼˜åŒ–æ‰‹æ®µ")]),_._v(" "),t("li",[t("strong",[_._v("ğŸ—ï¸ ç´¢å¼•è®¾è®¡")]),_._v(" - Mappingè®¾è®¡ã€å­—æ®µç±»å‹é€‰æ‹©ã€åˆ†è¯å™¨é…ç½®")]),_._v(" "),t("li",[t("strong",[_._v("ğŸ“ˆ èšåˆåˆ†æ")]),_._v(" - å¤æ‚æ•°æ®ç»Ÿè®¡åœºæ™¯çš„å®ç°æ–¹å¼")]),_._v(" "),t("li",[t("strong",[_._v("ğŸ’¼ å®é™…é¡¹ç›®ç»éªŒ")]),_._v(" - èƒ½ç»“åˆå…·ä½“åœºæ™¯è°ˆæŠ€æœ¯é€‰å‹å’Œæ¶æ„è®¾è®¡")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ­-é¢è¯•ç­”é¢˜æŠ€å·§"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ­-é¢è¯•ç­”é¢˜æŠ€å·§"}},[_._v("#")]),_._v(" ğŸ­ é¢è¯•ç­”é¢˜æŠ€å·§")]),_._v(" "),t("p",[t("strong",[_._v("ğŸ“ æ ‡å‡†å›ç­”ç»“æ„")])]),_._v(" "),t("ol",[t("li",[t("strong",[_._v("æ¦‚å¿µå®šä¹‰")]),_._v("ï¼ˆ30ç§’ï¼‰ - ç”¨ä¸€å¥è¯è¯´æ¸…æ¥šæ˜¯ä»€ä¹ˆ")]),_._v(" "),t("li",[t("strong",[_._v("æ ¸å¿ƒç‰¹ç‚¹")]),_._v("ï¼ˆ1åˆ†é’Ÿï¼‰ - çªå‡ºå…³é”®ä¼˜åŠ¿å’Œæœºåˆ¶")]),_._v(" "),t("li",[t("strong",[_._v("åº”ç”¨åœºæ™¯")]),_._v("ï¼ˆ30ç§’ï¼‰ - ä»€ä¹ˆæ—¶å€™ç”¨ï¼Œè§£å†³ä»€ä¹ˆé—®é¢˜")]),_._v(" "),t("li",[t("strong",[_._v("å…·ä½“ç¤ºä¾‹")]),_._v("ï¼ˆ1åˆ†é’Ÿï¼‰ - æœ€å¥½æ˜¯è‡ªå·±é¡¹ç›®çš„çœŸå®æ¡ˆä¾‹")]),_._v(" "),t("li",[t("strong",[_._v("æ³¨æ„äº‹é¡¹")]),_._v("ï¼ˆ30ç§’ï¼‰ - ä½“ç°æ·±åº¦æ€è€ƒå’Œå®æˆ˜ç»éªŒ")])]),_._v(" "),t("p",[t("strong",[_._v("ğŸ—£ï¸ è¡¨è¾¾è¯æœ¯æ¨¡æ¿")])]),_._v(" "),t("ul",[t("li",[_._v('"ä»æˆ‘çš„é¡¹ç›®ç»éªŒæ¥çœ‹..."')]),_._v(" "),t("li",[_._v('"åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼š..."')]),_._v(" "),t("li",[_._v('"è¿™é‡Œæœ‰ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹æ˜¯..."')]),_._v(" "),t("li",[_._v('"ç›¸æ¯”äºä¼ ç»Ÿæ–¹æ¡ˆï¼ŒESçš„ä¼˜åŠ¿åœ¨äº..."')]),_._v(" "),t("li",[_._v('"åœ¨å¤§è§„æ¨¡æ•°æ®åœºæ™¯ä¸‹ï¼Œæ¨èçš„åšæ³•æ˜¯..."')])]),_._v(" "),t("h3",{attrs:{id:"ğŸš€-è¿›é˜¶åŠ åˆ†ç‚¹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸš€-è¿›é˜¶åŠ åˆ†ç‚¹"}},[_._v("#")]),_._v(" ğŸš€ è¿›é˜¶åŠ åˆ†ç‚¹")]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("åº•å±‚åŸç†")]),_._v("ï¼šèƒ½ä»Luceneå±‚é¢è§£é‡ŠESçš„å®ç°æœºåˆ¶")]),_._v(" "),t("li",[t("strong",[_._v("æ€§èƒ½è°ƒä¼˜")]),_._v("ï¼šæœ‰å…·ä½“çš„ä¼˜åŒ–æ•°æ®å’Œæ•ˆæœå¯¹æ¯”")]),_._v(" "),t("li",[t("strong",[_._v("æ¶æ„è®¾è®¡")]),_._v("ï¼šèƒ½è®¾è®¡é€‚åˆä¸šåŠ¡åœºæ™¯çš„ESé›†ç¾¤æ–¹æ¡ˆ")]),_._v(" "),t("li",[t("strong",[_._v("æ•…éšœå¤„ç†")]),_._v("ï¼šæœ‰æ’æŸ¥å’Œè§£å†³çº¿ä¸ŠESé—®é¢˜çš„ç»éªŒ")]),_._v(" "),t("li",[t("strong",[_._v("æŠ€æœ¯é€‰å‹")]),_._v("ï¼šèƒ½å‡†ç¡®åˆ†æESä¸å…¶ä»–å­˜å‚¨æŠ€æœ¯çš„é€‚ç”¨åœºæ™¯")])]),_._v(" "),t("h3",{attrs:{id:"ğŸ“š-å»¶ä¼¸å­¦ä¹ å»ºè®®"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“š-å»¶ä¼¸å­¦ä¹ å»ºè®®"}},[_._v("#")]),_._v(" ğŸ“š å»¶ä¼¸å­¦ä¹ å»ºè®®")]),_._v(" "),t("ul",[t("li",[t("strong",[_._v("å®˜æ–¹æ–‡æ¡£")]),_._v("ï¼šESå®˜æ–¹Guideæ˜¯æœ€æƒå¨çš„å­¦ä¹ èµ„æ–™")]),_._v(" "),t("li",[t("strong",[_._v("å®æˆ˜ç»ƒä¹ ")]),_._v("ï¼šæ­å»ºæœ¬åœ°ESç¯å¢ƒï¼ŒåŠ¨æ‰‹éªŒè¯å„ç§é…ç½®")]),_._v(" "),t("li",[t("strong",[_._v("æºç é˜…è¯»")]),_._v("ï¼šæœ‰ä½™åŠ›å¯ä»¥ç ”ç©¶ESæ ¸å¿ƒæ¨¡å—çš„æºç å®ç°")]),_._v(" "),t("li",[t("strong",[_._v("æ¡ˆä¾‹åˆ†æ")]),_._v("ï¼šå¤šçœ‹å¤§å‚çš„ESåº”ç”¨æ¡ˆä¾‹å’Œæœ€ä½³å®è·µ")]),_._v(" "),t("li",[t("strong",[_._v("æŠ€æœ¯åšå®¢")]),_._v("ï¼šå…³æ³¨ESç›¸å…³çš„æŠ€æœ¯åšå®¢å’Œè®ºå›è®¨è®º")])]),_._v(" "),t("hr"),_._v(" "),t("h2",{attrs:{id:"ğŸ‰-æ€»ç»“"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ‰-æ€»ç»“"}},[_._v("#")]),_._v(" ğŸ‰ æ€»ç»“")]),_._v(" "),t("p",[t("strong",[_._v("Elasticsearchä½œä¸ºç°ä»£æœç´¢æŠ€æœ¯æ ˆçš„æ ¸å¿ƒ")]),_._v("ï¼Œå·²ç»æˆä¸ºå„å¤§äº’è”ç½‘å…¬å¸çš„åŸºç¡€è®¾æ–½ã€‚æŒæ¡ESä¸ä»…æ˜¯é¢è¯•åŠ åˆ†é¡¹ï¼Œæ›´æ˜¯æŠ€æœ¯èƒ½åŠ›çš„é‡è¦ä½“ç°ã€‚")]),_._v(" "),t("p",[t("strong",[_._v("è®°ä½ï¼šé¢è¯•å®˜è€ƒå¯Ÿçš„ä¸æ˜¯ä½ èƒŒäº†å¤šå°‘æ¦‚å¿µï¼Œè€Œæ˜¯ä½ èƒ½å¦åœ¨å®é™…é¡¹ç›®ä¸­çµæ´»è¿ç”¨ESè§£å†³ä¸šåŠ¡é—®é¢˜ã€‚")])]),_._v(" "),t("p",[t("strong",[_._v("æœ€åä¸€å¥è¯")]),_._v("ï¼š"),t("em",[_._v('"çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œç»çŸ¥æ­¤äº‹è¦èº¬è¡Œ"')]),_._v(" - å†å¤šçš„ç†è®ºçŸ¥è¯†éƒ½ä¸å¦‚äº²æ‰‹æ­å»ºä¸€ä¸ªESé›†ç¾¤æ¥å¾—æ·±åˆ»ï¼")]),_._v(" "),t("hr"),_._v(" "),t("blockquote",[t("p",[_._v("ğŸ’Œ "),t("strong",[_._v("åšæŒå­¦ä¹ ï¼ŒæŒç»­æˆé•¿ï¼")]),t("br"),_._v("\nå¦‚æœè¿™ä»½ææ–™å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè®°å¾—åœ¨å®é™…é¢è¯•ä¸­ç»“åˆè‡ªå·±çš„ç†è§£å’Œç»éªŒæ¥å›ç­”ï¼Œè®©æŠ€æœ¯çŸ¥è¯†çœŸæ­£ä¸ºä½ æ‰€ç”¨ï¼")])])])}),[],!1,null,null,null);v.default=r.exports}}]);