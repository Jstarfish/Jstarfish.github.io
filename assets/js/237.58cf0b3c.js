(window.webpackJsonp=window.webpackJsonp||[]).push([[237],{729:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[a("img",{attrs:{src:"https://img.starfish.ink/common/faq-banner.png",alt:""}})]),t._v(" "),a("p",[t._v("RPCä½œä¸ºåˆ†å¸ƒå¼ç³»ç»Ÿçš„"),a("strong",[t._v("æ ¸å¿ƒé€šä¿¡æœºåˆ¶")]),t._v("ï¼Œæ˜¯Javaåç«¯é¢è¯•çš„"),a("strong",[t._v("å¿…è€ƒé‡ç‚¹")]),t._v("ã€‚ä»åŸºç¡€åŸç†åˆ°æ¡†æ¶å®ç°ï¼Œä»æ€§èƒ½ä¼˜åŒ–åˆ°æœåŠ¡æ²»ç†ï¼Œæ¯ä¸ªçŸ¥è¯†ç‚¹éƒ½å¯èƒ½æˆä¸ºé¢è¯•çš„å…³é”®ã€‚æœ¬æ–‡æ¡£å°†"),a("strong",[t._v("RPCæ ¸å¿ƒæŠ€æœ¯")]),t._v("æ•´ç†æˆ"),a("strong",[t._v("ç³»ç»ŸåŒ–çŸ¥è¯†ä½“ç³»")]),t._v("ï¼Œæ¶µç›–åè®®è®¾è®¡ã€åºåˆ—åŒ–æœºåˆ¶ã€è´Ÿè½½å‡è¡¡ç­‰å…³é”®é¢†åŸŸï¼ŒåŠ©ä½ åœ¨é¢è¯•ä¸­æ¸¸åˆƒæœ‰ä½™ï¼")]),t._v(" "),a("p",[t._v("RPC é¢è¯•ï¼Œå›´ç»•ç€è¿™ä¹ˆå‡ ä¸ªæ ¸å¿ƒæ–¹å‘å‡†å¤‡ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("RPCåŸºç¡€åŸç†")]),t._v("ï¼ˆè°ƒç”¨æµç¨‹ã€åè®®è®¾è®¡ã€ç½‘ç»œé€šä¿¡ã€ä»£ç†æœºåˆ¶ï¼‰")]),t._v(" "),a("li",[a("strong",[t._v("åºåˆ—åŒ–ä¸åè®®")]),t._v("ï¼ˆProtobufã€JSONã€Hessianã€è‡ªå®šä¹‰åè®®è®¾è®¡ï¼‰")]),t._v(" "),a("li",[a("strong",[t._v("æœåŠ¡å‘ç°ä¸æ²»ç†")]),t._v("ï¼ˆæ³¨å†Œä¸­å¿ƒã€è´Ÿè½½å‡è¡¡ã€ç†”æ–­é™çº§ã€é™æµæœºåˆ¶ï¼‰")]),t._v(" "),a("li",[a("strong",[t._v("æ€§èƒ½ä¼˜åŒ–")]),t._v("ï¼ˆè¿æ¥å¤ç”¨ã€å¼‚æ­¥è°ƒç”¨ã€æ‰¹é‡å¤„ç†ã€ç½‘ç»œè°ƒä¼˜ï¼‰")]),t._v(" "),a("li",[a("strong",[t._v("ä¸»æµæ¡†æ¶å¯¹æ¯”")]),t._v("ï¼ˆDubboã€gRPCã€Thriftã€Spring Cloudå¯¹æ¯”åˆ†æï¼‰")]),t._v(" "),a("li",[a("strong",[t._v("é«˜çº§ç‰¹æ€§")]),t._v("ï¼ˆæ³›åŒ–è°ƒç”¨ã€å¤šç‰ˆæœ¬æ”¯æŒã€ç°åº¦å‘å¸ƒã€ç›‘æ§åŸ‹ç‚¹ï¼‰")]),t._v(" "),a("li",[a("strong",[t._v("å®æˆ˜åº”ç”¨")]),t._v("ï¼ˆæ¶æ„è®¾è®¡ã€é—®é¢˜æ’æŸ¥ã€æ€§èƒ½è°ƒä¼˜ã€æœ€ä½³å®è·µï¼‰")])]),t._v(" "),a("h2",{attrs:{id:"ğŸ—ºï¸-çŸ¥è¯†å¯¼èˆª"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ—ºï¸-çŸ¥è¯†å¯¼èˆª"}},[t._v("#")]),t._v(" ğŸ—ºï¸ çŸ¥è¯†å¯¼èˆª")]),t._v(" "),a("h3",{attrs:{id:"ğŸ·ï¸-æ ¸å¿ƒçŸ¥è¯†åˆ†ç±»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ·ï¸-æ ¸å¿ƒçŸ¥è¯†åˆ†ç±»"}},[t._v("#")]),t._v(" ğŸ·ï¸ æ ¸å¿ƒçŸ¥è¯†åˆ†ç±»")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("åŸºç¡€ä¸åŸç†")]),t._v("ï¼šRPCå®šä¹‰ã€è°ƒç”¨æµç¨‹ã€ç½‘ç»œé€šä¿¡ã€ä»£ç†å®ç°")]),t._v(" "),a("li",[a("strong",[t._v("åè®®ä¸åºåˆ—åŒ–")]),t._v("ï¼šä¼ è¾“åè®®ã€åºåˆ—åŒ–æ–¹æ¡ˆã€ç¼–è§£ç ä¼˜åŒ–")]),t._v(" "),a("li",[a("strong",[t._v("æœåŠ¡æ²»ç†")]),t._v("ï¼šæ³¨å†Œå‘ç°ã€è´Ÿè½½å‡è¡¡ã€å®¹é”™æœºåˆ¶ã€é…ç½®ç®¡ç†")]),t._v(" "),a("li",[a("strong",[t._v("æ€§èƒ½ä¸è°ƒä¼˜")]),t._v("ï¼šè¿æ¥ç®¡ç†ã€å¼‚æ­¥å¤„ç†ã€æ‰¹é‡ä¼˜åŒ–ã€ç›‘æ§æŒ‡æ ‡")]),t._v(" "),a("li",[a("strong",[t._v("æ¡†æ¶å¯¹æ¯”")]),t._v("ï¼šDubboã€gRPCã€Thriftç­‰ä¸»æµæ¡†æ¶ç‰¹æ€§åˆ†æ")]),t._v(" "),a("li",[a("strong",[t._v("å·¥ç¨‹å®è·µ")]),t._v("ï¼šæ¶æ„è®¾è®¡ã€é—®é¢˜æ’æŸ¥ã€è¿ç»´ç›‘æ§ã€æœ€ä½³å®è·µ")])]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"ğŸ§ -ä¸€ã€rpcåŸºç¡€ä¸åŸç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ§ -ä¸€ã€rpcåŸºç¡€ä¸åŸç†"}},[t._v("#")]),t._v(" ğŸ§  ä¸€ã€RPCåŸºç¡€ä¸åŸç†")]),t._v(" "),a("p",[a("strong",[t._v("æ ¸å¿ƒç†å¿µ")]),t._v("ï¼šRPCè®©åˆ†å¸ƒå¼è°ƒç”¨åƒæœ¬åœ°è°ƒç”¨ä¸€æ ·ç®€å•ï¼Œé€šè¿‡ç½‘ç»œé€šä¿¡ã€åºåˆ—åŒ–ã€ä»£ç†æœºåˆ¶å®ç°è¿œç¨‹æœåŠ¡é€æ˜è°ƒç”¨ã€‚")]),t._v(" "),a("h3",{attrs:{id:"ğŸ¯-ä»€ä¹ˆæ˜¯-rpc-å®ƒå’Œ-http-rest-æœ‰ä»€ä¹ˆåŒºåˆ«"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-ä»€ä¹ˆæ˜¯-rpc-å®ƒå’Œ-http-rest-æœ‰ä»€ä¹ˆåŒºåˆ«"}},[t._v("#")]),t._v(" ğŸ¯ ä»€ä¹ˆæ˜¯ RPCï¼Ÿå®ƒå’Œ HTTP/REST æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ")]),t._v(" "),a("blockquote",[a("p",[t._v("RPC æ˜¯è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯è®©è°ƒç”¨è¿œç¨‹æœåŠ¡åƒæœ¬åœ°å‡½æ•°è°ƒç”¨ä¸€æ ·ç®€å•ã€‚å®ƒå±è”½äº†ç½‘ç»œé€šä¿¡ã€åºåˆ—åŒ–ã€ååºåˆ—åŒ–ç­‰ç»†èŠ‚ã€‚å’Œ HTTP/REST ç›¸æ¯”ï¼ŒRPC æ›´åå‘äºå†…éƒ¨æœåŠ¡é—´é€šä¿¡ï¼Œé€šå¸¸ä½¿ç”¨äºŒè¿›åˆ¶åºåˆ—åŒ–ï¼ˆæ¯”å¦‚ Protobufï¼‰ï¼Œæ€§èƒ½æ›´é«˜ï¼Œæ”¯æŒæµå¼é€šä¿¡ï¼›è€Œ REST åŸºäº HTTP + JSONï¼Œè·¨è¯­è¨€ã€å¯è¯»æ€§å’Œè°ƒè¯•å‹å¥½ï¼Œæ›´é€‚åˆå¯¹å¤–æ¥å£ã€‚\nåœ¨å®é™…é¡¹ç›®é‡Œï¼Œæˆ‘ä»¬å¸¸å¸¸ "),a("strong",[t._v("å¯¹å†…ç”¨ RPCï¼ˆgRPCï¼‰æå‡æ€§èƒ½ï¼Œå¯¹å¤–ç”¨ REST ä¿è¯é€šç”¨æ€§")]),t._v("ã€‚")])]),t._v(" "),a("p",[a("strong",[t._v("ä»€ä¹ˆæ˜¯ RPCï¼Ÿ")])]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("RPCï¼ˆRemote Procedure Callï¼Œè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰")]),t._v(" æ˜¯ä¸€ç§ "),a("strong",[t._v("åƒè°ƒç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·è°ƒç”¨è¿œç¨‹æœåŠ¡çš„æ–¹æ³•")]),t._v("ã€‚")]),t._v(" "),a("li",[t._v("æœ¬è´¨ï¼šå±è”½ç½‘ç»œé€šä¿¡ç»†èŠ‚ï¼ˆåºåˆ—åŒ–ã€ä¼ è¾“ã€ååºåˆ—åŒ–ï¼‰ï¼Œè®©å¼€å‘è€…åƒè°ƒç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·è°ƒç”¨è¿œç¨‹å‡½æ•°ã€‚")]),t._v(" "),a("li",[t._v("æ ¸å¿ƒæ­¥éª¤ï¼š\n"),a("ol",[a("li",[a("strong",[t._v("å®¢æˆ·ç«¯ Stub")]),t._v("ï¼šå°†è°ƒç”¨æ–¹æ³•å’Œå‚æ•°åºåˆ—åŒ–")]),t._v(" "),a("li",[a("strong",[t._v("ç½‘ç»œä¼ è¾“")]),t._v("ï¼šé€šè¿‡ TCP/HTTP/HTTP2 ä¼ è¾“åˆ°è¿œç¨‹æœåŠ¡")]),t._v(" "),a("li",[a("strong",[t._v("æœåŠ¡ç«¯ Stub")]),t._v("ï¼šååºåˆ—åŒ–å‚æ•°ï¼Œæ‰§è¡Œå®é™…é€»è¾‘")]),t._v(" "),a("li",[a("strong",[t._v("ç»“æœè¿”å›")]),t._v("ï¼šåºåˆ—åŒ–ç»“æœï¼Œé€šè¿‡ç½‘ç»œè¿”å›ç»™å®¢æˆ·ç«¯")])])]),t._v(" "),a("li",[a("strong",[t._v("å…³é”®ç‚¹")]),t._v("ï¼š\n"),a("ul",[a("li",[a("strong",[t._v("é€šä¿¡åè®®")]),t._v("ï¼šå¦‚HTTP/2ï¼ˆgRPCï¼‰ã€TCPï¼ˆDubboï¼‰ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("åºåˆ—åŒ–æ–¹å¼")]),t._v("ï¼šå¦‚JSONã€Protobufã€Thriftã€‚")]),t._v(" "),a("li",[a("strong",[t._v("æœåŠ¡æ²»ç†")]),t._v("ï¼šè´Ÿè½½å‡è¡¡ã€ç†”æ–­ã€é™æµç­‰")])])])]),t._v(" "),a("p",[t._v("ğŸ‘‰ é¢è¯•ä¸€å¥è¯æ€»ç»“ï¼š"),a("strong",[t._v("RPC æ˜¯ä¸€ç§é€šä¿¡åè®®å’Œè°ƒç”¨æ–¹å¼ï¼Œç›®æ ‡æ˜¯â€œé€æ˜è°ƒç”¨è¿œç¨‹æœåŠ¡â€ã€‚")])]),t._v(" "),a("p",[a("strong",[t._v("RPC å’Œ HTTP/REST çš„åŒºåˆ«")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("ç»´åº¦")]),t._v(" "),a("th",[t._v("RPC")]),t._v(" "),a("th",[t._v("HTTP/REST")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("å®šä¹‰æ–¹å¼")])]),t._v(" "),a("td",[t._v("é€šè¿‡æ¥å£ï¼ˆIDLï¼Œå¦‚gRPC çš„ protoï¼‰å®šä¹‰æœåŠ¡")]),t._v(" "),a("td",[t._v("é€šè¿‡ URL + HTTP æ–¹æ³•ï¼ˆGET/POST/PUT/DELETEï¼‰å®šä¹‰ API")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("ä¼ è¾“åè®®")])]),t._v(" "),a("td",[t._v("TCPã€HTTP/2ï¼ˆå¦‚ gRPCï¼‰")]),t._v(" "),a("td",[t._v("HTTP/1.1 æˆ– HTTP/2")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("æ•°æ®æ ¼å¼")])]),t._v(" "),a("td",[t._v("é«˜æ•ˆåºåˆ—åŒ–åè®®ï¼ˆProtobufã€Thriftã€Avroï¼‰")]),t._v(" "),a("td",[t._v("ä¸€èˆ¬æ˜¯ JSONï¼ˆæ–‡æœ¬æ ¼å¼ï¼Œæ˜“è¯»ä½†æ€§èƒ½å·®ï¼‰")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("æ€§èƒ½")])]),t._v(" "),a("td",[t._v("é«˜æ€§èƒ½ï¼ŒäºŒè¿›åˆ¶åºåˆ—åŒ–ï¼Œå ç”¨å¸¦å®½å°ï¼Œå»¶è¿Ÿä½")]),t._v(" "),a("td",[t._v("è¾ƒä½æ€§èƒ½ï¼ŒJSON è§£ææ…¢ï¼ŒæŠ¥æ–‡ä½“ç§¯å¤§")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("é€šä¿¡æ¨¡å¼")])]),t._v(" "),a("td",[t._v("å¤šæ ·ï¼ˆåŒæ­¥ã€å¼‚æ­¥ã€å•å‘ã€æµå¼ï¼‰")]),t._v(" "),a("td",[t._v("ä¸»è¦æ˜¯è¯·æ±‚-å“åº”")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("å¯è¯»æ€§")])]),t._v(" "),a("td",[t._v("æŠ½è±¡å±‚é«˜ï¼Œè°ƒè¯•å·¥å…·å°‘")]),t._v(" "),a("td",[t._v("URL+JSONï¼Œå¯è¯»æ€§å¼ºï¼Œè°ƒè¯•æ–¹ä¾¿")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("è·¨è¯­è¨€æ”¯æŒ")])]),t._v(" "),a("td",[t._v("IDL å®šä¹‰ï¼Œå¤šè¯­è¨€ Stub è‡ªåŠ¨ç”Ÿæˆï¼ˆgRPC è·¨è¯­è¨€å¼ºï¼‰")]),t._v(" "),a("td",[t._v("HTTP/JSON å¤©ç„¶è·¨è¯­è¨€")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("é€‚ç”¨åœºæ™¯")])]),t._v(" "),a("td",[t._v("å†…éƒ¨å¾®æœåŠ¡è°ƒç”¨ï¼Œé«˜æ€§èƒ½ã€ä½å»¶è¿Ÿåœºæ™¯")]),t._v(" "),a("td",[t._v("å¯¹å¤– APIï¼Œè·¨è¯­è¨€ã€è·¨å›¢é˜Ÿã€è·¨ç³»ç»Ÿçš„æœåŠ¡è°ƒç”¨")])])])]),t._v(" "),a("blockquote",[a("p",[t._v("è¯æœ¯ï¼š")]),t._v(" "),a("ol",[a("li",[a("p",[t._v("RPCæ˜¯è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿä¸­"),a("strong",[t._v("è¿œç¨‹æœåŠ¡è°ƒç”¨å¤æ‚æ€§")]),t._v("çš„å·¥å…·ï¼Œæ ¸å¿ƒç›®æ ‡æ˜¯è®©å¼€å‘è€…åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·è°ƒç”¨è¿œç¨‹æœåŠ¡ï¼Œéšè—ç½‘ç»œé€šä¿¡ç»†èŠ‚ã€‚ï¼ˆ"),a("strong",[t._v("ä¸€å¥è¯å®šä¹‰ï¼ˆ10ç§’æŠ“ä½æ ¸å¿ƒï¼‰")]),t._v("ï¼‰")])]),t._v(" "),a("li",[a("p",[t._v("RPCæ¡†æ¶åŒ…å«ä¸‰ä¸ªæ ¸å¿ƒæ¨¡å—ï¼šä»£ç†å±‚ï¼ˆç”Ÿæˆæ¥å£ä»£ç†ï¼‰ã€åºåˆ—åŒ–å±‚ï¼ˆProtobuf/JSONè½¬æ¢ï¼‰ã€ç½‘ç»œä¼ è¾“å±‚ï¼ˆNettyå®ç°ï¼‰ã€‚")]),t._v(" "),a("p",[t._v("è°ƒç”¨æµç¨‹æ˜¯ï¼šå®¢æˆ·ç«¯ä»£ç†å°è£…è¯·æ±‚â†’åºåˆ—åŒ–ä¸ºäºŒè¿›åˆ¶â†’ç»TCP/HTTP2ä¼ è¾“â†’æœåŠ¡ç«¯ååºåˆ—åŒ–â†’æ‰§è¡ŒçœŸå®æ–¹æ³•â†’ç»“æœåŸè·¯è¿”å›ã€‚å…³é”®æŠ€æœ¯æ˜¯åŠ¨æ€ä»£ç†å±è”½è¿œç¨‹è°ƒç”¨ç»†èŠ‚ï¼Œé…åˆé•¿è¿æ¥å¤ç”¨æå‡æ€§èƒ½ã€‚ï¼ˆ"),a("strong",[t._v("æ ¸å¿ƒåŸç†æ‹†è§£ï¼ˆå±•ç¤ºæŠ€æœ¯æ·±åº¦ï¼‰")]),t._v("ï¼‰")])]),t._v(" "),a("li",[a("p",[t._v("ç›¸æ¯”ç›´æ¥ä½¿ç”¨HTTPï¼ˆ"),a("strong",[t._v("å¯¹æ¯”å»¶ä¼¸ï¼ˆçªå‡ºæ€è€ƒå¹¿åº¦ï¼‰")]),t._v("ï¼‰ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("RPCä¼˜åŠ¿æ˜¯æ€§èƒ½æ›´é«˜ï¼ˆäºŒè¿›åˆ¶åè®®çœå¸¦å®½ï¼‰ã€å¼€å‘æ›´é«˜æ•ˆï¼ˆIDLç”Ÿæˆä»£ç ï¼‰ã€å†…ç½®æœåŠ¡æ²»ç†ï¼ˆç†”æ–­/è´Ÿè½½å‡è¡¡ï¼‰")]),t._v(" "),a("li",[t._v("HTTPä¼˜åŠ¿æ˜¯é€šç”¨æ€§å¼ºï¼ˆæµè§ˆå™¨ç›´æ¥æ”¯æŒï¼‰ã€è°ƒè¯•æ›´æ–¹ä¾¿")]),t._v(" "),a("li",[t._v("åœ¨å¾®æœåŠ¡å†…éƒ¨é€šä¿¡é€‰RPCï¼ˆå¦‚Dubboï¼‰ï¼Œå¼€æ”¾APIç”¨HTTPï¼ˆå¦‚SpringCloud OpenFeignï¼‰ã€‚")]),t._v(" "),a("li",[t._v("è…¾è®¯çš„tRPCé€šè¿‡æ’ä»¶åŒ–æ¶æ„è§£å†³åè®®å…¼å®¹é—®é¢˜ï¼Œè€ŒgRPCå¼ºåœ¨è·¨è¯­è¨€æ”¯æŒã€‚")])])]),t._v(" "),a("li",[a("p",[t._v("åœ¨ç”µå•†è®¢å•ç³»ç»Ÿä¸­ï¼Œæˆ‘ç”¨Dubboå®ç°åº“å­˜æœåŠ¡è°ƒç”¨ï¼ˆ"),a("strong",[t._v("å®æˆ˜ç»“åˆï¼ˆè¯æ˜è½åœ°èƒ½åŠ›ï¼‰")]),t._v("ï¼‰ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("é—®é¢˜ï¼šHTTPè°ƒç”¨åº“å­˜æ¥å£QPSä»…2000ï¼Œè¶…æ—¶ç‡15%")]),t._v(" "),a("li",[t._v("æ–¹æ¡ˆï¼šæ”¹ç”¨Dubbo+Protobufï¼ŒNacosæœåŠ¡å‘ç°ï¼Œéšæœºè´Ÿè½½å‡è¡¡")]),t._v(" "),a("li",[t._v("éš¾ç‚¹ï¼šè§£å†³åºåˆ—åŒ–å…¼å®¹æ€§ï¼ˆæ·»åŠ @Adaptiveæ³¨è§£ï¼‰")]),t._v(" "),a("li",[t._v("ç»“æœï¼šQPSæå‡åˆ°12000ï¼Œè¶…æ—¶ç‡é™è‡³0.2%ï¼ŒGCæ¬¡æ•°å‡å°‘60%")])])])])]),t._v(" "),a("h3",{attrs:{id:"ğŸ¯-rpcçš„åŸºæœ¬åŸç†æ˜¯ä»€ä¹ˆ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-rpcçš„åŸºæœ¬åŸç†æ˜¯ä»€ä¹ˆ"}},[t._v("#")]),t._v(" ğŸ¯ RPCçš„åŸºæœ¬åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ")]),t._v(" "),a("p",[t._v("RPCï¼ˆRemote Procedure Callï¼‰æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿé—´çš„é€šä¿¡æœºåˆ¶ï¼š")]),t._v(" "),a("p",[a("strong",[t._v("RPCå®šä¹‰ä¸ç‰¹ç‚¹")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œè®©ç½‘ç»œè°ƒç”¨åƒæœ¬åœ°è°ƒç”¨")]),t._v(" "),a("li",[t._v("å±è”½ç½‘ç»œé€šä¿¡çš„å¤æ‚æ€§")]),t._v(" "),a("li",[t._v("æ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€")]),t._v(" "),a("li",[t._v("æä¾›é€æ˜çš„è¿œç¨‹æœåŠ¡è®¿é—®")])]),t._v(" "),a("p",[a("strong",[t._v("æ ¸å¿ƒç»„ä»¶")]),t._v("ï¼š")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("å®¢æˆ·ç«¯ï¼ˆClientï¼‰")]),t._v("ï¼šå‘èµ·è¿œç¨‹è°ƒç”¨çš„ä¸€æ–¹")]),t._v(" "),a("li",[a("strong",[t._v("æœåŠ¡ç«¯ï¼ˆServerï¼‰")]),t._v("ï¼šæä¾›è¿œç¨‹æœåŠ¡çš„ä¸€æ–¹")]),t._v(" "),a("li",[a("strong",[t._v("ä»£ç†å±‚ï¼ˆProxyï¼‰")]),t._v("ï¼šå±è”½ç½‘ç»œé€šä¿¡ç»†èŠ‚")]),t._v(" "),a("li",[a("strong",[t._v("åè®®å±‚ï¼ˆProtocolï¼‰")]),t._v("ï¼šå®šä¹‰é€šä¿¡æ ¼å¼å’Œè§„åˆ™")]),t._v(" "),a("li",[a("strong",[t._v("ä¼ è¾“å±‚ï¼ˆTransportï¼‰")]),t._v("ï¼šè´Ÿè´£ç½‘ç»œæ•°æ®ä¼ è¾“")]),t._v(" "),a("li",[a("strong",[t._v("åºåˆ—åŒ–å±‚ï¼ˆSerializationï¼‰")]),t._v("ï¼šå¯¹è±¡ä¸å­—èŠ‚æµè½¬æ¢")])]),t._v(" "),a("p",[a("strong",[t._v("RPCè°ƒç”¨æµç¨‹")]),t._v("ï¼š")]),t._v(" "),a("ol",[a("li",[t._v("å®¢æˆ·ç«¯é€šè¿‡ä»£ç†å‘èµ·è°ƒç”¨")]),t._v(" "),a("li",[t._v("è¯·æ±‚å‚æ•°åºåˆ—åŒ–")]),t._v(" "),a("li",[t._v("ç½‘ç»œä¼ è¾“è¯·æ±‚æ•°æ®")]),t._v(" "),a("li",[t._v("æœåŠ¡ç«¯æ¥æ”¶å¹¶ååºåˆ—åŒ–")]),t._v(" "),a("li",[t._v("æ‰§è¡Œå®é™…ä¸šåŠ¡é€»è¾‘")]),t._v(" "),a("li",[t._v("ç»“æœåºåˆ—åŒ–å¹¶è¿”å›")]),t._v(" "),a("li",[t._v("å®¢æˆ·ç«¯æ¥æ”¶å¹¶ååºåˆ—åŒ–ç»“æœ")])]),t._v(" "),a("p",[a("strong",[t._v("ğŸ’» ä»£ç ç¤ºä¾‹")]),t._v("ï¼š")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// RPCè°ƒç”¨ç¤ºä¾‹")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCExample")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å®šä¹‰æœåŠ¡æ¥å£")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserService")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUserById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUsers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserQuery")]),t._v(" query"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å®¢æˆ·ç«¯è°ƒç”¨")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserController")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Reference")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// RPCæ³¨è§£")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserService")]),t._v(" userService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUser")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åƒæœ¬åœ°è°ƒç”¨ä¸€æ ·ä½¿ç”¨è¿œç¨‹æœåŠ¡")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" userService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUserById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æœåŠ¡ç«¯å®ç°")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Service")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æš´éœ²RPCæœåŠ¡")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserServiceImpl")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserService")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUserById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" userRepository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("findById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"ğŸ¯-ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç”¨rpc"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç”¨rpc"}},[t._v("#")]),t._v(" ğŸ¯ ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç”¨RPC?")]),t._v(" "),a("p",[t._v("åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿæ¶æ„ä¸­ï¼Œ"),a("strong",[t._v("RPCæ˜¯ä¸€ç§æ ¸å¿ƒé€šä¿¡æœºåˆ¶ï¼Œç”¨äºè§£å†³è·¨è¿›ç¨‹ã€è·¨æœºå™¨çš„å‡½æ•° / æ–¹æ³•è°ƒç”¨é—®é¢˜ã€‚å…¶å­˜åœ¨çš„æ ¸å¿ƒä»·å€¼åœ¨äºå°†å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿæ‹†è§£ä¸ºå¯åä½œçš„æœåŠ¡å•å…ƒ")]),t._v("ï¼ŒåŒæ—¶å°½å¯èƒ½è®©å¼€å‘è€…åƒè°ƒç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·ä½¿ç”¨è¿œç¨‹æœåŠ¡ã€‚")]),t._v(" "),a("p",[t._v("ä»¥ä¸‹æ˜¯ä½¿ç”¨ RPC çš„æ ¸å¿ƒåŸå› åŠå…¸å‹åœºæ™¯ï¼š")]),t._v(" "),a("p",[a("strong",[t._v("ä¸€ã€åˆ†å¸ƒå¼æ¶æ„çš„å¿…ç„¶é€‰æ‹©")])]),t._v(" "),a("ol",[a("li",[a("p",[a("strong",[t._v("æœåŠ¡æ‹†åˆ†ä¸å¾®æœåŠ¡åŒ–")])]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("å•ä½“åº”ç”¨çš„ç“¶é¢ˆ")]),t._v("ï¼šä¼ ç»Ÿå•ä½“æ¶æ„ä¸­ï¼Œæ‰€æœ‰åŠŸèƒ½æ¨¡å—è€¦åˆåœ¨ä¸€ä¸ªè¿›ç¨‹å†…ï¼Œéš¾ä»¥æ‰©å±•ã€ç»´æŠ¤å’Œè¿­ä»£ã€‚")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("åˆ†å¸ƒå¼æ‹†åˆ†çš„éœ€æ±‚")]),t._v("ï¼šå°†ç³»ç»Ÿæ‹†åˆ†ä¸ºç‹¬ç«‹éƒ¨ç½²çš„æœåŠ¡ï¼ˆå¦‚ç”¨æˆ·æœåŠ¡ã€è®¢å•æœåŠ¡ã€æ”¯ä»˜æœåŠ¡ï¼‰ï¼Œæ¯ä¸ªæœåŠ¡è´Ÿè´£å•ä¸€ä¸šåŠ¡é¢†åŸŸï¼Œé€šè¿‡ RPC å®ç°è·¨æœåŠ¡åä½œã€‚")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("ç¤ºä¾‹")]),t._v("ï¼šç”µå•†ç³»ç»Ÿä¸­ï¼Œå‰ç«¯è¯·æ±‚ç”¨æˆ·æœåŠ¡æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼Œç”¨æˆ·æœåŠ¡é€šè¿‡ RPC è°ƒç”¨è®¢å•æœåŠ¡è·å–å†å²è®¢å•æ•°æ®ã€‚")])])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("èµ„æºéš”ç¦»ä¸å¼¹æ€§æ‰©å±•")])]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("æŒ‰éœ€æ‰©å±•ç‰¹å®šæœåŠ¡")]),t._v("ï¼šä¸åŒæœåŠ¡çš„è´Ÿè½½å¯èƒ½å·®å¼‚æ˜¾è‘—ï¼ˆå¦‚ä¿ƒé”€æœŸé—´è®¢å•æœåŠ¡å‹åŠ›è¿œé«˜äºç”¨æˆ·æœåŠ¡ï¼‰ï¼Œé€šè¿‡ RPC è§£è€¦åï¼Œå¯ç‹¬ç«‹å¯¹é«˜è´Ÿè½½æœåŠ¡æ‰©å®¹ã€‚")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("æ•…éšœéš”ç¦»")]),t._v("ï¼šæŸä¸ªæœåŠ¡æ•…éšœä¸ä¼šå¯¼è‡´æ•´ä¸ªç³»ç»Ÿå´©æºƒï¼Œä»…å½±å“ä¾èµ–è¯¥æœåŠ¡çš„åŠŸèƒ½æ¨¡å—ï¼ˆéœ€é…åˆç†”æ–­ã€é‡è¯•ç­‰æœºåˆ¶ï¼‰ã€‚")])])])])]),t._v(" "),a("p",[a("strong",[t._v("äºŒã€è·¨æŠ€æœ¯æ ˆåä½œçš„æ¡¥æ¢")])]),t._v(" "),a("ol",[a("li",[a("p",[a("strong",[t._v("å¤šè¯­è¨€æ··åˆå¼€å‘")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("ä¸åŒæœåŠ¡å¯é‡‡ç”¨æœ€é€‚åˆçš„è¯­è¨€å®ç°ï¼ˆå¦‚ Java ç”¨äºä¸šåŠ¡é€»è¾‘ã€Go ç”¨äºé«˜å¹¶å‘åœºæ™¯ã€Python ç”¨äºæ•°æ®åˆ†æï¼‰ï¼Œé€šè¿‡ RPC å±è”½è¯­è¨€å·®å¼‚ã€‚")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("ç¤ºä¾‹")]),t._v("ï¼šJava ç¼–å†™çš„ç½‘å…³æœåŠ¡é€šè¿‡ RPC è°ƒç”¨ Go ç¼–å†™çš„åº“å­˜æœåŠ¡ï¼Œè·å–å•†å“åº“å­˜ä¿¡æ¯ã€‚")])])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("é—ç•™ç³»ç»Ÿé›†æˆ")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("æ–°è€ç³»ç»Ÿå¹¶å­˜æ—¶ï¼Œé€šè¿‡ RPC ä¸ºé—ç•™ç³»ç»Ÿæä¾›ç»Ÿä¸€æ¥å£ï¼Œé¿å…é‡æ„æˆæœ¬ã€‚")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("ç¤ºä¾‹")]),t._v("ï¼šç”¨ Node.js å¼€å‘æ–°å‰ç«¯ç³»ç»Ÿï¼Œé€šè¿‡ RPC è°ƒç”¨ COBOL ç¼–å†™çš„æ ¸å¿ƒè´¦åŠ¡ç³»ç»Ÿæ¥å£ã€‚")])])])])]),t._v(" "),a("p",[a("strong",[t._v("ä¸‰ã€é«˜æ€§èƒ½ä¸é€æ˜åŒ–çš„è¿œç¨‹è°ƒç”¨")])]),t._v(" "),a("ol",[a("li",[a("p",[a("strong",[t._v("æ¥è¿‘æœ¬åœ°è°ƒç”¨çš„å¼€å‘ä½“éªŒ")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("RPC æ¡†æ¶é€šè¿‡åŠ¨æ€ä»£ç†ã€ä»£ç ç”Ÿæˆç­‰æŠ€æœ¯ï¼Œå°†è¿œç¨‹è°ƒç”¨å°è£…ä¸ºæœ¬åœ°å‡½æ•°è°ƒç”¨å½¢å¼ï¼Œå¼€å‘è€…æ— éœ€å…³æ³¨ç½‘ç»œç»†èŠ‚ï¼ˆå¦‚ Socket ç¼–ç¨‹ã€æ•°æ®åºåˆ—åŒ–ï¼‰ã€‚")])]),t._v(" "),a("li",[a("p",[t._v("ä¼ªä»£ç ç¤ºä¾‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æœ¬åœ°è°ƒç”¨é£æ ¼çš„RPC")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),t._v(" user "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" userService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUser")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("123")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å®é™…é€šè¿‡ç½‘ç»œè°ƒç”¨è¿œç¨‹æœåŠ¡")]),t._v("\n")])])])])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("æ¯” HTTP æ›´é«˜æ•ˆçš„é€šä¿¡åè®®")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("å¤šæ•° RPC æ¡†æ¶é‡‡ç”¨äºŒè¿›åˆ¶åè®®ï¼ˆå¦‚ Protobufã€Thriftï¼‰ï¼Œç›¸æ¯” JSON/XML æ ¼å¼çš„ HTTP è¯·æ±‚ï¼Œ"),a("strong",[t._v("ä¼ è¾“ä½“ç§¯æ›´å°ã€è§£ææ›´å¿«")]),t._v("ï¼Œé€‚åˆé«˜é¢‘ã€å¤§æ•°æ®é‡åœºæ™¯ã€‚")])]),t._v(" "),a("li",[a("p",[t._v("æ€§èƒ½å¯¹æ¯”ï¼š")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[t._v("åè®®")])]),t._v(" "),a("th",[t._v("ä¼ è¾“ä½“ç§¯")]),t._v(" "),a("th",[t._v("è§£æè€—æ—¶")]),t._v(" "),a("th",[t._v("å…¸å‹åœºæ™¯")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("RESTï¼ˆJSONï¼‰")]),t._v(" "),a("td",[t._v("100KB")]),t._v(" "),a("td",[t._v("10ms")]),t._v(" "),a("td",[t._v("é€šç”¨ Web æœåŠ¡")])]),t._v(" "),a("tr",[a("td",[t._v("gRPCï¼ˆProtobufï¼‰")]),t._v(" "),a("td",[t._v("30KB")]),t._v(" "),a("td",[t._v("2ms")]),t._v(" "),a("td",[t._v("å¾®æœåŠ¡é—´é«˜é¢‘è°ƒç”¨")])])])])])])])]),t._v(" "),a("p",[a("strong",[t._v("å››ã€å…¸å‹åº”ç”¨åœºæ™¯")])]),t._v(" "),a("ol",[a("li",[a("p",[a("strong",[t._v("å¾®æœåŠ¡æ¶æ„ä¸­çš„æœåŠ¡é—´é€šä¿¡")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œæ¯ä¸ªæœåŠ¡é€šè¿‡ RPC è°ƒç”¨ä¸Šä¸‹æ¸¸æœåŠ¡ï¼Œå½¢æˆå¤æ‚çš„è°ƒç”¨é“¾è·¯ã€‚")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("æ¡ˆä¾‹")]),t._v("ï¼šNetflix çš„å¾®æœåŠ¡ä½“ç³»é€šè¿‡ Eurekaï¼ˆæœåŠ¡æ³¨å†Œï¼‰+ Ribbonï¼ˆè´Ÿè½½å‡è¡¡ï¼‰+ Feignï¼ˆRPC å®¢æˆ·ç«¯ï¼‰å®ç°è·¨æœåŠ¡é€šä¿¡ã€‚")])])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("äº‘æœåŠ¡ä¸åˆ†å¸ƒå¼è®¡ç®—")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("äº‘è®¡ç®—å¹³å°ï¼ˆå¦‚ AWSã€é˜¿é‡Œäº‘ï¼‰é€šè¿‡ RPC æä¾› API æ¥å£ï¼ˆå¦‚ EC2 å®ä¾‹ç®¡ç†ã€S3 å­˜å‚¨æ“ä½œï¼‰ã€‚")])]),t._v(" "),a("li",[a("p",[t._v("åˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶ï¼ˆå¦‚ Hadoopã€Sparkï¼‰é€šè¿‡ RPC åè°ƒèŠ‚ç‚¹é—´ä»»åŠ¡è°ƒåº¦ä¸æ•°æ®ä¼ è¾“ã€‚")])])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("å®æ—¶æ•°æ®å¤„ç†ä¸æµè®¡ç®—")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("å®æ—¶ç³»ç»Ÿä¸­ï¼Œä¸åŒç»„ä»¶ï¼ˆå¦‚æ¶ˆæ¯é˜Ÿåˆ—ã€è®¡ç®—å¼•æ“ã€å­˜å‚¨ç³»ç»Ÿï¼‰é€šè¿‡ RPC ä¼ é€’å®æ—¶æ•°æ®ã€‚")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("æ¡ˆä¾‹")]),t._v("ï¼šKafka Streams é€šè¿‡ RPC å°†å®æ—¶æ•°æ®æµåˆ†å‘åˆ°ä¸åŒè®¡ç®—èŠ‚ç‚¹è¿›è¡Œå¤„ç†ã€‚")])])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("è·¨æ•°æ®ä¸­å¿ƒ / è·¨åœ°åŸŸè°ƒç”¨")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("å…¨çƒåŒ–ä¸šåŠ¡ä¸­ï¼ŒæœåŠ¡éƒ¨ç½²åœ¨å¤šä¸ªæ•°æ®ä¸­å¿ƒï¼Œé€šè¿‡ RPC å®ç°å¼‚åœ°å®¹ç¾æˆ–å°±è¿‘è®¿é—®ã€‚")])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("æŒ‘æˆ˜")]),t._v("ï¼šéœ€è§£å†³è·¨åœ°åŸŸç½‘ç»œå»¶è¿Ÿï¼ˆå¦‚é€šè¿‡è¾¹ç¼˜èŠ‚ç‚¹ç¼“å­˜çƒ­ç‚¹æ•°æ®ï¼‰ã€‚")])])])])]),t._v(" "),a("p",[a("strong",[t._v("äº”ã€ä¸å…¶ä»–é€šä¿¡æ–¹å¼çš„å¯¹æ¯”")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[t._v("ç»´åº¦")])]),t._v(" "),a("th",[a("strong",[t._v("RPC")])]),t._v(" "),a("th",[a("strong",[t._v("REST/HTTP")])]),t._v(" "),a("th",[a("strong",[t._v("æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå¦‚ Kafkaï¼‰")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("é€šä¿¡æ¨¡å‹")])]),t._v(" "),a("td",[t._v("åŒæ­¥è°ƒç”¨ï¼ˆè¯·æ±‚ - å“åº”ï¼‰")]),t._v(" "),a("td",[t._v("åŒæ­¥è°ƒç”¨ï¼ˆRESTful é£æ ¼ï¼‰")]),t._v(" "),a("td",[t._v("å¼‚æ­¥æ¶ˆæ¯ä¼ é€’")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("å®æ—¶æ€§")])]),t._v(" "),a("td",[t._v("é«˜ï¼ˆé€‚åˆå³æ—¶å“åº”åœºæ™¯ï¼‰")]),t._v(" "),a("td",[t._v("ä¸­ï¼ˆå—é™äº HTTP åè®®ï¼‰")]),t._v(" "),a("td",[t._v("ä½ï¼ˆé€‚åˆå¼‚æ­¥å¤„ç†ï¼‰")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("æ•°æ®æ ¼å¼")])]),t._v(" "),a("td",[t._v("äºŒè¿›åˆ¶ï¼ˆé«˜æ•ˆï¼‰")]),t._v(" "),a("td",[t._v("æ–‡æœ¬ï¼ˆJSON/XMLï¼‰")]),t._v(" "),a("td",[t._v("è‡ªå®šä¹‰ï¼ˆäºŒè¿›åˆ¶ / æ–‡æœ¬ï¼‰")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("é€‚ç”¨åœºæ™¯")])]),t._v(" "),a("td",[t._v("å¾®æœåŠ¡é—´å¼ºä¾èµ–è°ƒç”¨")]),t._v(" "),a("td",[t._v("å¼€æ”¾ APIã€è·¨å›¢é˜Ÿåä½œ")]),t._v(" "),a("td",[t._v("å¼‚æ­¥ä»»åŠ¡ã€æµé‡å‰Šå³°")])])])]),t._v(" "),a("p",[a("strong",[t._v("å…­ã€RPC çš„æ ¸å¿ƒä»·å€¼")])]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("æ¶æ„å±‚é¢")]),t._v("ï¼šæ”¯æ’‘åˆ†å¸ƒå¼ç³»ç»Ÿçš„æœåŠ¡æ‹†åˆ†ä¸åä½œï¼Œæå‡å¯æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("å¼€å‘å±‚é¢")]),t._v("ï¼šå±è”½ç½‘ç»œå¤æ‚æ€§ï¼Œé™ä½åˆ†å¸ƒå¼å¼€å‘é—¨æ§›ï¼Œå…è®¸æ··åˆæŠ€æœ¯æ ˆã€‚")]),t._v(" "),a("li",[a("strong",[t._v("æ€§èƒ½å±‚é¢")]),t._v("ï¼šæä¾›æ¯”ä¼ ç»Ÿ HTTP æ›´é«˜æ•ˆçš„é€šä¿¡æ–¹å¼ï¼Œæ»¡è¶³é«˜å¹¶å‘ã€ä½å»¶è¿Ÿéœ€æ±‚ã€‚")])]),t._v(" "),a("p",[a("strong",[t._v("é€‰æ‹©å»ºè®®")]),t._v("ï¼šè‹¥éœ€è¦"),a("strong",[t._v("å¼ºä¸€è‡´æ€§ã€å®æ—¶å“åº”çš„æœåŠ¡é—´è°ƒç”¨")]),t._v("ï¼Œä¼˜å…ˆé€‰æ‹© RPCï¼›è‹¥éœ€è¦"),a("strong",[t._v("å¼€æ”¾ APIã€è·¨å›¢é˜Ÿ / è·¨å¹³å°åä½œ")]),t._v("ï¼Œåˆ™æ›´é€‚åˆ REST/HTTPï¼›è‹¥ä¸šåŠ¡åœºæ™¯ä»¥"),a("strong",[t._v("å¼‚æ­¥è§£è€¦")]),t._v("ä¸ºä¸»ï¼Œå¯ç»“åˆæ¶ˆæ¯é˜Ÿåˆ—ä½¿ç”¨ã€‚")]),t._v(" "),a("h3",{attrs:{id:"ğŸ¯-rpcä¸httpã€æ¶ˆæ¯é˜Ÿåˆ—çš„åŒºåˆ«"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-rpcä¸httpã€æ¶ˆæ¯é˜Ÿåˆ—çš„åŒºåˆ«"}},[t._v("#")]),t._v(" ğŸ¯ RPCä¸HTTPã€æ¶ˆæ¯é˜Ÿåˆ—çš„åŒºåˆ«ï¼Ÿ")]),t._v(" "),a("p",[t._v("ä¸åŒé€šä¿¡æ–¹å¼çš„ç‰¹ç‚¹å¯¹æ¯”ï¼š")]),t._v(" "),a("p",[a("strong",[t._v("è¯¦ç»†å¯¹æ¯”åˆ†æ")]),t._v("ï¼š")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("ç‰¹æ€§")]),t._v(" "),a("th",[t._v("RPC")]),t._v(" "),a("th",[t._v("HTTP")]),t._v(" "),a("th",[t._v("æ¶ˆæ¯é˜Ÿåˆ—")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("é€šä¿¡æ–¹å¼")])]),t._v(" "),a("td",[t._v("åŒæ­¥è°ƒç”¨")]),t._v(" "),a("td",[t._v("åŒæ­¥è¯·æ±‚")]),t._v(" "),a("td",[t._v("å¼‚æ­¥æ¶ˆæ¯")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("è°ƒç”¨æ–¹å¼")])]),t._v(" "),a("td",[t._v("æ–¹æ³•è°ƒç”¨")]),t._v(" "),a("td",[t._v("èµ„æºè®¿é—®")]),t._v(" "),a("td",[t._v("æ¶ˆæ¯å‘é€")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("æ€§èƒ½")])]),t._v(" "),a("td",[t._v("é«˜æ€§èƒ½")]),t._v(" "),a("td",[t._v("ä¸­ç­‰")]),t._v(" "),a("td",[t._v("é«˜åå")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("å®æ—¶æ€§")])]),t._v(" "),a("td",[t._v("å®æ—¶")]),t._v(" "),a("td",[t._v("å®æ—¶")]),t._v(" "),a("td",[t._v("å‡†å®æ—¶")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("è€¦åˆåº¦")])]),t._v(" "),a("td",[t._v("è¾ƒé«˜")]),t._v(" "),a("td",[t._v("ä¸­ç­‰")]),t._v(" "),a("td",[t._v("ä½")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("å¤æ‚åº¦")])]),t._v(" "),a("td",[t._v("ä¸­ç­‰")]),t._v(" "),a("td",[t._v("ç®€å•")]),t._v(" "),a("td",[t._v("è¾ƒé«˜")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("é€‚ç”¨åœºæ™¯")])]),t._v(" "),a("td",[t._v("å¾®æœåŠ¡è°ƒç”¨")]),t._v(" "),a("td",[t._v("Web API")]),t._v(" "),a("td",[t._v("è§£è€¦å¼‚æ­¥")])])])]),t._v(" "),a("p",[a("strong",[t._v("ä½¿ç”¨åœºæ™¯é€‰æ‹©")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("RPC")]),t._v("ï¼šå¾®æœåŠ¡é—´åŒæ­¥è°ƒç”¨ã€é«˜æ€§èƒ½è¦æ±‚")]),t._v(" "),a("li",[a("strong",[t._v("HTTP")]),t._v("ï¼šå¯¹å¤–APIã€è·¨è¯­è¨€è°ƒç”¨ã€ç®€å•åœºæ™¯")]),t._v(" "),a("li",[a("strong",[t._v("æ¶ˆæ¯é˜Ÿåˆ—")]),t._v("ï¼šå¼‚æ­¥å¤„ç†ã€ç³»ç»Ÿè§£è€¦ã€å‰Šå³°å¡«è°·")])]),t._v(" "),a("h3",{attrs:{id:"ğŸ¯-åŠ¨æ€ä»£ç†åœ¨rpcä¸­çš„ä½œç”¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-åŠ¨æ€ä»£ç†åœ¨rpcä¸­çš„ä½œç”¨"}},[t._v("#")]),t._v(" ğŸ¯ åŠ¨æ€ä»£ç†åœ¨RPCä¸­çš„ä½œç”¨ï¼Ÿ")]),t._v(" "),a("p",[t._v("åŠ¨æ€ä»£ç†æ˜¯RPCæ¡†æ¶çš„æ ¸å¿ƒæŠ€æœ¯ï¼š")]),t._v(" "),a("p",[a("strong",[t._v("ä½œç”¨æœºåˆ¶")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("å±è”½ç½‘ç»œé€šä¿¡ç»†èŠ‚")]),t._v(" "),a("li",[t._v("æä¾›é€æ˜çš„è¿œç¨‹è°ƒç”¨ä½“éªŒ")]),t._v(" "),a("li",[t._v("ç»Ÿä¸€å¤„ç†åºåˆ—åŒ–å’Œåè®®")]),t._v(" "),a("li",[t._v("å®ç°AOPåŠŸèƒ½ï¼ˆç›‘æ§ã€é‡è¯•ç­‰ï¼‰")])]),t._v(" "),a("p",[a("strong",[t._v("å®ç°æ–¹å¼")]),t._v("ï¼š")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("JDKåŠ¨æ€ä»£ç†")]),t._v("ï¼šåŸºäºæ¥å£çš„ä»£ç†")]),t._v(" "),a("li",[a("strong",[t._v("CGLIBä»£ç†")]),t._v("ï¼šåŸºäºç±»çš„ä»£ç†")]),t._v(" "),a("li",[a("strong",[t._v("å­—èŠ‚ç ç”Ÿæˆ")]),t._v("ï¼šç¼–è¯‘æ—¶ç”Ÿæˆä»£ç†ç±»")])]),t._v(" "),a("p",[a("strong",[t._v("ğŸ’» ä»£ç ç¤ºä¾‹")]),t._v("ï¼š")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// RPCåŠ¨æ€ä»£ç†å®ç°")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCProxyFactory")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createProxy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Class")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" serviceInterface"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                                   "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" serverAddress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Proxy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("newProxyInstance")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n            serviceInterface"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getClassLoader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("serviceInterface"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCInvocationHandler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("serviceInterface"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" serverAddress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä»£ç†è°ƒç”¨å¤„ç†å™¨")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCInvocationHandler")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("InvocationHandler")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Class")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" serviceInterface"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" serverAddress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCClient")]),t._v(" rpcClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("invoke")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),t._v(" proxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Method")]),t._v(" method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Object")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ„é€ RPCè¯·æ±‚")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCRequest")]),t._v(" request "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("builder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("serviceName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("serviceInterface"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("methodName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parameterTypes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getParameterTypes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parameters")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("args"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å‘é€è¯·æ±‚å¹¶è·å–å“åº”")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),t._v(" response "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" rpcClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("serverAddress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hasException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RuntimeException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getResult")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"ğŸ¯-rpcéœ€è¦è§£å†³çš„ä¸‰ä¸ªé—®é¢˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-rpcéœ€è¦è§£å†³çš„ä¸‰ä¸ªé—®é¢˜"}},[t._v("#")]),t._v(" ğŸ¯ RPCéœ€è¦è§£å†³çš„ä¸‰ä¸ªé—®é¢˜ï¼Ÿ")]),t._v(" "),a("p",[a("strong",[t._v("ä¸€ã€Call ID æ˜ å°„ï¼ˆå‡½æ•°æ ‡è¯†ä¸è·¯ç”±ï¼‰")])]),t._v(" "),a("p",[a("strong",[t._v("é—®é¢˜æœ¬è´¨")])]),t._v(" "),a("p",[t._v("æœ¬åœ°è°ƒç”¨é€šè¿‡å‡½æ•°æŒ‡é’ˆç›´æ¥å¯»å€ï¼Œè€Œè¿œç¨‹è°ƒç”¨ä¸­å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯å¤„äºä¸åŒåœ°å€ç©ºé—´ï¼Œéœ€å»ºç«‹"),a("strong",[t._v("å‡½æ•°åˆ°å”¯ä¸€æ ‡è¯†çš„æ˜ å°„å…³ç³»")]),t._v("ï¼Œç¡®ä¿æœåŠ¡ç«¯å‡†ç¡®è¯†åˆ«ç›®æ ‡å‡½æ•°ã€‚")]),t._v(" "),a("p",[a("strong",[t._v("è§£å†³æ–¹æ¡ˆ")])]),t._v(" "),a("ol",[a("li",[a("p",[a("strong",[t._v("å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆCall IDï¼‰")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("ä¸ºæ¯ä¸ªå‡½æ•°åˆ†é…å…¨å±€å”¯ä¸€ IDï¼ˆå¦‚æ•´æ•°ã€å­—ç¬¦ä¸²æˆ– UUIDï¼‰ï¼Œä¾‹å¦‚ï¼š")]),t._v(" "),a("div",{staticClass:"language-python extra-class"},[a("pre",{pre:!0,attrs:{class:"language-python"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# æœåŠ¡ç«¯æ˜ å°„è¡¨ç¤ºä¾‹")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"userService.queryUser"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1001")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# å­—ç¬¦ä¸²æ ‡è¯†")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"orderService.createOrder"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2002")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("å®¢æˆ·ç«¯é€šè¿‡è¯¥ ID æŒ‡å®šè°ƒç”¨ç›®æ ‡ï¼ŒæœåŠ¡ç«¯é€šè¿‡ ID æŸ¥æ‰¾å¯¹åº”å‡½æ•°å®ç°ã€‚")])])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("åŠ¨æ€æ³¨å†Œä¸å‘ç°")])]),t._v(" "),a("ul",[a("li",[t._v("æœåŠ¡å¯åŠ¨æ—¶å‘æ³¨å†Œä¸­å¿ƒï¼ˆå¦‚ Consulã€Nacosï¼‰æ³¨å†Œå‡½æ•° ID ä¸åœ°å€çš„æ˜ å°„å…³ç³»ã€‚")]),t._v(" "),a("li",[t._v("å®¢æˆ·ç«¯é€šè¿‡æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡åˆ—è¡¨åŠå‡½æ•° ID è·¯ç”±è§„åˆ™ï¼Œå®ç°åŠ¨æ€å¯»å€ã€‚")])])])]),t._v(" "),a("p",[a("strong",[t._v("æŠ€æœ¯æŒ‘æˆ˜")])]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("ç‰ˆæœ¬å…¼å®¹")]),t._v("ï¼šå‡½æ•°å‡çº§æ—¶éœ€ä¿ç•™æ—§ Call ID æˆ–æä¾›å…¼å®¹æ˜ å°„ï¼Œé¿å…å®¢æˆ·ç«¯è¯·æ±‚å¤±æ•ˆã€‚")]),t._v(" "),a("li",[a("strong",[t._v("è·¨è¯­è¨€æ˜ å°„")]),t._v("ï¼šä¸åŒè¯­è¨€å¼€å‘çš„å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯éœ€ç»Ÿä¸€ ID è§„èŒƒï¼ˆå¦‚ Thrift é€šè¿‡ IDL æ–‡ä»¶ç”Ÿæˆä¸€è‡´çš„ IDï¼‰ã€‚")])]),t._v(" "),a("p",[a("strong",[t._v("äºŒã€åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼ˆæ•°æ®æ ¼å¼è½¬æ¢ï¼‰")])]),t._v(" "),a("p",[a("strong",[t._v("é—®é¢˜æœ¬è´¨")])]),t._v(" "),a("p",[t._v("è·¨è¿›ç¨‹é€šä¿¡æ— æ³•ç›´æ¥ä¼ é€’å†…å­˜å¯¹è±¡ï¼Œä¸”å¯èƒ½å­˜åœ¨è¯­è¨€å·®å¼‚ï¼ˆå¦‚ Java å¯¹è±¡ä¸ Go ç»“æ„ä½“ï¼‰ï¼Œéœ€å°†æ•°æ®ç»“æ„è½¬æ¢ä¸º"),a("strong",[t._v("é€šç”¨å­—èŠ‚æµæ ¼å¼")]),t._v("ï¼Œç¡®ä¿è·¨è¯­è¨€ã€è·¨å¹³å°è§£æã€‚")]),t._v(" "),a("p",[a("strong",[t._v("è§£å†³æ–¹æ¡ˆ")])]),t._v(" "),a("ol",[a("li",[a("p",[a("strong",[t._v("åºåˆ—åŒ–åè®®é€‰æ‹©")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[t._v("åè®®")])]),t._v(" "),a("th",[a("strong",[t._v("ç‰¹ç‚¹")])]),t._v(" "),a("th",[a("strong",[t._v("é€‚ç”¨åœºæ™¯")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("JSON")]),t._v(" "),a("td",[t._v("å¯è¯»æ€§å¼ºï¼Œè§£ææ•ˆç‡ä½")]),t._v(" "),a("td",[t._v("è½»é‡çº§æœåŠ¡ã€æµè§ˆå™¨äº¤äº’")])]),t._v(" "),a("tr",[a("td",[t._v("Protobuf")]),t._v(" "),a("td",[t._v("äºŒè¿›åˆ¶æ ¼å¼ï¼Œé«˜æ•ˆå‹ç¼©ï¼Œæ”¯æŒè‡ªåŠ¨ç”Ÿæˆä»£ç ")]),t._v(" "),a("td",[t._v("é«˜æ€§èƒ½ã€å¤§æ•°æ®é‡åœºæ™¯")])]),t._v(" "),a("tr",[a("td",[t._v("Thrift")]),t._v(" "),a("td",[t._v("å¤šè¯­è¨€æ”¯æŒï¼Œé€šè¿‡ IDL å®šä¹‰æ•°æ®ç»“æ„")]),t._v(" "),a("td",[t._v("è·¨è¯­è¨€å¾®æœåŠ¡æ¶æ„")])]),t._v(" "),a("tr",[a("td",[t._v("Avro")]),t._v(" "),a("td",[t._v("æ¨¡å¼åŠ¨æ€æ¼”å˜ï¼Œé€‚åˆæ•°æ®æ ¼å¼é¢‘ç¹å˜æ›´åœºæ™¯")]),t._v(" "),a("td",[t._v("æ—¥å¿—ç³»ç»Ÿã€å®æ—¶æ•°æ®ç®¡é“")])])])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("å¯¹è±¡ä¸å­—èŠ‚æµè½¬æ¢")])]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("å®¢æˆ·ç«¯")]),t._v("ï¼šå°†å‚æ•°å¯¹è±¡åºåˆ—åŒ–ä¸ºå­—èŠ‚æµï¼ˆå¦‚ Java çš„"),a("code",[t._v("ObjectOutputStream")]),t._v("ã€Go çš„"),a("code",[t._v("json.Marshal")]),t._v("ï¼‰ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("æœåŠ¡ç«¯")]),t._v("ï¼šå°†å­—èŠ‚æµååºåˆ—åŒ–ä¸ºæœ¬åœ°å¯¹è±¡ï¼ˆå¦‚ Python çš„"),a("code",[t._v("json.loads")]),t._v("ã€C++ çš„ Protobuf è§£æå™¨ï¼‰ã€‚")])])])]),t._v(" "),a("p",[a("strong",[t._v("æŠ€æœ¯æŒ‘æˆ˜")])]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("æ€§èƒ½ç“¶é¢ˆ")]),t._v("ï¼šé«˜é¢‘è°ƒç”¨åœºæ™¯ä¸‹ï¼Œåºåˆ—åŒ– / ååºåˆ—åŒ–å¯èƒ½æˆä¸ºæ€§èƒ½çŸ­æ¿ï¼ˆå¦‚ JSON è§£æè€—æ—¶é«˜äº Protobufï¼‰ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("æ•°æ®å…¼å®¹æ€§")]),t._v("ï¼šå­—æ®µå¢å‡æˆ–ç±»å‹å˜æ›´æ—¶ï¼Œéœ€ç¡®ä¿æ–°æ—§åè®®å…¼å®¹ï¼ˆå¦‚ Protobuf çš„å¯é€‰å­—æ®µã€JSON çš„é»˜è®¤å€¼å¤„ç†ï¼‰ã€‚")])]),t._v(" "),a("p",[a("strong",[t._v("ä¸‰ã€ç½‘ç»œä¼ è¾“ï¼ˆæ•°æ®é€šä¿¡ä¸å¯é æ€§ï¼‰")])]),t._v(" "),a("p",[a("strong",[t._v("é—®é¢˜æœ¬è´¨")])]),t._v(" "),a("p",[t._v("éœ€å»ºç«‹å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„"),a("strong",[t._v("å¯é æ•°æ®ä¼ è¾“é€šé“")]),t._v("ï¼Œè§£å†³ç½‘ç»œå»¶è¿Ÿã€ä¸¢åŒ…ã€è¿æ¥ç®¡ç†ç­‰é—®é¢˜ï¼Œç¡®ä¿ Call ID ä¸åºåˆ—åŒ–æ•°æ®å‡†ç¡®ä¼ è¾“ã€‚")]),t._v(" "),a("p",[a("strong",[t._v("è§£å†³æ–¹æ¡ˆ")])]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("ä¼ è¾“åè®®é€‰æ‹©")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("TCP")]),t._v("ï¼šé¢å‘è¿æ¥ï¼Œæä¾›å¯é ä¼ è¾“ï¼ˆå¦‚ gRPC åŸºäº HTTP/2ï¼ŒNetty è‡ªå®šä¹‰åè®®ï¼‰ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("UDP")]),t._v("ï¼šæ— è¿æ¥ï¼Œé€‚åˆå®æ—¶æ€§è¦æ±‚é«˜ä½†å…è®¸å°‘é‡ä¸¢åŒ…çš„åœºæ™¯ï¼ˆå¦‚æ¸¸æˆçŠ¶æ€åŒæ­¥ï¼‰ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("HTTP/2")]),t._v("ï¼šå¤šè·¯å¤ç”¨ã€å¤´éƒ¨å‹ç¼©ï¼Œé€‚åˆ RESTful é£æ ¼çš„ RPCï¼ˆå¦‚ Spring Cloud Feignï¼‰ã€‚")])])]),t._v(" "),a("li",[a("strong",[t._v("ç½‘ç»œå±‚æ ¸å¿ƒç»„ä»¶")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡")]),t._v("ï¼šé€šè¿‡è½®è¯¢ã€éšæœºæˆ–åŠ æƒæœ€å°è¿æ¥ç­‰ç­–ç•¥é€‰æ‹©ç›®æ ‡æœåŠ¡èŠ‚ç‚¹ï¼ˆå¦‚ Ribbonã€Spring Cloud LoadBalancerï¼‰ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("è¿æ¥æ± ç®¡ç†")]),t._v("ï¼šå¤ç”¨ç½‘ç»œè¿æ¥ï¼Œå‡å°‘ TCP ä¸‰æ¬¡æ¡æ‰‹å¼€é”€ï¼ˆå¦‚ Hystrix çš„è¿æ¥æ± é…ç½®ï¼‰ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("è¶…æ—¶ä¸é‡è¯•")]),t._v("ï¼šè®¾ç½®è¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆå¦‚ gRPC é»˜è®¤ 1 ç§’ï¼‰ï¼Œå¤±è´¥åæŒ‰ç­–ç•¥é‡è¯•ï¼ˆå¦‚æŒ‡æ•°é€€é¿ï¼‰ã€‚")])])])]),t._v(" "),a("p",[a("strong",[t._v("æŠ€æœ¯æŒ‘æˆ˜")])]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("ç½‘ç»œæ‹¥å¡")]),t._v("ï¼šé«˜å¹¶å‘åœºæ™¯ä¸‹å¯èƒ½å¯¼è‡´ä¼ è¾“å»¶è¿Ÿé™¡å¢ï¼Œéœ€é€šè¿‡æµé‡æ§åˆ¶ï¼ˆå¦‚ TCP æ»‘åŠ¨çª—å£ï¼‰æˆ–æœåŠ¡é™çº§ç¼“è§£ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("é˜²ç«å¢™ä¸ NAT ç©¿é€")]),t._v("ï¼šè·¨ç½‘ç»œç¯å¢ƒè°ƒç”¨æ—¶ï¼Œéœ€è§£å†³ç«¯å£é™åˆ¶æˆ–ä½¿ç”¨åå‘ä»£ç†ï¼ˆå¦‚ Ngrokï¼‰ã€‚")])]),t._v(" "),a("p",[a("strong",[t._v("æ€»ç»“ï¼šRPC æ ¸å¿ƒæŠ€æœ¯æ ˆ")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[t._v("é—®é¢˜ç»´åº¦")])]),t._v(" "),a("th",[a("strong",[t._v("å…³é”®æŠ€æœ¯")])]),t._v(" "),a("th",[a("strong",[t._v("å…¸å‹å·¥å…· / æ¡†æ¶")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("Call ID æ˜ å°„")]),t._v(" "),a("td",[t._v("å”¯ä¸€ ID ç”Ÿæˆã€æ³¨å†Œä¸­å¿ƒã€åŠ¨æ€è·¯ç”±")]),t._v(" "),a("td",[t._v("Consulã€Nacosã€Apache ZooKeeper")])]),t._v(" "),a("tr",[a("td",[t._v("åºåˆ—åŒ–ååºåˆ—åŒ–")]),t._v(" "),a("td",[t._v("Protobufã€JSONã€Thriftã€Avro")]),t._v(" "),a("td",[t._v("Google Protobufã€Apache Thrift")])]),t._v(" "),a("tr",[a("td",[t._v("ç½‘ç»œä¼ è¾“")]),t._v(" "),a("td",[t._v("TCP/UDPã€HTTP/2ã€è´Ÿè½½å‡è¡¡ã€è¿æ¥æ± ")]),t._v(" "),a("td",[t._v("gRPCã€Nettyã€Spring Cloud Netflix")])])])]),t._v(" "),a("p",[a("strong",[t._v("è®¾è®¡ç›®æ ‡")]),t._v("ï¼šé€šè¿‡ä¸Šè¿°æŠ€æœ¯çš„æœ‰æœºç»„åˆï¼Œå®ç°"),a("strong",[t._v("é€æ˜åŒ–è¿œç¨‹è°ƒç”¨")]),t._v("ï¼ˆè°ƒç”¨è€…æ— éœ€æ„ŸçŸ¥ç½‘ç»œç»†èŠ‚ï¼‰ã€"),a("strong",[t._v("é«˜æ€§èƒ½é€šä¿¡")]),t._v("ï¼ˆä½å»¶è¿Ÿã€é«˜ååï¼‰å’Œ"),a("strong",[t._v("å¼ºå…¼å®¹æ€§")]),t._v("ï¼ˆè·¨è¯­è¨€ã€è·¨å¹³å°ï¼‰ã€‚å®é™…åº”ç”¨ä¸­éœ€æ ¹æ®ä¸šåŠ¡åœºæ™¯ï¼ˆå¦‚å®æ—¶æ€§ã€æ•°æ®é‡ã€è¯­è¨€æ ˆï¼‰é€‰æ‹©åˆé€‚çš„æŠ€æœ¯æ–¹æ¡ˆï¼Œå¹³è¡¡å¼€å‘æˆæœ¬ä¸ç³»ç»Ÿæ€§èƒ½ã€‚")]),t._v(" "),a("h3",{attrs:{id:"ğŸ¯-å®ç°é«˜å¯ç”¨rpcæ¡†æ¶éœ€è¦è€ƒè™‘åˆ°çš„é—®é¢˜"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å®ç°é«˜å¯ç”¨rpcæ¡†æ¶éœ€è¦è€ƒè™‘åˆ°çš„é—®é¢˜"}},[t._v("#")]),t._v(" ğŸ¯ å®ç°é«˜å¯ç”¨RPCæ¡†æ¶éœ€è¦è€ƒè™‘åˆ°çš„é—®é¢˜")]),t._v(" "),a("ul",[a("li",[t._v("æ—¢ç„¶ç³»ç»Ÿé‡‡ç”¨åˆ†å¸ƒå¼æ¶æ„ï¼Œé‚£ä¸€ä¸ªæœåŠ¡åŠ¿å¿…ä¼šæœ‰å¤šä¸ªå®ä¾‹ï¼Œè¦è§£å†³"),a("strong",[t._v("å¦‚ä½•è·å–å®ä¾‹çš„é—®é¢˜")]),t._v("ã€‚æ‰€ä»¥éœ€è¦ä¸€ä¸ªæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œæ¯”å¦‚åœ¨Dubboä¸­ï¼Œå°±å¯ä»¥ä½¿ç”¨Zookeeperä½œä¸ºæ³¨å†Œä¸­å¿ƒï¼Œåœ¨è°ƒç”¨æ—¶ï¼Œä»Zookeeperè·å–æœåŠ¡çš„å®ä¾‹åˆ—è¡¨ï¼Œå†ä»ä¸­é€‰æ‹©ä¸€ä¸ªè¿›è¡Œè°ƒç”¨ï¼›")]),t._v(" "),a("li",[t._v("å¦‚ä½•é€‰æ‹©å®ä¾‹å‘¢ï¼Ÿå°±è¦è€ƒè™‘è´Ÿè½½å‡è¡¡ï¼Œä¾‹å¦‚dubboæä¾›äº†4ç§è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼›")]),t._v(" "),a("li",[t._v("å¦‚æœæ¯æ¬¡éƒ½å»æ³¨å†Œä¸­å¿ƒæŸ¥è¯¢åˆ—è¡¨ï¼Œæ•ˆç‡å¾ˆä½ï¼Œé‚£ä¹ˆå°±è¦åŠ ç¼“å­˜ï¼›")]),t._v(" "),a("li",[t._v("å®¢æˆ·ç«¯æ€»ä¸èƒ½æ¯æ¬¡è°ƒç”¨å®Œéƒ½ç­‰ç€æœåŠ¡ç«¯è¿”å›æ•°æ®ï¼Œæ‰€ä»¥å°±è¦æ”¯æŒå¼‚æ­¥è°ƒç”¨ï¼›")]),t._v(" "),a("li",[t._v("æœåŠ¡ç«¯çš„æ¥å£ä¿®æ”¹äº†ï¼Œè€çš„æ¥å£è¿˜æœ‰äººåœ¨ç”¨ï¼Œè¿™å°±éœ€è¦ç‰ˆæœ¬æ§åˆ¶ï¼›")]),t._v(" "),a("li",[t._v("æœåŠ¡ç«¯æ€»ä¸èƒ½æ¯æ¬¡æ¥åˆ°è¯·æ±‚éƒ½é©¬ä¸Šå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹å»å¤„ç†ï¼Œäºæ˜¯å°±éœ€è¦çº¿ç¨‹æ± ï¼›")])]),t._v(" "),a("h3",{attrs:{id:"ğŸ¯-ä¸€æ¬¡å®Œæ•´çš„-rpc-æµç¨‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-ä¸€æ¬¡å®Œæ•´çš„-rpc-æµç¨‹"}},[t._v("#")]),t._v(" ğŸ¯ ä¸€æ¬¡å®Œæ•´çš„ RPC æµç¨‹ï¼Ÿ")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("ä»£ç†æ‹¦æˆª")]),t._v("ï¼šå®¢æˆ·ç«¯ä»£ç†æ‹¦æˆªæœ¬åœ°è°ƒç”¨ï¼Œè§£ææ–¹æ³•å’Œå‚æ•°ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("åºåˆ—åŒ–")]),t._v("ï¼šå°†å¯¹è±¡è½¬ä¸ºå­—èŠ‚æµï¼ˆå¦‚ Protobufï¼‰ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("ç½‘ç»œä¼ è¾“")]),t._v("ï¼šé€šè¿‡ TCP/HTTP2 å‘é€ï¼Œå¤„ç†ç²˜åŒ…ã€è´Ÿè½½å‡è¡¡ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("æœåŠ¡ç«¯è§£æ")]),t._v("ï¼šæ‹†åŒ…ã€ååºåˆ—åŒ–ï¼Œè·¯ç”±åˆ°ç›®æ ‡æ–¹æ³•ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("ç»“æœè¿”å›")]),t._v("ï¼šåºåˆ—åŒ–å“åº”ï¼Œé€†å‘æµç¨‹è¿”å›å®¢æˆ·ç«¯ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("å…³é”®æŠ€æœ¯")]),t._v("ï¼šåè®®è®¾è®¡ã€è¶…æ—¶é‡è¯•ã€æµæ§ç­‰ã€‚")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://learn.lianglianglee.com/%E4%B8%93%E6%A0%8F/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1%E9%9D%A2%E8%AF%95%E7%B2%BE%E8%AE%B2/assets/Ciqc1GABbyeAWysgAAGQtM8Kx4Q574.png",alt:""}})]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"ğŸ“¦-äºŒã€åºåˆ—åŒ–ä¸åè®®"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“¦-äºŒã€åºåˆ—åŒ–ä¸åè®®"}},[t._v("#")]),t._v(" ğŸ“¦ äºŒã€åºåˆ—åŒ–ä¸åè®®")]),t._v(" "),a("p",[a("strong",[t._v("æ ¸å¿ƒç†å¿µ")]),t._v("ï¼šé«˜æ•ˆçš„åºåˆ—åŒ–æœºåˆ¶å’Œåè®®è®¾è®¡æ˜¯RPCæ€§èƒ½çš„å…³é”®ï¼Œéœ€è¦å¹³è¡¡é€Ÿåº¦ã€å¤§å°å’Œå…¼å®¹æ€§ã€‚")]),t._v(" "),a("h3",{attrs:{id:"ğŸ¯-å¸¸è§çš„åºåˆ—åŒ–æ–¹æ¡ˆæœ‰å“ªäº›-å„è‡ªçš„ç‰¹ç‚¹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å¸¸è§çš„åºåˆ—åŒ–æ–¹æ¡ˆæœ‰å“ªäº›-å„è‡ªçš„ç‰¹ç‚¹"}},[t._v("#")]),t._v(" ğŸ¯ å¸¸è§çš„åºåˆ—åŒ–æ–¹æ¡ˆæœ‰å“ªäº›ï¼Ÿå„è‡ªçš„ç‰¹ç‚¹ï¼Ÿ")]),t._v(" "),a("p",[t._v("ä¸»æµåºåˆ—åŒ–æŠ€æœ¯å¯¹æ¯”ï¼š")]),t._v(" "),a("p",[a("strong",[t._v("1. JDKåºåˆ—åŒ–")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("ä¼˜ç‚¹")]),t._v("ï¼šJavaåŸç”Ÿæ”¯æŒï¼Œä½¿ç”¨ç®€å•")]),t._v(" "),a("li",[a("strong",[t._v("ç¼ºç‚¹")]),t._v("ï¼šæ€§èƒ½å·®ï¼Œåºåˆ—åŒ–æ•°æ®å¤§ï¼Œç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜")]),t._v(" "),a("li",[a("strong",[t._v("é€‚ç”¨åœºæ™¯")]),t._v("ï¼šç®€å•åœºæ™¯ï¼Œå†…éƒ¨ç³»ç»Ÿ")])]),t._v(" "),a("p",[a("strong",[t._v("2. JSONåºåˆ—åŒ–")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("ä¼˜ç‚¹")]),t._v("ï¼šå¯è¯»æ€§å¥½ï¼Œè·¨è¯­è¨€æ”¯æŒ")]),t._v(" "),a("li",[a("strong",[t._v("ç¼ºç‚¹")]),t._v("ï¼šæ€§èƒ½ä¸€èˆ¬ï¼Œæ•°æ®å†—ä½™")]),t._v(" "),a("li",[a("strong",[t._v("é€‚ç”¨åœºæ™¯")]),t._v("ï¼šWeb APIï¼Œè°ƒè¯•å‹å¥½åœºæ™¯")])]),t._v(" "),a("p",[a("strong",[t._v("3. Protobuf")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("ä¼˜ç‚¹")]),t._v("ï¼šæ€§èƒ½ä¼˜ç§€ï¼Œæ•°æ®ç´§å‡‘ï¼Œå‘åå…¼å®¹")]),t._v(" "),a("li",[a("strong",[t._v("ç¼ºç‚¹")]),t._v("ï¼šéœ€è¦å®šä¹‰.protoæ–‡ä»¶ï¼Œå­¦ä¹ æˆæœ¬")]),t._v(" "),a("li",[a("strong",[t._v("é€‚ç”¨åœºæ™¯")]),t._v("ï¼šé«˜æ€§èƒ½åœºæ™¯ï¼Œè·¨è¯­è¨€è°ƒç”¨")])]),t._v(" "),a("p",[a("strong",[t._v("4. Hessian")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("ä¼˜ç‚¹")]),t._v("ï¼šæ€§èƒ½å¥½ï¼Œæ”¯æŒå¤šè¯­è¨€")]),t._v(" "),a("li",[a("strong",[t._v("ç¼ºç‚¹")]),t._v("ï¼šå¤æ‚ç±»å‹æ”¯æŒæœ‰é™")]),t._v(" "),a("li",[a("strong",[t._v("é€‚ç”¨åœºæ™¯")]),t._v("ï¼šDubboç­‰RPCæ¡†æ¶")])]),t._v(" "),a("p",[a("strong",[t._v("5. Kryo")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("ä¼˜ç‚¹")]),t._v("ï¼šæ€§èƒ½æä½³ï¼Œåºåˆ—åŒ–æ•°æ®å°")]),t._v(" "),a("li",[a("strong",[t._v("ç¼ºç‚¹")]),t._v("ï¼šåªæ”¯æŒJavaï¼Œç‰ˆæœ¬å…¼å®¹æ€§é—®é¢˜")]),t._v(" "),a("li",[a("strong",[t._v("é€‚ç”¨åœºæ™¯")]),t._v("ï¼šJavaå†…éƒ¨ç³»ç»Ÿï¼Œæ€§èƒ½è¦æ±‚æé«˜")])]),t._v(" "),a("p",[a("strong",[t._v("ğŸ’» æ€§èƒ½å¯¹æ¯”æ•°æ®")]),t._v("ï¼š")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("åºåˆ—åŒ–æ–¹æ¡ˆ")]),t._v(" "),a("th",[t._v("åºåˆ—åŒ–é€Ÿåº¦")]),t._v(" "),a("th",[t._v("ååºåˆ—åŒ–é€Ÿåº¦")]),t._v(" "),a("th",[t._v("æ•°æ®å¤§å°")]),t._v(" "),a("th",[t._v("è·¨è¯­è¨€")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("JDK")]),t._v(" "),a("td",[t._v("æ…¢")]),t._v(" "),a("td",[t._v("æ…¢")]),t._v(" "),a("td",[t._v("å¤§")]),t._v(" "),a("td",[t._v("âŒ")])]),t._v(" "),a("tr",[a("td",[t._v("JSON")]),t._v(" "),a("td",[t._v("ä¸­ç­‰")]),t._v(" "),a("td",[t._v("ä¸­ç­‰")]),t._v(" "),a("td",[t._v("ä¸­ç­‰")]),t._v(" "),a("td",[t._v("âœ…")])]),t._v(" "),a("tr",[a("td",[t._v("Protobuf")]),t._v(" "),a("td",[t._v("å¿«")]),t._v(" "),a("td",[t._v("å¿«")]),t._v(" "),a("td",[t._v("å°")]),t._v(" "),a("td",[t._v("âœ…")])]),t._v(" "),a("tr",[a("td",[t._v("Hessian")]),t._v(" "),a("td",[t._v("å¿«")]),t._v(" "),a("td",[t._v("å¿«")]),t._v(" "),a("td",[t._v("å°")]),t._v(" "),a("td",[t._v("âœ…")])]),t._v(" "),a("tr",[a("td",[t._v("Kryo")]),t._v(" "),a("td",[t._v("æå¿«")]),t._v(" "),a("td",[t._v("æå¿«")]),t._v(" "),a("td",[t._v("æå°")]),t._v(" "),a("td",[t._v("âŒ")])])])]),t._v(" "),a("h3",{attrs:{id:"ğŸ¯-å¦‚ä½•è®¾è®¡ä¸€ä¸ªé«˜æ•ˆçš„rpcåè®®"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å¦‚ä½•è®¾è®¡ä¸€ä¸ªé«˜æ•ˆçš„rpcåè®®"}},[t._v("#")]),t._v(" ğŸ¯ å¦‚ä½•è®¾è®¡ä¸€ä¸ªé«˜æ•ˆçš„RPCåè®®ï¼Ÿ")]),t._v(" "),a("p",[t._v("RPCåè®®è®¾è®¡çš„æ ¸å¿ƒè¦ç´ ï¼š")]),t._v(" "),a("p",[a("strong",[t._v("åè®®ç»“æ„è®¾è®¡")]),t._v("ï¼š")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// RPCåè®®æ ¼å¼")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Magic")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Ver")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Type")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Length")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åè®®å¤´")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RequestId")]),t._v("             "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¯·æ±‚IDï¼ˆ8å­—èŠ‚ï¼‰")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Header")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Length")]),t._v("         "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¤´éƒ¨é•¿åº¦")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Body")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Length")]),t._v("           "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¶ˆæ¯ä½“é•¿åº¦")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Headers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("            "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰©å±•å¤´éƒ¨")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("               "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¶ˆæ¯ä½“")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("\n")])])]),a("p",[a("strong",[t._v("è®¾è®¡åŸåˆ™")]),t._v("ï¼š")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("å›ºå®šå¤´éƒ¨")]),t._v("ï¼šä¾¿äºå¿«é€Ÿè§£æ")]),t._v(" "),a("li",[a("strong",[t._v("ç‰ˆæœ¬æ§åˆ¶")]),t._v("ï¼šæ”¯æŒåè®®å‡çº§")]),t._v(" "),a("li",[a("strong",[t._v("ç±»å‹æ ‡è¯†")]),t._v("ï¼šåŒºåˆ†è¯·æ±‚ã€å“åº”ã€å¿ƒè·³ç­‰")]),t._v(" "),a("li",[a("strong",[t._v("é•¿åº¦å­—æ®µ")]),t._v("ï¼šæ”¯æŒå˜é•¿æ¶ˆæ¯")]),t._v(" "),a("li",[a("strong",[t._v("æ‰©å±•æ€§")]),t._v("ï¼šé¢„ç•™æ‰©å±•å­—æ®µ")])]),t._v(" "),a("p",[a("strong",[t._v("ğŸ’» åè®®å®ç°ç¤ºä¾‹")]),t._v("ï¼š")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// RPCåè®®å®šä¹‰")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCProtocol")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MAGIC_NUMBER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0xCAFEBABE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("VERSION")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¶ˆæ¯ç±»å‹")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("TYPE_REQUEST")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("TYPE_RESPONSE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("TYPE_HEARTBEAT")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åè®®ç¼–ç ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ByteBuf")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("encode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCMessage")]),t._v(" message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ByteBuf")]),t._v(" buffer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Unpooled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("buffer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åè®®å¤´")]),t._v("\n        buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeInt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MAGIC_NUMBER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeByte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("VERSION")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeByte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeShort")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// flagsé¢„ç•™")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¯·æ±‚ID")]),t._v("\n        buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeLong")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRequestId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åºåˆ—åŒ–æ¶ˆæ¯ä½“")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" body "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("serialize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("message"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBody")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeInt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeBytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åè®®è§£ç ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCMessage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("decode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ByteBuf")]),t._v(" buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ£€æŸ¥é­”æ•°")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" magic "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readInt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("magic "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MAGIC_NUMBER")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("IllegalArgumentException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Invalid magic number"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¯»å–åè®®å¤´")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),t._v(" version "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readByte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),t._v(" type "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readByte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("short")]),t._v(" flags "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readShort")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" requestId "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readLong")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¯»å–æ¶ˆæ¯ä½“")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" bodyLength "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readInt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" body "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("bodyLength"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        buffer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readBytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("builder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("requestId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("requestId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("deserialize")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("body"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("build")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("hr"),t._v(" "),a("h2",{attrs:{id:"ğŸ—ï¸-ä¸‰ã€æœåŠ¡æ²»ç†"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ—ï¸-ä¸‰ã€æœåŠ¡æ²»ç†"}},[t._v("#")]),t._v(" ğŸ—ï¸ ä¸‰ã€æœåŠ¡æ²»ç†")]),t._v(" "),a("p",[a("strong",[t._v("æ ¸å¿ƒç†å¿µ")]),t._v("ï¼šæœåŠ¡æ²»ç†æ˜¯RPCæ¡†æ¶çš„é«˜çº§ç‰¹æ€§ï¼ŒåŒ…æ‹¬æœåŠ¡å‘ç°ã€è´Ÿè½½å‡è¡¡ã€å®¹é”™å¤„ç†ç­‰ä¼ä¸šçº§åŠŸèƒ½ã€‚")]),t._v(" "),a("h3",{attrs:{id:"ğŸ¯-æœåŠ¡æ³¨å†Œä¸å‘ç°æœºåˆ¶æ˜¯ä»€ä¹ˆ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-æœåŠ¡æ³¨å†Œä¸å‘ç°æœºåˆ¶æ˜¯ä»€ä¹ˆ"}},[t._v("#")]),t._v(" ğŸ¯ æœåŠ¡æ³¨å†Œä¸å‘ç°æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿ")]),t._v(" "),a("p",[t._v("æœåŠ¡æ³¨å†Œå‘ç°æ˜¯å¾®æœåŠ¡æ¶æ„çš„åŸºç¡€ï¼š")]),t._v(" "),a("p",[a("strong",[t._v("æ ¸å¿ƒåŠŸèƒ½")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("æœåŠ¡æ³¨å†Œ")]),t._v("ï¼šæœåŠ¡å¯åŠ¨æ—¶å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œ")]),t._v(" "),a("li",[a("strong",[t._v("æœåŠ¡å‘ç°")]),t._v("ï¼šå®¢æˆ·ç«¯ä»æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡åˆ—è¡¨")]),t._v(" "),a("li",[a("strong",[t._v("å¥åº·æ£€æŸ¥")]),t._v("ï¼šç›‘æ§æœåŠ¡å®ä¾‹å¥åº·çŠ¶æ€")]),t._v(" "),a("li",[a("strong",[t._v("è´Ÿè½½å‡è¡¡")]),t._v("ï¼šåœ¨å¤šä¸ªå®ä¾‹é—´åˆ†é…è¯·æ±‚")])]),t._v(" "),a("p",[a("strong",[t._v("ä¸»æµæ³¨å†Œä¸­å¿ƒ")]),t._v("ï¼š")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("Zookeeper")]),t._v("ï¼šå¼ºä¸€è‡´æ€§ï¼Œå¤æ‚åº¦é«˜")]),t._v(" "),a("li",[a("strong",[t._v("Eureka")]),t._v("ï¼šAPæ¨¡å¼ï¼Œç®€å•æ˜“ç”¨")]),t._v(" "),a("li",[a("strong",[t._v("Consul")]),t._v("ï¼šåŠŸèƒ½ä¸°å¯Œï¼Œæ”¯æŒå¤šæ•°æ®ä¸­å¿ƒ")]),t._v(" "),a("li",[a("strong",[t._v("Nacos")]),t._v("ï¼šé˜¿é‡Œå¼€æºï¼ŒåŠŸèƒ½å…¨é¢")])]),t._v(" "),a("p",[a("strong",[t._v("ğŸ’» ä»£ç ç¤ºä¾‹")]),t._v("ï¼š")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æœåŠ¡æ³¨å†Œå®ç°")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceRegistry")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ZooKeeperClient")]),t._v(" zkClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ³¨å†ŒæœåŠ¡")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("registerService")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),t._v(" serviceInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" servicePath "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/rpc/services/"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" serviceInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getServiceName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" instancePath "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" servicePath "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" serviceInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstanceId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»ºä¸´æ—¶é¡ºåºèŠ‚ç‚¹")]),t._v("\n        zkClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createEphemeralSequential")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("instancePath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n            "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toJSONString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("serviceInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getBytes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ³¨å†Œshutdown hook")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Runtime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRuntime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addShutdownHook")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Thread")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            zkClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("delete")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("instancePath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å‘ç°æœåŠ¡")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("discoverServices")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" serviceName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" servicePath "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/rpc/services/"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" serviceName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" children "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" zkClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getChildren")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("servicePath"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("child "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("byte")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" zkClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getData")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("servicePath "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" child"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("JSON")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parseObject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("collect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Collectors")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æœåŠ¡ä¿¡æ¯å®šä¹‰")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Data")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" serviceName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" instanceId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" host"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" port"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" metadata"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" timestamp"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"ğŸ¯-è´Ÿè½½å‡è¡¡ç®—æ³•æœ‰å“ªäº›-å¦‚ä½•å®ç°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-è´Ÿè½½å‡è¡¡ç®—æ³•æœ‰å“ªäº›-å¦‚ä½•å®ç°"}},[t._v("#")]),t._v(" ğŸ¯ è´Ÿè½½å‡è¡¡ç®—æ³•æœ‰å“ªäº›ï¼Ÿå¦‚ä½•å®ç°ï¼Ÿ")]),t._v(" "),a("p",[t._v("å¸¸è§è´Ÿè½½å‡è¡¡ç®—æ³•åŠå…¶å®ç°ï¼š")]),t._v(" "),a("p",[a("strong",[t._v("1. è½®è¯¢ï¼ˆRound Robinï¼‰")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("æŒ‰é¡ºåºä¾æ¬¡åˆ†é…è¯·æ±‚")]),t._v(" "),a("li",[t._v("ç®€å•å…¬å¹³ï¼Œä½†ä¸è€ƒè™‘æœåŠ¡å™¨æ€§èƒ½å·®å¼‚")])]),t._v(" "),a("p",[a("strong",[t._v("2. åŠ æƒè½®è¯¢ï¼ˆWeighted Round Robinï¼‰")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("æ ¹æ®æƒé‡åˆ†é…è¯·æ±‚")]),t._v(" "),a("li",[t._v("è€ƒè™‘æœåŠ¡å™¨æ€§èƒ½å·®å¼‚")])]),t._v(" "),a("p",[a("strong",[t._v("3. éšæœºï¼ˆRandomï¼‰")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("éšæœºé€‰æ‹©æœåŠ¡å™¨")]),t._v(" "),a("li",[t._v("å®ç°ç®€å•ï¼Œé•¿æœŸæ¥çœ‹åˆ†å¸ƒå‡åŒ€")])]),t._v(" "),a("p",[a("strong",[t._v("4. æœ€å°‘æ´»è·ƒæ•°ï¼ˆLeast Activeï¼‰")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("é€‰æ‹©å½“å‰æ´»è·ƒè¯·æ±‚æ•°æœ€å°‘çš„æœåŠ¡å™¨")]),t._v(" "),a("li",[t._v("é€‚åº”ä¸åŒæœåŠ¡å™¨çš„å¤„ç†èƒ½åŠ›")])]),t._v(" "),a("p",[a("strong",[t._v("5. ä¸€è‡´æ€§å“ˆå¸Œï¼ˆConsistent Hashï¼‰")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("ç›¸åŒå‚æ•°çš„è¯·æ±‚è·¯ç”±åˆ°åŒä¸€æœåŠ¡å™¨")]),t._v(" "),a("li",[t._v("é€‚ç”¨äºæœ‰çŠ¶æ€çš„æœåŠ¡")])]),t._v(" "),a("p",[a("strong",[t._v("ğŸ’» ä»£ç å®ç°")]),t._v("ï¼š")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è´Ÿè½½å‡è¡¡æ¥å£")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoadBalancer")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCRequest")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è½®è¯¢è´Ÿè½½å‡è¡¡")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RoundRobinLoadBalancer")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoadBalancer")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicInteger")]),t._v(" index "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCRequest")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isEmpty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" currentIndex "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Math")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("abs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAndIncrement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("currentIndex "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("%")]),t._v(" services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åŠ æƒè½®è¯¢è´Ÿè½½å‡è¡¡")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeightedRoundRobinLoadBalancer")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoadBalancer")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConcurrentHashMap")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeightedServer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" servers "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConcurrentHashMap")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCRequest")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isEmpty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ›´æ–°æƒé‡ä¿¡æ¯")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateWeights")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é€‰æ‹©æƒé‡æœ€é«˜çš„æœåŠ¡å™¨")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeightedServer")]),t._v(" selected "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" totalWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),t._v(" service "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeightedServer")]),t._v(" server "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" servers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstanceId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("currentWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("effectiveWeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            totalWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("effectiveWeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            \n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("selected "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("currentWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" selected"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("currentWeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                selected "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" server"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("selected "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            selected"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("currentWeight "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-=")]),t._v(" totalWeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" selected"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("serviceInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("WeightedServer")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),t._v(" serviceInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" effectiveWeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æœ‰æ•ˆæƒé‡")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" currentWeight"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“å‰æƒé‡")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¸€è‡´æ€§å“ˆå¸Œè´Ÿè½½å‡è¡¡")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConsistentHashLoadBalancer")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoadBalancer")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TreeMap")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" virtualNodes "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TreeMap")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" virtualNodeCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("160")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è™šæ‹ŸèŠ‚ç‚¹æ•°é‡")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCRequest")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isEmpty")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ„å»ºå“ˆå¸Œç¯")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildHashRing")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¡ç®—è¯·æ±‚çš„å“ˆå¸Œå€¼")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" key "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" hash "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºç­‰äºè¯¥å“ˆå¸Œå€¼çš„è™šæ‹ŸèŠ‚ç‚¹")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Entry")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" entry "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" virtualNodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ceilingEntry")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("entry "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            entry "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" virtualNodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("firstEntry")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" entry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildHashRing")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        virtualNodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("clear")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),t._v(" service "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" services"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" virtualNodeCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" virtualNodeKey "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getInstanceId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" hash "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("virtualNodeKey"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                virtualNodes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hash"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" service"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildKey")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCRequest")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ ¹æ®è¯·æ±‚å‚æ•°æ„å»ºkey")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getServiceName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" \n               "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Arrays")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hashCode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getParameters")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hash")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä½¿ç”¨MurmurHashæˆ–å…¶ä»–å“ˆå¸Œç®—æ³•")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hashCode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"ğŸ¯-å¦‚ä½•å®ç°ç†”æ–­é™çº§æœºåˆ¶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å¦‚ä½•å®ç°ç†”æ–­é™çº§æœºåˆ¶"}},[t._v("#")]),t._v(" ğŸ¯ å¦‚ä½•å®ç°ç†”æ–­é™çº§æœºåˆ¶ï¼Ÿ")]),t._v(" "),a("p",[t._v("ç†”æ–­é™çº§æ˜¯ä¿éšœç³»ç»Ÿç¨³å®šæ€§çš„é‡è¦æœºåˆ¶ï¼š")]),t._v(" "),a("p",[a("strong",[t._v("ç†”æ–­å™¨çŠ¶æ€")]),t._v("ï¼š")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("CLOSED")]),t._v("ï¼šæ­£å¸¸çŠ¶æ€ï¼Œè¯·æ±‚æ­£å¸¸é€šè¿‡")]),t._v(" "),a("li",[a("strong",[t._v("OPEN")]),t._v("ï¼šç†”æ–­çŠ¶æ€ï¼Œå¿«é€Ÿå¤±è´¥")]),t._v(" "),a("li",[a("strong",[t._v("HALF_OPEN")]),t._v("ï¼šåŠå¼€çŠ¶æ€ï¼Œå…è®¸å°‘é‡è¯·æ±‚æµ‹è¯•")])]),t._v(" "),a("p",[a("strong",[t._v("é™çº§ç­–ç•¥")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("å¿«é€Ÿå¤±è´¥")]),t._v("ï¼šç›´æ¥è¿”å›é”™è¯¯")]),t._v(" "),a("li",[a("strong",[t._v("é»˜è®¤å€¼")]),t._v("ï¼šè¿”å›é¢„è®¾çš„é»˜è®¤å€¼")]),t._v(" "),a("li",[a("strong",[t._v("ç¼“å­˜æ•°æ®")]),t._v("ï¼šè¿”å›ç¼“å­˜çš„å†å²æ•°æ®")]),t._v(" "),a("li",[a("strong",[t._v("è°ƒç”¨å¤‡ç”¨æœåŠ¡")]),t._v("ï¼šè°ƒç”¨å¤‡ç”¨çš„æœåŠ¡å®ç°")])]),t._v(" "),a("p",[a("strong",[t._v("ğŸ’» ä»£ç å®ç°")]),t._v("ï¼š")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç†”æ–­å™¨å®ç°")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CircuitBreaker")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("volatile")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("State")]),t._v(" state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("State")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CLOSED")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicInteger")]),t._v(" failureCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicInteger")]),t._v(" requestCount "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AtomicInteger")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("volatile")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" lastFailureTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" failureThreshold"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¤±è´¥é˜ˆå€¼")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("int")]),t._v(" timeout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("               "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¶…æ—¶æ—¶é—´")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),t._v(" failureRatio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¤±è´¥ç‡é˜ˆå€¼")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("enum")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("State")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CLOSED")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("OPEN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HALF_OPEN")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("execute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Supplier")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" supplier"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Function")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" fallback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("canExecute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" fallback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CircuitBreakerOpenException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("T")]),t._v(" result "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" supplier"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onSuccess")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" result"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onFailure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" fallback"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("boolean")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("canExecute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("State")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CLOSED")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("State")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("OPEN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" lastFailureTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" timeout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("State")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HALF_OPEN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// HALF_OPENçŠ¶æ€å…è®¸ä¸€ä¸ªè¯·æ±‚é€šè¿‡")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onSuccess")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("State")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HALF_OPEN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("State")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CLOSED")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            failureCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            requestCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("onFailure")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        failureCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("incrementAndGet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        requestCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("incrementAndGet")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        lastFailureTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("State")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HALF_OPEN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("State")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("OPEN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("State")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CLOSED")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("failureCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" failureThreshold "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" \n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" failureCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" requestCount"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" failureRatio"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("State")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("OPEN")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// RPCå®¢æˆ·ç«¯é›†æˆç†”æ–­å™¨")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCClientWithCircuitBreaker")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCClient")]),t._v(" rpcClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CircuitBreaker")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" circuitBreakers "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConcurrentHashMap")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" serviceName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCRequest")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CircuitBreaker")]),t._v(" circuitBreaker "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCircuitBreaker")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("serviceName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" circuitBreaker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("execute")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" rpcClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("serviceName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            exception "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é™çº§å¤„ç†")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createFallbackResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exception"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CircuitBreaker")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCircuitBreaker")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" serviceName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" circuitBreakers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("computeIfAbsent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("serviceName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n            key "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CircuitBreaker")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("60000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.5")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createFallbackResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCRequest")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" exception"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ ¹æ®æœåŠ¡ç±»å‹è¿”å›ä¸åŒçš„é™çº§æ•°æ®")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getServiceName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("contains")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UserService"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("success")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getDefaultUser")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getServiceName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("contains")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ProductService"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("success")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getCachedProducts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Service temporarily unavailable"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" exception"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("hr"),t._v(" "),a("h2",{attrs:{id:"âš¡-å››ã€æ€§èƒ½ä¼˜åŒ–"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#âš¡-å››ã€æ€§èƒ½ä¼˜åŒ–"}},[t._v("#")]),t._v(" âš¡ å››ã€æ€§èƒ½ä¼˜åŒ–")]),t._v(" "),a("p",[a("strong",[t._v("æ ¸å¿ƒç†å¿µ")]),t._v("ï¼šRPCæ€§èƒ½ä¼˜åŒ–éœ€è¦ä»ç½‘ç»œã€åºåˆ—åŒ–ã€è¿æ¥ç®¡ç†ã€å¼‚æ­¥å¤„ç†ç­‰å¤šä¸ªç»´åº¦è¿›è¡Œç³»ç»Ÿæ€§ä¼˜åŒ–ã€‚")]),t._v(" "),a("h3",{attrs:{id:"ğŸ¯-rpcæ€§èƒ½ä¼˜åŒ–æœ‰å“ªäº›æ‰‹æ®µ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-rpcæ€§èƒ½ä¼˜åŒ–æœ‰å“ªäº›æ‰‹æ®µ"}},[t._v("#")]),t._v(" ğŸ¯ RPCæ€§èƒ½ä¼˜åŒ–æœ‰å“ªäº›æ‰‹æ®µï¼Ÿ")]),t._v(" "),a("p",[t._v("RPCæ€§èƒ½ä¼˜åŒ–çš„ç³»ç»Ÿæ€§æ–¹æ³•ï¼š")]),t._v(" "),a("p",[a("strong",[t._v("1. ç½‘ç»œå±‚ä¼˜åŒ–")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("ä½¿ç”¨é«˜æ€§èƒ½çš„NIOæ¡†æ¶ï¼ˆNettyï¼‰")]),t._v(" "),a("li",[t._v("å¯ç”¨TCP_NODELAYå‡å°‘å»¶è¿Ÿ")]),t._v(" "),a("li",[t._v("è°ƒæ•´TCPå‘é€/æ¥æ”¶ç¼“å†²åŒºå¤§å°")]),t._v(" "),a("li",[t._v("ä½¿ç”¨è¿æ¥æ± å¤ç”¨è¿æ¥")])]),t._v(" "),a("p",[a("strong",[t._v("2. åºåˆ—åŒ–ä¼˜åŒ–")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("é€‰æ‹©é«˜æ€§èƒ½åºåˆ—åŒ–æ¡†æ¶")]),t._v(" "),a("li",[t._v("å‡å°‘åºåˆ—åŒ–å¯¹è±¡çš„å¤æ‚åº¦")]),t._v(" "),a("li",[t._v("ä½¿ç”¨å¯¹è±¡æ± å‡å°‘GCå‹åŠ›")]),t._v(" "),a("li",[t._v("å‹ç¼©ä¼ è¾“æ•°æ®")])]),t._v(" "),a("p",[a("strong",[t._v("3. å¼‚æ­¥åŒ–å¤„ç†")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("å®¢æˆ·ç«¯å¼‚æ­¥è°ƒç”¨")]),t._v(" "),a("li",[t._v("æœåŠ¡ç«¯å¼‚æ­¥å¤„ç†")]),t._v(" "),a("li",[t._v("æ‰¹é‡è°ƒç”¨å‡å°‘ç½‘ç»œå¼€é”€")]),t._v(" "),a("li",[t._v("æµæ°´çº¿å¤„ç†æé«˜ååé‡")])]),t._v(" "),a("p",[a("strong",[t._v("ğŸ’» ä»£ç ç¤ºä¾‹")]),t._v("ï¼š")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é«˜æ€§èƒ½RPCå®¢æˆ·ç«¯å®ç°")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HighPerformanceRPCClient")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EventLoopGroup")]),t._v(" eventLoopGroup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Bootstrap")]),t._v(" bootstrap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("LoadBalancer")]),t._v(" loadBalancer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Channel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" connectionPool "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConcurrentHashMap")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("HighPerformanceRPCClient")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä½¿ç”¨Netty NIO")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("eventLoopGroup "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NioEventLoopGroup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Runtime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRuntime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("availableProcessors")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("bootstrap "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Bootstrap")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("group")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("eventLoopGroup"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("channel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("NioSocketChannel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("option")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ChannelOption")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("TCP_NODELAY")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("option")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ChannelOption")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SO_KEEPALIVE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("option")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ChannelOption")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SO_RCVBUF")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("65536")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("option")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ChannelOption")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SO_SNDBUF")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("65536")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handler")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCClientInitializer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¼‚æ­¥è°ƒç”¨")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompletableFuture")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("callAsync")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCRequest")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),t._v(" serviceInfo "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" loadBalancer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAvailableServices")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getServiceName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            \n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Channel")]),t._v(" channel "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getOrCreateConnection")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("serviceInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompletableFuture")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" future "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompletableFuture")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ³¨å†Œå›è°ƒ")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" requestId "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRequestId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ResponseFutureManager")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("requestId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" future"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å‘é€è¯·æ±‚")]),t._v("\n        channel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeAndFlush")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("writeFuture "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("writeFuture"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isSuccess")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ResponseFutureManager")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("requestId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                future"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("completeExceptionally")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("writeFuture"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("cause")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" future"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰¹é‡è°ƒç”¨")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompletableFuture")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("batchCall")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" requests"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" groupedRequests "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" requests"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("collect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Collectors")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("groupingBy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" \n                loadBalancer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAvailableServices")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getServiceName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("List")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompletableFuture")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" futures "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ArrayList")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        groupedRequests"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("serviceInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" serviceRequests"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Channel")]),t._v(" channel "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getOrCreateConnection")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("serviceInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            \n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCRequest")]),t._v(" request "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" serviceRequests"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompletableFuture")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" future "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompletableFuture")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ResponseFutureManager")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRequestId")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" future"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                futures"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("future"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                \n                channel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeAndFlush")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompletableFuture")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("allOf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("futures"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toArray")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompletableFuture")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("thenApply")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" futures"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("stream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompletableFuture")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("::")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("collect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Collectors")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toList")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿æ¥æ± ç®¡ç†")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Channel")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getOrCreateConnection")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ServiceInfo")]),t._v(" serviceInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" key "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" serviceInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getHost")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('":"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" serviceInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPort")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" connectionPool"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("computeIfAbsent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" k "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ChannelFuture")]),t._v(" future "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" bootstrap"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("connect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n                    serviceInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getHost")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" serviceInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPort")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" future"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sync")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("channel")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RuntimeException")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Failed to create connection"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å“åº”Futureç®¡ç†å™¨")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ResponseFutureManager")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Map")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompletableFuture")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FUTURES")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ConcurrentHashMap")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" requestId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompletableFuture")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" future"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FUTURES")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("put")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("requestId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" future"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½®è¶…æ—¶å¤„ç†")]),t._v("\n        future"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("orTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TimeUnit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MILLISECONDS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("whenComplete")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" throwable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FUTURES")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("requestId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("complete")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" requestId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompletableFuture")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" future "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FUTURES")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("requestId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("future "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            future"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("complete")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("completeExceptionally")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" requestId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Throwable")]),t._v(" throwable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CompletableFuture")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" future "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FUTURES")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("requestId"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("future "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            future"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("completeExceptionally")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("throwable"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"ğŸ¯-å¦‚ä½•æå‡ç½‘ç»œé€šä¿¡æ€§èƒ½"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å¦‚ä½•æå‡ç½‘ç»œé€šä¿¡æ€§èƒ½"}},[t._v("#")]),t._v(" ğŸ¯ å¦‚ä½•æå‡ç½‘ç»œé€šä¿¡æ€§èƒ½ï¼Ÿ")]),t._v(" "),a("p",[t._v("å¦‚ä½•æå‡ RPC çš„ç½‘ç»œé€šä¿¡æ€§èƒ½ï¼Œè¿™å¥è¯ç¿»è¯‘ä¸€ä¸‹å°±æ˜¯ï¼šä¸€ä¸ª RPC æ¡†æ¶å¦‚ä½•é€‰æ‹©é«˜æ€§èƒ½çš„ç½‘ç»œç¼–ç¨‹ I/O æ¨¡å‹ï¼Ÿè¿™æ ·ä¸€æ¥ï¼Œå’Œ I/O æ¨¡å‹ç›¸å…³çš„çŸ¥è¯†ç‚¹å°±æ˜¯ä½ éœ€è¦æŒæ¡çš„äº†ã€‚")]),t._v(" "),a("p",[t._v("å¯¹äº RPC ç½‘ç»œé€šä¿¡é—®é¢˜ï¼Œä½ é¦–å…ˆè¦æŒæ¡ç½‘ç»œç¼–ç¨‹ä¸­çš„äº”ä¸ª I/O æ¨¡å‹ï¼š")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("åŒæ­¥é˜»å¡ I/Oï¼ˆBIOï¼‰")])]),t._v(" "),a("li",[a("p",[t._v("åŒæ­¥éé˜»å¡ I/O")])]),t._v(" "),a("li",[a("p",[t._v("I/O å¤šè·¯å¤ç”¨ï¼ˆNIOï¼‰")])]),t._v(" "),a("li",[a("p",[t._v("ä¿¡å·é©±åŠ¨")])]),t._v(" "),a("li",[a("p",[t._v("ä»¥åŠå¼‚æ­¥ I/Oï¼ˆAIOï¼‰")])])]),t._v(" "),a("p",[t._v("ä½†åœ¨å®é™…å¼€å‘å·¥ä½œï¼Œæœ€ä¸ºå¸¸ç”¨çš„æ˜¯ BIO å’Œ NIOï¼ˆè¿™ä¸¤ä¸ª I/O æ¨¡å‹ä¹Ÿæ˜¯é¢è¯•ä¸­é¢è¯•å®˜æœ€å¸¸è€ƒå¯Ÿå€™é€‰äººçš„ï¼‰ã€‚")]),t._v(" "),a("p",[t._v("NIO æ¯” BIO æé«˜äº†æœåŠ¡ç«¯å·¥ä½œçº¿ç¨‹çš„åˆ©ç”¨ç‡ï¼Œå¹¶å¢åŠ äº†ä¸€ä¸ªè°ƒåº¦è€…ï¼Œæ¥å®ç° Socket è¿æ¥ä¸ Socket æ•°æ®è¯»å†™ä¹‹é—´çš„åˆ†ç¦»ã€‚")]),t._v(" "),a("p",[t._v("åœ¨ç›®å‰ä¸»æµçš„ RPC æ¡†æ¶ä¸­ï¼Œå¹¿æ³›ä½¿ç”¨çš„ä¹Ÿæ˜¯ I/O å¤šè·¯å¤ç”¨æ¨¡å‹ï¼ŒLinux ç³»ç»Ÿä¸­çš„ selectã€pollã€epollç­‰ç³»ç»Ÿè°ƒç”¨éƒ½æ˜¯ I/O å¤šè·¯å¤ç”¨çš„æœºåˆ¶ã€‚")]),t._v(" "),a("p",[t._v("åœ¨é¢è¯•ä¸­ï¼Œå¯¹äºé«˜çº§ç ”å‘å·¥ç¨‹å¸ˆçš„è€ƒå¯Ÿï¼Œè¿˜ä¼šæœ‰ä¸¤ä¸ªæŠ€æœ¯æ‰©å±•è€ƒæ ¸ç‚¹ã€‚")]),t._v(" "),a("p",[t._v("Reactor æ¨¡å‹ï¼ˆå³ååº”å †æ¨¡å¼ï¼‰ï¼Œä»¥åŠ Reactor çš„ 3 ç§çº¿ç¨‹æ¨¡å‹ï¼Œåˆ†åˆ«æ˜¯å•çº¿ç¨‹ Reactor çº¿ç¨‹æ¨¡å‹ã€å¤šçº¿ç¨‹ Reactor çº¿ç¨‹æ¨¡å‹ï¼Œä»¥åŠä¸»ä» Reactor çº¿ç¨‹æ¨¡å‹ã€‚")]),t._v(" "),a("p",[t._v("Java ä¸­çš„é«˜æ€§èƒ½ç½‘ç»œç¼–ç¨‹æ¡†æ¶ Nettyã€‚")]),t._v(" "),a("p",[t._v("å¯ä»¥è¿™ä¹ˆè¯´ï¼Œåœ¨é«˜æ€§èƒ½ç½‘ç»œç¼–ç¨‹ä¸­ï¼Œå¤§å¤šæ•°éƒ½æ˜¯åŸºäº Reactor æ¨¡å¼ï¼Œå…¶ä¸­æœ€ä¸ºå…¸å‹çš„æ˜¯ Java çš„ Netty æ¡†æ¶ï¼Œè€Œ Reactor æ¨¡å¼æ˜¯åŸºäº I/O å¤šè·¯å¤ç”¨çš„ï¼Œæ‰€ä»¥ï¼Œå¯¹äº Reactor å’Œ Netty çš„è€ƒå¯Ÿä¹Ÿæ˜¯é¿å…ä¸äº†çš„ã€‚")]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"ğŸ”-äº”ã€ä¸»æµæ¡†æ¶å¯¹æ¯”"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ”-äº”ã€ä¸»æµæ¡†æ¶å¯¹æ¯”"}},[t._v("#")]),t._v(" ğŸ” äº”ã€ä¸»æµæ¡†æ¶å¯¹æ¯”")]),t._v(" "),a("p",[a("strong",[t._v("æ ¸å¿ƒç†å¿µ")]),t._v("ï¼šäº†è§£ä¸åŒRPCæ¡†æ¶çš„ç‰¹ç‚¹å’Œé€‚ç”¨åœºæ™¯ï¼Œæ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©åˆé€‚çš„æŠ€æœ¯æ–¹æ¡ˆã€‚")]),t._v(" "),a("h3",{attrs:{id:"ğŸ¯-dubboã€grpcã€thriftæœ‰ä»€ä¹ˆåŒºåˆ«"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-dubboã€grpcã€thriftæœ‰ä»€ä¹ˆåŒºåˆ«"}},[t._v("#")]),t._v(" ğŸ¯ Dubboã€gRPCã€Thriftæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ")]),t._v(" "),a("p",[t._v("ä¸»æµRPCæ¡†æ¶ç‰¹æ€§å¯¹æ¯”ï¼š")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("ç‰¹æ€§")]),t._v(" "),a("th",[t._v("Dubbo")]),t._v(" "),a("th",[t._v("gRPC")]),t._v(" "),a("th",[t._v("Thrift")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("å¼€å‘è¯­è¨€")])]),t._v(" "),a("td",[t._v("Java")]),t._v(" "),a("td",[t._v("å¤šè¯­è¨€")]),t._v(" "),a("td",[t._v("å¤šè¯­è¨€")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("ä¼ è¾“åè®®")])]),t._v(" "),a("td",[t._v("TCP")]),t._v(" "),a("td",[t._v("HTTP/2")]),t._v(" "),a("td",[t._v("TCP")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("åºåˆ—åŒ–")])]),t._v(" "),a("td",[t._v("å¤šç§é€‰æ‹©")]),t._v(" "),a("td",[t._v("Protobuf")]),t._v(" "),a("td",[t._v("Thrift")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("æœåŠ¡æ²»ç†")])]),t._v(" "),a("td",[t._v("ä¸°å¯Œ")]),t._v(" "),a("td",[t._v("åŸºç¡€")]),t._v(" "),a("td",[t._v("åŸºç¡€")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("æ€§èƒ½")])]),t._v(" "),a("td",[t._v("ä¼˜ç§€")]),t._v(" "),a("td",[t._v("ä¼˜ç§€")]),t._v(" "),a("td",[t._v("ä¼˜ç§€")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("ç¤¾åŒºæ´»è·ƒåº¦")])]),t._v(" "),a("td",[t._v("é«˜")]),t._v(" "),a("td",[t._v("é«˜")]),t._v(" "),a("td",[t._v("ä¸­ç­‰")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("å­¦ä¹ æˆæœ¬")])]),t._v(" "),a("td",[t._v("ä¸­ç­‰")]),t._v(" "),a("td",[t._v("ä½")]),t._v(" "),a("td",[t._v("ä¸­ç­‰")])])])]),t._v(" "),a("p",[a("strong",[t._v("é€‰æ‹©å»ºè®®")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Dubbo")]),t._v("ï¼šJavaç”Ÿæ€ï¼ŒæœåŠ¡æ²»ç†åŠŸèƒ½ä¸°å¯Œ")]),t._v(" "),a("li",[a("strong",[t._v("gRPC")]),t._v("ï¼šè·¨è¯­è¨€åœºæ™¯ï¼ŒGoogleæ”¯æŒ")]),t._v(" "),a("li",[a("strong",[t._v("Thrift")]),t._v("ï¼šFacebookå‡ºå“ï¼Œæ€§èƒ½ä¼˜ç§€")])]),t._v(" "),a("h3",{attrs:{id:"ğŸ¯-spring-cloudä¸dubboçš„å¯¹æ¯”"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-spring-cloudä¸dubboçš„å¯¹æ¯”"}},[t._v("#")]),t._v(" ğŸ¯ Spring Cloudä¸Dubboçš„å¯¹æ¯”ï¼Ÿ")]),t._v(" "),a("p",[t._v("å¾®æœåŠ¡æ¡†æ¶çš„ä¸åŒç†å¿µï¼š")]),t._v(" "),a("p",[a("strong",[t._v("Spring Cloudç‰¹ç‚¹")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("åŸºäºHTTPåè®®ï¼Œç®€å•æ˜“ç”¨")]),t._v(" "),a("li",[t._v("ä¸Springç”Ÿæ€æ·±åº¦é›†æˆ")]),t._v(" "),a("li",[t._v("ç»„ä»¶ä¸°å¯Œï¼Œç”Ÿæ€å®Œæ•´")]),t._v(" "),a("li",[t._v("é€‚åˆå¿«é€Ÿå¼€å‘")])]),t._v(" "),a("p",[a("strong",[t._v("Dubboç‰¹ç‚¹")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("åŸºäºTCPåè®®ï¼Œæ€§èƒ½æ›´ä¼˜")]),t._v(" "),a("li",[t._v("ä¸“æ³¨RPCé€šä¿¡")]),t._v(" "),a("li",[t._v("æœåŠ¡æ²»ç†åŠŸèƒ½å¼ºå¤§")]),t._v(" "),a("li",[t._v("æ›´é€‚åˆé«˜æ€§èƒ½åœºæ™¯")])]),t._v(" "),a("p",[a("strong",[t._v("ğŸ’» ä½¿ç”¨ç¤ºä¾‹")]),t._v("ï¼š")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Dubboä½¿ç”¨ç¤ºä¾‹")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Service")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserServiceImpl")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserService")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUserById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" userRepository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("findById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserController")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Reference")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserService")]),t._v(" userService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUser")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" userService"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUserById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Spring Cloudä½¿ç”¨ç¤ºä¾‹")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@RestController")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserController")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Autowired")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserServiceClient")]),t._v(" userServiceClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@GetMapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/users/{id}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUser")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@PathVariable")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" userServiceClient"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUserById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@FeignClient")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"user-service"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("interface")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserServiceClient")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@GetMapping")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/users/{id}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUserById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@PathVariable")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"ğŸ¯-grpcä¸httpçš„åŒºåˆ«æ˜¯ä»€ä¹ˆ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-grpcä¸httpçš„åŒºåˆ«æ˜¯ä»€ä¹ˆ"}},[t._v("#")]),t._v(" ğŸ¯ gRPCä¸HTTPçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ")]),t._v(" "),a("p",[t._v("HTTPæ˜¯åº”ç”¨å±‚åè®®ï¼Œä¸»è¦ç”¨äºä¼ è¾“è¶…æ–‡æœ¬ï¼Œè€ŒRPCæ˜¯ä¸€ç§è¿œç¨‹è¿‡ç¨‹è°ƒç”¨æ¡†æ¶ï¼Œç”¨äºåˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æœåŠ¡é—´é€šä¿¡ã€‚HTTPåŸºäºæ–‡æœ¬ä¼ è¾“ï¼Œè€ŒRPCé€šå¸¸ä½¿ç”¨äºŒè¿›åˆ¶åºåˆ—åŒ–åè®®ï¼Œå‡å°‘æ•°æ®ä¼ è¾“ä½“ç§¯ã€‚")]),t._v(" "),a("p",[t._v("åœ¨ç°ä»£åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œé€‰æ‹© "),a("strong",[t._v("RPC")]),t._v("ï¼ˆRemote Procedure Callï¼‰è€Œéå•çº¯çš„ "),a("strong",[t._v("HTTP")]),t._v(" åè®®ï¼Œä¸»è¦å‡ºäº "),a("strong",[t._v("æ€§èƒ½ã€æœåŠ¡æ²»ç†èƒ½åŠ›ã€é€šä¿¡æ¨¡å‹çµæ´»æ€§")]),t._v(" ä»¥åŠ "),a("strong",[t._v("å¼€å‘æ•ˆç‡")]),t._v(" ç­‰æ–¹é¢çš„è€ƒé‡ã€‚")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[t._v("å¯¹æ¯”ç»´åº¦")])]),t._v(" "),a("th",[a("strong",[t._v("HTTP")])]),t._v(" "),a("th",[a("strong",[t._v("gRPC")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("åè®®è®¾è®¡")])]),t._v(" "),a("td",[t._v("åŸºäºæ–‡æœ¬çš„è¯·æ±‚-å“åº”æ¨¡å‹ï¼ˆGET/POSTï¼‰")]),t._v(" "),a("td",[t._v("åŸºäºHTTP/2çš„äºŒè¿›åˆ¶åˆ†å¸§åè®®ï¼Œæ”¯æŒåŒå‘æµå¼é€šä¿¡")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("æ€§èƒ½")])]),t._v(" "),a("td",[t._v("æ–‡æœ¬è§£æå¼€é”€å¤§ï¼Œæ€§èƒ½è¾ƒä½")]),t._v(" "),a("td",[t._v("äºŒè¿›åˆ¶ä¼ è¾“ï¼Œå¤´éƒ¨å‹ç¼©ï¼Œå¤šè·¯å¤ç”¨ï¼Œå»¶è¿Ÿæ›´ä½")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("ä½¿ç”¨åœºæ™¯")])]),t._v(" "),a("td",[t._v("WebæœåŠ¡ã€RESTful API")]),t._v(" "),a("td",[t._v("å¾®æœåŠ¡é—´é«˜æ€§èƒ½é€šä¿¡ã€å®æ—¶æ•°æ®æµï¼ˆå¦‚èŠå¤©ã€è§†é¢‘æµï¼‰")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("æ¥å£å®šä¹‰")])]),t._v(" "),a("td",[t._v("æ— å¼ºåˆ¶è§„èŒƒ")]),t._v(" "),a("td",[t._v("ä½¿ç”¨Protocol Bufferså®šä¹‰æ¥å£ï¼Œå¼ºç±»å‹çº¦æŸ")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("è·¨è¯­è¨€æ”¯æŒ")])]),t._v(" "),a("td",[t._v("å¤©ç„¶æ”¯æŒ")]),t._v(" "),a("td",[t._v("é€šè¿‡Protobufç”Ÿæˆå¤šè¯­è¨€å®¢æˆ·ç«¯/æœåŠ¡ç«¯ä»£ç ")])])])]),t._v(" "),a("h3",{attrs:{id:"ğŸ¯-grpcçš„å››ç§é€šä¿¡æ¨¡å¼"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-grpcçš„å››ç§é€šä¿¡æ¨¡å¼"}},[t._v("#")]),t._v(" ğŸ¯ "),a("strong",[t._v("gRPCçš„å››ç§é€šä¿¡æ¨¡å¼ï¼Ÿ")])]),t._v(" "),a("ol",[a("li",[t._v("ç®€å•RPCï¼ˆUnary RPCï¼‰ï¼šå®¢æˆ·ç«¯å‘é€å•ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡ç«¯è¿”å›å•ä¸ªå“åº”ï¼ˆå¦‚å‡½æ•°è°ƒç”¨ï¼‰ã€‚")]),t._v(" "),a("li",[t._v("æœåŠ¡ç«¯æµå¼RPCï¼šå®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼ŒæœåŠ¡ç«¯è¿”å›æ•°æ®æµï¼ˆå¦‚è‚¡ç¥¨å®æ—¶è¡Œæƒ…æ¨é€ï¼‰ã€‚")]),t._v(" "),a("li",[t._v("å®¢æˆ·ç«¯æµå¼RPCï¼šå®¢æˆ·ç«¯æŒç»­å‘é€æ•°æ®æµï¼ŒæœåŠ¡ç«¯æœ€ç»ˆè¿”å›å“åº”ï¼ˆå¦‚æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ ï¼‰ã€‚")]),t._v(" "),a("li",[t._v("åŒå‘æµå¼RPCï¼šåŒæ–¹ç‹¬ç«‹å‘é€å’Œæ¥æ”¶æ•°æ®æµï¼Œé€‚ç”¨äºå®æ—¶äº¤äº’ï¼ˆå¦‚èŠå¤©æœºå™¨äººï¼‰")])]),t._v(" "),a("h3",{attrs:{id:"ğŸ¯-dubboçš„æ ¸å¿ƒç»„ä»¶åŠå·¥ä½œæµç¨‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-dubboçš„æ ¸å¿ƒç»„ä»¶åŠå·¥ä½œæµç¨‹"}},[t._v("#")]),t._v(" ğŸ¯ Dubboçš„æ ¸å¿ƒç»„ä»¶åŠå·¥ä½œæµç¨‹ï¼Ÿ")]),t._v(" "),a("p",[a("strong",[t._v("æ ¸å¿ƒç»„ä»¶")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("æœåŠ¡æä¾›è€…ï¼ˆProviderï¼‰")]),t._v("ï¼šæš´éœ²æœåŠ¡æ¥å£çš„å®ç°ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("æœåŠ¡æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰")]),t._v("ï¼šè°ƒç”¨è¿œç¨‹æœåŠ¡ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("æ³¨å†Œä¸­å¿ƒï¼ˆRegistryï¼‰")]),t._v("ï¼šæœåŠ¡æ³¨å†Œä¸å‘ç°ï¼ˆå¦‚Zookeeperã€Nacosï¼‰ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("é…ç½®ä¸­å¿ƒ")]),t._v("ï¼šç®¡ç†æœåŠ¡é…ç½®ã€‚")])]),t._v(" "),a("p",[a("strong",[t._v("å·¥ä½œæµç¨‹")]),t._v("ï¼š")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("æœåŠ¡æ³¨å†Œ")]),t._v("ï¼šProviderå¯åŠ¨æ—¶å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªèº«ä¿¡æ¯ï¼ˆIPã€ç«¯å£ç­‰ï¼‰ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("æœåŠ¡å‘ç°")]),t._v("ï¼šConsumerä»æ³¨å†Œä¸­å¿ƒè·å–Provideråˆ—è¡¨ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("è´Ÿè½½å‡è¡¡")]),t._v("ï¼šConsumeré€šè¿‡è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼ˆå¦‚éšæœºã€è½®è¯¢ï¼‰é€‰æ‹©Providerã€‚")]),t._v(" "),a("li",[a("strong",[t._v("è¿œç¨‹è°ƒç”¨")]),t._v("ï¼šé€šè¿‡Nettyç­‰é€šä¿¡æ¡†æ¶å‘èµ·RPCè°ƒç”¨ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"ğŸ¯-å¦‚ä½•é€‰æ‹©rpcæ¡†æ¶"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å¦‚ä½•é€‰æ‹©rpcæ¡†æ¶"}},[t._v("#")]),t._v(" ğŸ¯ "),a("strong",[t._v("å¦‚ä½•é€‰æ‹©RPCæ¡†æ¶ï¼Ÿ")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[t._v("æ¡†æ¶")])]),t._v(" "),a("th",[a("strong",[t._v("ç‰¹ç‚¹")])]),t._v(" "),a("th",[a("strong",[t._v("é€‚ç”¨åœºæ™¯")])])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("strong",[t._v("Dubbo")])]),t._v(" "),a("td",[t._v("Javaç”Ÿæ€æˆç†Ÿï¼Œæ”¯æŒæœåŠ¡æ²»ç†ï¼ˆè´Ÿè½½å‡è¡¡ã€ç†”æ–­ï¼‰ï¼Œä¾èµ–Zookeeper")]),t._v(" "),a("td",[t._v("å¾®æœåŠ¡æ¶æ„ï¼Œéœ€å¤æ‚æœåŠ¡æ²»ç†")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("gRPC")])]),t._v(" "),a("td",[t._v("é«˜æ€§èƒ½ã€è·¨è¯­è¨€ã€æ”¯æŒæµå¼é€šä¿¡ï¼Œä¾èµ–Protobuf")]),t._v(" "),a("td",[t._v("è·¨è¯­è¨€æœåŠ¡é—´é€šä¿¡ã€å®æ—¶æ•°æ®ä¼ è¾“")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("Thrift")])]),t._v(" "),a("td",[t._v("æ”¯æŒå¤šç§è¯­è¨€ï¼Œæ¥å£å®šä¹‰è¯­è¨€çµæ´»ï¼Œæ€§èƒ½è¾ƒé«˜")]),t._v(" "),a("td",[t._v("å¤šè¯­è¨€æ··åˆæ¶æ„ã€é«˜ååé‡åœºæ™¯")])]),t._v(" "),a("tr",[a("td",[a("strong",[t._v("Spring Cloud OpenFeign")])]),t._v(" "),a("td",[t._v("åŸºäºHTTPï¼Œé›†æˆRibbonã€Hystrixï¼Œæ˜“ç”¨æ€§å¼º")]),t._v(" "),a("td",[t._v("å¿«é€Ÿæ„å»ºå¾®æœåŠ¡ï¼Œå¯¹æ€§èƒ½è¦æ±‚ä¸é«˜")])])])]),t._v(" "),a("h2",{attrs:{id:"ğŸ¯-feign-æ˜¯ä»€ä¹ˆ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-feign-æ˜¯ä»€ä¹ˆ"}},[t._v("#")]),t._v(" ğŸ¯ Feign æ˜¯ä»€ä¹ˆï¼Ÿ")]),t._v(" "),a("ul",[a("li",[a("p",[a("strong",[t._v("Feign")]),t._v(" æ˜¯ Spring Cloud æä¾›çš„ä¸€ç§ "),a("strong",[t._v("å£°æ˜å¼ HTTP å®¢æˆ·ç«¯")]),t._v("ã€‚")])]),t._v(" "),a("li",[a("p",[t._v("åº•å±‚æ˜¯åŸºäº "),a("strong",[t._v("HTTP/REST")]),t._v(" åè®®ï¼Œé€šè¿‡æ³¨è§£ï¼ˆ"),a("code",[t._v("@FeignClient")]),t._v("ï¼‰å®šä¹‰æ¥å£ï¼ŒSpring è‡ªåŠ¨ç”Ÿæˆä»£ç†ç±»å»å‘èµ· HTTP è¯·æ±‚ã€‚")])]),t._v(" "),a("li",[a("p",[t._v("ç‰¹ç‚¹ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("ç®€å•æ˜“ç”¨ï¼Œå’Œ Spring Cloud æ— ç¼é›†æˆï¼ˆRibbonã€Eurekaã€Nacosã€Sentinelï¼‰ã€‚")]),t._v(" "),a("li",[t._v("å¤©ç„¶æ”¯æŒè´Ÿè½½å‡è¡¡ã€ç†”æ–­ã€é™çº§ã€‚")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("Feign é€‚åˆï¼š")])]),t._v(" "),a("ul",[a("li",[t._v("Java ç”Ÿæ€é¡¹ç›®ï¼Œå°¤å…¶æ˜¯ "),a("strong",[t._v("Spring Cloud å¾®æœåŠ¡æ¶æ„")]),t._v("ã€‚")]),t._v(" "),a("li",[t._v("åœºæ™¯ä¸­ä»¥ REST æ¥å£ä¸ºä¸»ï¼Œå›¢é˜Ÿå¸Œæœ›å¼€å‘ç®€å•ã€è°ƒè¯•æ–¹ä¾¿ã€‚")]),t._v(" "),a("li",[t._v("ä¸šåŠ¡æ¥å£ä¸æ˜¯ç‰¹åˆ«é«˜é¢‘æˆ–æ€§èƒ½æ•æ„Ÿï¼ˆæ¯”å¦‚ç”µå•†å•†å“ã€è®¢å•æ¥å£è°ƒç”¨ï¼‰ã€‚")])])]),t._v(" "),a("li",[a("p",[a("strong",[t._v("gRPC é€‚åˆï¼š")])]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("è·¨è¯­è¨€ç³»ç»Ÿ")]),t._v("ï¼ˆå¦‚ Java æœåŠ¡å’Œ Goã€Python æœåŠ¡äº¤äº’ï¼‰ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("é«˜æ€§èƒ½åœºæ™¯")]),t._v("ï¼ˆå¦‚æ¨èç³»ç»Ÿã€å¹¿å‘Šç³»ç»Ÿã€é‡‘èäº¤æ˜“ç³»ç»Ÿï¼‰ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("å®æ—¶é€šä¿¡")]),t._v("ï¼ˆå¦‚ IM èŠå¤©ã€æµå¼æ—¥å¿—å¤„ç†ã€è§†é¢‘æ¨é€ï¼‰ã€‚")]),t._v(" "),a("li",[a("strong",[t._v("äº‘åŸç”Ÿç¯å¢ƒ")]),t._v("ï¼ˆK8sã€Istio å¾®æœåŠ¡æ²»ç†ï¼‰ã€‚")])])])]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"ğŸš€-å…­ã€é«˜çº§ç‰¹æ€§ä¸å®è·µ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸš€-å…­ã€é«˜çº§ç‰¹æ€§ä¸å®è·µ"}},[t._v("#")]),t._v(" ğŸš€ å…­ã€é«˜çº§ç‰¹æ€§ä¸å®è·µ")]),t._v(" "),a("p",[a("strong",[t._v("æ ¸å¿ƒç†å¿µ")]),t._v("ï¼šæŒæ¡RPCæ¡†æ¶çš„é«˜çº§ç‰¹æ€§ï¼Œå¦‚æ³›åŒ–è°ƒç”¨ã€å¤šç‰ˆæœ¬æ”¯æŒç­‰ä¼ä¸šçº§åº”ç”¨åœºæ™¯ã€‚")]),t._v(" "),a("h3",{attrs:{id:"ğŸ¯-å¦‚ä½•å®ç°rpcçš„å¤šç‰ˆæœ¬æ”¯æŒ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å¦‚ä½•å®ç°rpcçš„å¤šç‰ˆæœ¬æ”¯æŒ"}},[t._v("#")]),t._v(" ğŸ¯ å¦‚ä½•å®ç°RPCçš„å¤šç‰ˆæœ¬æ”¯æŒï¼Ÿ")]),t._v(" "),a("p",[t._v("å¤šç‰ˆæœ¬æ”¯æŒæ˜¯ä¼ä¸šçº§RPCçš„é‡è¦ç‰¹æ€§ï¼š")]),t._v(" "),a("p",[a("strong",[t._v("ç‰ˆæœ¬ç®¡ç†ç­–ç•¥")]),t._v("ï¼š")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("æ¥å£ç‰ˆæœ¬åŒ–")]),t._v("ï¼šåœ¨æ¥å£ä¸­æ·»åŠ ç‰ˆæœ¬ä¿¡æ¯")]),t._v(" "),a("li",[a("strong",[t._v("æœåŠ¡åˆ†ç»„")]),t._v("ï¼šä¸åŒç‰ˆæœ¬éƒ¨ç½²åˆ°ä¸åŒåˆ†ç»„")]),t._v(" "),a("li",[a("strong",[t._v("ç°åº¦å‘å¸ƒ")]),t._v("ï¼šæ–°æ—§ç‰ˆæœ¬å¹¶è¡Œè¿è¡Œ")]),t._v(" "),a("li",[a("strong",[t._v("å…¼å®¹æ€§è®¾è®¡")]),t._v("ï¼šå‘åå…¼å®¹çš„APIè®¾è®¡")])]),t._v(" "),a("p",[a("strong",[t._v("ğŸ’» ä»£ç å®ç°")]),t._v("ï¼š")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç‰ˆæœ¬åŒ–æ¥å£å®šä¹‰")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Service")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("version "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserServiceV1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserService")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUserById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" userRepository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("findById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Service")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("version "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserServiceV2")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserService")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUserById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),t._v(" user "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" userRepository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("findById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// V2ç‰ˆæœ¬å¢åŠ äº†é¢å¤–çš„å¤„ç†é€»è¾‘")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setLastAccessTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Date")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            userRepository"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("save")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" user"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å®¢æˆ·ç«¯ç‰ˆæœ¬é€‰æ‹©")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserServiceClient")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Reference")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("version "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" check "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserService")]),t._v(" userServiceV2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Reference")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("version "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" check "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserService")]),t._v(" userServiceV1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("User")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUser")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Long")]),t._v(" id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" version"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("equals")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("version"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" userServiceV2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUserById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" userServiceV1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getUserById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("id"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"ğŸ¯-å¦‚ä½•å®ç°rpcè°ƒç”¨ç›‘æ§"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-å¦‚ä½•å®ç°rpcè°ƒç”¨ç›‘æ§"}},[t._v("#")]),t._v(" ğŸ¯ å¦‚ä½•å®ç°RPCè°ƒç”¨ç›‘æ§ï¼Ÿ")]),t._v(" "),a("p",[t._v("å…¨é“¾è·¯ç›‘æ§æ˜¯RPCæ²»ç†çš„é‡è¦æ‰‹æ®µï¼š")]),t._v(" "),a("p",[a("strong",[t._v("ç›‘æ§ç»´åº¦")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("è°ƒç”¨é‡ç»Ÿè®¡ï¼ˆQPSã€TPSï¼‰")]),t._v(" "),a("li",[t._v("å“åº”æ—¶é—´åˆ†å¸ƒ")]),t._v(" "),a("li",[t._v("é”™è¯¯ç‡ç›‘æ§")]),t._v(" "),a("li",[t._v("æœåŠ¡ä¾èµ–å…³ç³»")]),t._v(" "),a("li",[t._v("é“¾è·¯è¿½è¸ª")])]),t._v(" "),a("p",[a("strong",[t._v("ğŸ’» ç›‘æ§å®ç°")]),t._v("ï¼š")]),t._v(" "),a("div",{staticClass:"language-java extra-class"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// RPCç›‘æ§æ‹¦æˆªå™¨")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCMonitorInterceptor")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("implements")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCInterceptor")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MeterRegistry")]),t._v(" meterRegistry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Tracer")]),t._v(" tracer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("intercept")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCRequest")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCInvoker")]),t._v(" invoker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" serviceName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getServiceName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" methodName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMethodName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»ºSpanç”¨äºé“¾è·¯è¿½è¸ª")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Span")]),t._v(" span "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tracer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextSpan")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("serviceName "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"."')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" methodName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rpc.service"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" serviceName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rpc.method"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" methodName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("start")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            \n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Timer")]),t._v(" timer "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Timer")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("builder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rpc.call.duration"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"service"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" serviceName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"method"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" methodName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("register")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("meterRegistry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" startTime "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        \n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Tracer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SpanInScope")]),t._v(" ws "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" tracer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("withSpanInScope")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("span"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCResponse")]),t._v(" response "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" invoker"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("invoke")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            \n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®°å½•æˆåŠŸæŒ‡æ ‡")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Counter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("builder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rpc.call.success"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"service"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" serviceName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"method"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" methodName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("register")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("meterRegistry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("increment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                \n            span"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rpc.success"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            \n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Exception")]),t._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®°å½•å¤±è´¥æŒ‡æ ‡")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Counter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("builder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rpc.call.error"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"service"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" serviceName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"method"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" methodName"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"error"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getClass")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getSimpleName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("register")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("meterRegistry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("increment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                \n            span"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rpc.success"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"false"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"error"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getMessage")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("throw")]),t._v(" e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            \n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("finally")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" duration "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("System")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("currentTimeMillis")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" startTime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            timer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("record")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("duration"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TimeUnit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("MILLISECONDS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            span"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç›‘æ§æŒ‡æ ‡æ”¶é›†")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RPCMetricsCollector")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("final")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MeterRegistry")]),t._v(" meterRegistry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å®æ—¶æŒ‡æ ‡")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Scheduled")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fixedRate "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("60000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¯åˆ†é’Ÿæ”¶é›†ä¸€æ¬¡")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("collectMetrics")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ”¶é›†JVMæŒ‡æ ‡")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Gauge")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("builder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rpc.jvm.memory.used"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("register")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("meterRegistry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                obj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Runtime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRuntime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("totalMemory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Runtime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getRuntime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("freeMemory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ”¶é›†è¿æ¥æ± æŒ‡æ ‡")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Gauge")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("builder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rpc.connection.pool.active"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("register")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("meterRegistry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                obj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getActiveConnections")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n                \n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ”¶é›†çº¿ç¨‹æ± æŒ‡æ ‡")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Gauge")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("builder")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"rpc.thread.pool.active"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("register")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("meterRegistry"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                obj "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("->")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getActiveThreads")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getActiveConnections")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å®ç°è·å–æ´»è·ƒè¿æ¥æ•°çš„é€»è¾‘")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("long")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getActiveThreads")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å®ç°è·å–æ´»è·ƒçº¿ç¨‹æ•°çš„é€»è¾‘")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"ğŸ¯-capç†è®ºåœ¨rpcä¸­çš„åº”ç”¨"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-capç†è®ºåœ¨rpcä¸­çš„åº”ç”¨"}},[t._v("#")]),t._v(" ğŸ¯ CAPç†è®ºåœ¨RPCä¸­çš„åº”ç”¨ï¼Ÿ")]),t._v(" "),a("p",[t._v("CAPç†è®ºæŒ‡å‡ºåˆ†å¸ƒå¼ç³»ç»Ÿæ— æ³•åŒæ—¶æ»¡è¶³ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ã€åˆ†åŒºå®¹é”™æ€§ï¼ˆPartition Toleranceï¼‰ï¼Œéœ€æ ¹æ®ä¸šåŠ¡æƒè¡¡ï¼š")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("Zookeeper")]),t._v("ï¼šCPç³»ç»Ÿï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Œç½‘ç»œåˆ†åŒºæ—¶æ‹’ç»å†™è¯·æ±‚ã€‚")]),t._v(" "),a("li",[t._v("Eurekaï¼šAPç³»ç»Ÿï¼Œä¼˜å…ˆä¿è¯å¯ç”¨æ€§ï¼Œå®¹å¿ç½‘ç»œåˆ†åŒºï¼Œä½†å¯èƒ½è¿”å›æ—§æ•°æ®ã€‚")])]),t._v(" "),a("p",[a("strong",[t._v("RPCé€‰å‹å»ºè®®")]),t._v("ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("å¯¹ä¸€è‡´æ€§è¦æ±‚é«˜ï¼ˆå¦‚é‡‘èäº¤æ˜“ï¼‰ï¼šé€‰æ‹©Zookeeperä½œä¸ºæ³¨å†Œä¸­å¿ƒã€‚")]),t._v(" "),a("li",[t._v("å¯¹å¯ç”¨æ€§è¦æ±‚é«˜ï¼ˆå¦‚é«˜å¹¶å‘WebæœåŠ¡ï¼‰ï¼šé€‰æ‹©Eurekaæˆ–Nacos")])]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"ğŸ¯-é¢è¯•é‡ç‚¹æ€»ç»“"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ¯-é¢è¯•é‡ç‚¹æ€»ç»“"}},[t._v("#")]),t._v(" ğŸ¯ é¢è¯•é‡ç‚¹æ€»ç»“")]),t._v(" "),a("h3",{attrs:{id:"é«˜é¢‘è€ƒç‚¹é€Ÿè§ˆ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é«˜é¢‘è€ƒç‚¹é€Ÿè§ˆ"}},[t._v("#")]),t._v(" é«˜é¢‘è€ƒç‚¹é€Ÿè§ˆ")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("RPCåŸºæœ¬åŸç†")]),t._v("ï¼šè°ƒç”¨æµç¨‹ã€ç½‘ç»œé€šä¿¡ã€åŠ¨æ€ä»£ç†çš„å®ç°æœºåˆ¶")]),t._v(" "),a("li",[a("strong",[t._v("åºåˆ—åŒ–æ–¹æ¡ˆ")]),t._v("ï¼šå„ç§åºåˆ—åŒ–æŠ€æœ¯çš„ç‰¹ç‚¹ã€æ€§èƒ½å¯¹æ¯”ã€é€‰æ‹©ç­–ç•¥")]),t._v(" "),a("li",[a("strong",[t._v("æœåŠ¡æ²»ç†")]),t._v("ï¼šæ³¨å†Œå‘ç°ã€è´Ÿè½½å‡è¡¡ã€ç†”æ–­é™çº§çš„è®¾è®¡ä¸å®ç°")]),t._v(" "),a("li",[a("strong",[t._v("æ€§èƒ½ä¼˜åŒ–")]),t._v("ï¼šç½‘ç»œä¼˜åŒ–ã€å¼‚æ­¥å¤„ç†ã€è¿æ¥å¤ç”¨çš„ç³»ç»Ÿæ€§æ–¹æ³•")]),t._v(" "),a("li",[a("strong",[t._v("æ¡†æ¶å¯¹æ¯”")]),t._v("ï¼šDubboã€gRPCã€Spring Cloudçš„ç‰¹ç‚¹å’Œé€‚ç”¨åœºæ™¯")]),t._v(" "),a("li",[a("strong",[t._v("é«˜çº§ç‰¹æ€§")]),t._v("ï¼šå¤šç‰ˆæœ¬æ”¯æŒã€ç›‘æ§åŸ‹ç‚¹ã€æ•…éšœå¤„ç†çš„ä¼ä¸šçº§å®è·µ")])]),t._v(" "),a("h3",{attrs:{id:"é¢è¯•ç­”é¢˜ç­–ç•¥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#é¢è¯•ç­”é¢˜ç­–ç•¥"}},[t._v("#")]),t._v(" é¢è¯•ç­”é¢˜ç­–ç•¥")]),t._v(" "),a("ol",[a("li",[a("strong",[t._v("åŸç†é˜è¿°")]),t._v("ï¼šå…ˆè¯´æ¦‚å¿µå®šä¹‰ï¼Œå†è®²æŠ€æœ¯åŸç†ï¼Œæœ€åè°ˆåº”ç”¨åœºæ™¯")]),t._v(" "),a("li",[a("strong",[t._v("å¯¹æ¯”åˆ†æ")]),t._v("ï¼šä¸åŒæŠ€æœ¯æ–¹æ¡ˆçš„ä¼˜ç¼ºç‚¹å¯¹æ¯”ï¼Œé€‰æ‹©ä¾æ®")]),t._v(" "),a("li",[a("strong",[t._v("å®æˆ˜ç»éªŒ")]),t._v("ï¼šç»“åˆå…·ä½“é¡¹ç›®ç»éªŒï¼Œå±•ç¤ºè§£å†³é—®é¢˜çš„æ€è·¯")]),t._v(" "),a("li",[a("strong",[t._v("ä»£ç å±•ç¤º")]),t._v("ï¼šå…³é”®æŠ€æœ¯ç‚¹ç”¨ç®€æ´ä»£ç ç¤ºä¾‹è¯´æ˜")])]),t._v(" "),a("hr"),t._v(" "),a("h2",{attrs:{id:"ğŸ“š-æ‰©å±•å­¦ä¹ "}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ğŸ“š-æ‰©å±•å­¦ä¹ "}},[t._v("#")]),t._v(" ğŸ“š æ‰©å±•å­¦ä¹ ")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("å®˜æ–¹æ–‡æ¡£")]),t._v("ï¼šDubboã€gRPCã€Thriftç­‰æ¡†æ¶çš„å®˜æ–¹æ–‡æ¡£")]),t._v(" "),a("li",[a("strong",[t._v("æºç åˆ†æ")]),t._v("ï¼šæ·±å…¥ç†è§£æ¡†æ¶çš„å®ç°åŸç†å’Œè®¾è®¡æ€æƒ³")]),t._v(" "),a("li",[a("strong",[t._v("æ€§èƒ½æµ‹è¯•")]),t._v("ï¼šå¯¹æ¯”ä¸åŒæ¡†æ¶å’Œé…ç½®çš„æ€§èƒ½è¡¨ç°")]),t._v(" "),a("li",[a("strong",[t._v("æœ€ä½³å®è·µ")]),t._v("ï¼šå­¦ä¹ ä¼ä¸šçº§RPCåº”ç”¨çš„æ¶æ„è®¾è®¡å’Œè¿ç»´ç»éªŒ")])])])}),[],!1,null,null,null);s.default=e.exports}}]);